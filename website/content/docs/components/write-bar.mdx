<Overview>

# WriteBar

Компонент для создания поля ввода сообщений с поддержкой иконок действий. Аналог строки ввода в мессенджерах и соцсетях. Принимает все свойства нативного `textarea`

Связанные компоненты:

- WriteBarIcon

</Overview>

## Основные элементы

- `before` — элементы слева от поля ввода
- `after` — элементы справа
- `inlineAfter` — элементы поверх поля (актуально для iOS)

## Использование иконок

Все боковые элементы рекомендуется оборачивать в `WriteBarIcon`. Также для адптирования размеров иконок стоит использовать компонент [`AdaptiveIconRenderer`](#/AdaptiveIconRenderer):

```jsx
const WriteBarExample = (props) => {
  const [text, setText] = React.useState('');
  const platform = usePlatform();

  const SmileOutlineIcon = (
    <AdaptiveIconRenderer
      IconCompact={platform === 'ios' ? Icon28SmileOutline : Icon24SmileOutline}
      IconRegular={Icon28SmileOutline}
    />
  );

  const VoiceOutlineIcon = (
    <AdaptiveIconRenderer
      IconCompact={platform === 'ios' ? Icon28VoiceOutline : Icon24VoiceOutline}
      IconRegular={Icon28VoiceOutline}
    />
  );

  const KeyboardBotsOutlineIcon = (
    <AdaptiveIconRenderer
      IconCompact={platform === 'ios' ? Icon28KeyboardBotsOutline : Icon24KeyboardBotsOutline}
      IconRegular={Icon28KeyboardBotsOutline}
    />
  );

  return (
    <View activePanel="writebar">
      <Panel id="writebar">
        <PanelHeader>WriteBar</PanelHeader>

        <Group>
          <WriteBar
            value={text}
            onChange={(e) => setText(e.target.value)}
            before={<WriteBarIcon onClick={noop} mode="attach" />}
            inlineAfter={
              <>
                {text.length === 0 && (
                  <WriteBarIcon onClick={noop} label="Открыть меню бота">
                    {KeyboardBotsOutlineIcon}
                  </WriteBarIcon>
                )}
                {text.length > 0 && (
                  <WriteBarIcon onClick={noop} label="Эмоджи и стикеры">
                    {SmileOutlineIcon}
                  </WriteBarIcon>
                )}
              </>
            }
            after={
              <>
                {text.length === 0 && (
                  <WriteBarIcon onClick={noop} label="Эмоджи и стикеры">
                    {SmileOutlineIcon}
                  </WriteBarIcon>
                )}
                {text.length === 0 && (
                  <WriteBarIcon onClick={noop} label="Записать голосовое сообщение">
                    {VoiceOutlineIcon}
                  </WriteBarIcon>
                )}
                {text.length > 0 && <WriteBarIcon onClick={noop} mode="send" />}
              </>
            }
            placeholder="Сообщение"
          />
        </Group>
      </Panel>
    </View>
  );
};

<WriteBarExample />;
```

## WriteBarIcon

Компонент для создания иконок-кнопок внутри `WriteBar`. Обеспечивает стандартное поведение и доступность для элементов управления в поле ввода сообщений.

### Предустановленные режимы

Предустановленные типы кнопок в `WriteBar` для отрисовки иконки и установки текста кнопки в зависимости от платформы.
Если передать валидное значение для этого свойства, `children` игнорируются, а для `label` по умолчанию используется текст на "ru_RU".

- `attach` — иконка прикрепления с текстом "Прикрепить файл"
- `send` — иконка отправки с текстом "Отправить"
- `done` — иконка подтверждения с текстом "Готово"

```jsx
<Flex gap="m">
  <WriteBarIcon mode="attach" />
  <WriteBarIcon mode="send" />
  <WriteBarIcon mode="done" />
</Flex>
```

### Использование кастомных иконки

```jsx
<WriteBarIcon label="Голосовое сообщение">
  <Icon28VoiceOutline />
</WriteBarIcon>
```

### Отображение счётчика

Значение счётчика для кнопки. Например, для количества прикреплённых файлов.

```jsx
<WriteBarIcon mode="attach" count={3} label="Прикреплённые файлы" />
```

### Доступность (a11y)

1. Укажите текстовое описание одним из способов:

**Через свойство `label`:**

```jsx static
<WriteBarIcon label="Прикрепить файл">
  <Icon24Attachment />
</WriteBarIcon>
```

**Через ARIA-атрибуты:**

```jsx static
<WriteBarIcon aria-label="Отправить сообщение">
  <Icon24Send />
</WriteBarIcon>
```

**С использованием VisuallyHidden:**

```jsx static
<WriteBarIcon>
  <Icon24SmileOutline />
  <VisuallyHidden>Эмодзи</VisuallyHidden>
</WriteBarIcon>
```

**С использованием `id` в `aria-labelledby`**

```jsx static
<VisuallyHidden id="write_bar_icon_voice">Записать голосовое сообщение</VisuallyHidden>
<WriteBarIcon aria-labelledby="write_bar_icon_voice">
<Icon28VoiceOutline />
</WriteBarIcon>
```

### Особенности поведения

- Наследует все свойства `<button>`
- Автоматическая адаптация под платформу (iOS/Android) при использовании готовых пресетов
- Рекомендуется использовать только внутри `WriteBar`

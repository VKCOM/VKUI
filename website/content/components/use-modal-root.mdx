---
description: Хук для работы с модальными окнами([`ModalPage`](/components/modal-page), [`ModalCard`](/components/modal-card)).
---

<Overview type="hook">

# useModalRoot

Хук для работы с модальными окнами([`ModalPage`](/components/modal-page), [`ModalCard`](/components/modal-card)).

</Overview>

## Параметры

Принимает все свойства компонента [`ModalRoot`](/components/modal-root) кроме `activeModal` и `children`.

## Возвращаемое значение

Кортеж:

1. `ModalRootApi` - API для работы с модальными окнами.
2. `React.ReactElement | null` - ReactElement, который необходимо встроить в DOM дерево.

### ModalRootApi [#modal-root-api]

- `openCard: (props: OpenModalCardProps) => OpenModalReturn` - Метод для открытия `ModalCard`, принимает свойства `ModalCard`. Возращает объект типа [`OpenModalReturn`](/components/use-modal-root#open-modal-return).
- `openPage: (props: OpenModalPageProps) => OpenModalReturn` - Метод для открытия `ModalPage`, принимает свойства `ModalPage`. Возращает объект типа [`OpenModalReturn`](/components/use-modal-root#open-modal-return).
- `update: (id: string, type: 'card' | 'page', props: T) => void` - Метод для изменения свойств уже созданных модалок. Принимает `id` и новые свойства, которые нужно переопределить.
- `close: (id: string) => void` - Метод для закрытия определенной модальных окон. Принимает id модального окна.
- `closeAll: () => void` - Метод для закрытия всех созданных модальных окон.

#### OpenModalReturn [#open-modal-return]

API возвращаемое методами `openCard` и `openPage`, которое добавляет дополнительные возможности для взаимодействия с открытыми модальными окнами.

- `id: string` - Идентификатор созданного модального окна. Либо переданный при открытии в `props`, либо сгенерированный автоматически `uuidv4`.
- `close: () => void;` - Метод для закрытия созданного модального окна.
- `update: (props: T) => void` - Метод для изменения свойств созданного модального окна. Тип `props` зависит от того, какого типа модальное окно изменяется - `ModalPage` или `ModalCard`.
- `onClose: <R>(resolve?: () => R, reject?: VoidFunction) => Promise<R>` - Метод, который возвращает `Promise`, который сработает, когда модальное окно будет закрыто.

## Пример использования

<Playground>

```jsx
const [api, contextHolder] = useModalRoot();

const openModalCard = () => {
  const { close } = api.openCard({
    icon: <Icon56NotificationOutline />,
    title: 'Приложение запрашивает разрешение на отправку Вам уведомлений',
    actions: (
      <React.Fragment>
        <Spacing size={16} />
        <ButtonGroup gap="m" stretched>
          <Button key="deny" size="l" mode="secondary" stretched onClick={() => close()}>
            Запретить
          </Button>
          <Button key="allow" size="l" mode="primary" stretched onClick={() => close()}>
            Разрешить
          </Button>
        </ButtonGroup>
      </React.Fragment>
    ),
  });
};

const openModalPage = () => {
  const { close } = api.openPage({
    dynamicContentHeight: true,
    header: (
      <ModalPageHeader before={<PanelHeaderBack label="Назад" onClick={() => close()} />}>
        Информация о пользователе
      </ModalPageHeader>
    ),
    children: (
      <Group>
        <Cell>
          <InfoRow header="Дата рождения">5 ноября 1994</InfoRow>
        </Cell>
        <Cell>
          <InfoRow header="Родной город">Санкт-Петербург</InfoRow>
        </Cell>
        <Cell>
          <InfoRow header="Место работы">Команда ВКонтакте</InfoRow>
        </Cell>
      </Group>
    ),
  });
};

return (
  <>
    <Flex gap="2xl">
      <Button mode="primary" appearance="overlay" onClick={openModalPage}>
        Открыть ModalPage
      </Button>
      <Button mode="secondary" onClick={openModalCard}>
        Открыть ModalCard
      </Button>
    </Flex>
    {contextHolder}
  </>
);
```

</Playground>

## История открытия модальных окон

При использовании хука `useModalRoot` история открытых модальных окон сохраняется.
Если вам не нужно, что модальное окно сохранилось в истории, то его нужно закрыть с помощью метода `close` перед открытием другого.

<Playground>

```jsx
const [saveHistory, setSaveHistory] = React.useState(true);

const [api, contextHolder] = useModalRoot();

const openModal = (type: 'card' | 'page') => {
  let modalId = '';
  const openNextModal = (type: 'card' | 'page') => {
    if (!saveHistory && modalId) {
      api.close(modalId);
    }
    openModal(type);
  };

  if (type === 'card') {
    const { close, id } = api.openCard({
      icon: <Icon56NotificationOutline />,
      title: 'Modal Card Title',
      actions: (
        <ButtonGroup stretched mode="vertical">
          <Button size="l" mode="primary" stretched onClick={() => openNextModal('page')}>
            Открыть ModalPage
          </Button>
          <Button size="l" mode="primary" stretched onClick={() => openNextModal('card')}>
            Открыть ModalCard
          </Button>
          <Button size="l" mode="secondary" stretched onClick={() => close()}>
            Закрыть
          </Button>
        </ButtonGroup>
      ),
    });
    modalId = id;
  } else {
    const { close, id } = api.openPage({
      header: (
        <ModalPageHeader before={<PanelHeaderBack label="Назад" onClick={() => close()} />}>
           Вложенная модальная страница
         </ModalPageHeader>
      ),
      children: (
        <Group>
          <CellButton onClick={() => openNextModal('page')}>Open ModalPage</CellButton>
          <CellButton onClick={() => openNextModal('card')}>Open ModalCard</CellButton>
        </Group>
      ),
    });
    modalId = id;
  }
};

return (
  <>
    <Flex direction="column" gap="m">
      <Checkbox checked={saveHistory} onChange={(e) => setSaveHistory(e.target.checked)}>
        Сохранять историю открытия
      </Checkbox>
      <Button appearance="overlay" onClick={() => openModal('page')}>
        Открыть ModalPage
      </Button>
      <Button appearance="overlay" onClick={() => openModal('card')}>
        Открыть ModalCard
      </Button>
    </Flex>
    {contextHolder}
  </>
)
```

</Playground>

# useModalsApi

Хук для еще большего упрощения работы с модальными окнами.

> **Важно**: Для его работы необходимо, чтобы ваше приложение было обернуто в [`AppRoot`](/components/app-root).

Отличие от `useModalRoot`, в том, что ничего не принимает и возвращает только объект с [API](/components/use-modal-root#modal-root-api).

## Пример использования

<Playground>

```jsx
const api = useModalsApi();

const openModalCard = () => {
  const { close } = api.openCard({
    icon: <Icon56NotificationOutline />,
    title: 'Приложение запрашивает разрешение на отправку Вам уведомлений',
    actions: (
      <React.Fragment>
        <Spacing size={16} />
        <ButtonGroup gap="m" stretched>
          <Button key="deny" size="l" mode="secondary" stretched onClick={() => close()}>
            Запретить
          </Button>
          <Button key="allow" size="l" mode="primary" stretched onClick={() => close()}>
            Разрешить
          </Button>
        </ButtonGroup>
      </React.Fragment>
    ),
  });
};

const openModalPage = () => {
  const { close } = api.openPage({
    dynamicContentHeight: true,
    header: (
      <ModalPageHeader before={<PanelHeaderBack label="Назад" onClick={() => close()} />}>
        Информация о пользователе
      </ModalPageHeader>
    ),
    children: (
      <Group>
        <Cell>
          <InfoRow header="Дата рождения">5 ноября 1994</InfoRow>
        </Cell>
        <Cell>
          <InfoRow header="Родной город">Санкт-Петербург</InfoRow>
        </Cell>
        <Cell>
          <InfoRow header="Место работы">Команда ВКонтакте</InfoRow>
        </Cell>
      </Group>
    ),
  });
};

return (
  <Flex gap="2xl">
    <Button mode="primary" appearance="overlay" onClick={openModalPage}>
      Открыть ModalPage
    </Button>
    <Button mode="secondary" onClick={openModalCard}>
      Открыть ModalCard
    </Button>
  </Flex>
);
```

</Playground>

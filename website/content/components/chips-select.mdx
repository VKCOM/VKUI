<Overview>

# ChipsSelect

Компонент для выбора множества значений из выпадающего списка.
Позволяет пользователю выбирать опции из предустановленного списка или создавать новые значения. Выбранные значения отображаются в виде чипов, которые можно удалять.

</Overview>

```jsx
<ChipsSelect
  options={[
    { value: 'red', label: 'Красный' },
    { value: 'blue', label: 'Синий' },
    { value: 'green', label: 'Зеленый' },
  ]}
  defaultValue={[]}
/>
```

## Режим работы

Компонент поддерживает работу как в неконтролируемом режиме, так и контролируемом. Это стандартное поведение
React-компонентов, прочитать про это можно в [документации React](https://react.dev/reference/react-dom/components/input#controlling-an-input-with-a-state-variable).

Для использования неконтролируемого режима достаточно просто _не_ передавать `value` или передавать `defaultValue`, если
требуется задать значение по умолчанию.
Для контролируемого режима используйте связку свойств `value`/`onChange` для задания значения и его изменения.

```jsx
// Неконтролируемое состояние
<ChipsSelect
  defaultValue={[
    {
      value: 'red',
      label: 'Красный',
    },
  ]}
/>;

// Контролируемое состояние
const [colors, setColors] = React.useState([]);

<ChipsSelect value={colors} onChange={setColors} />;
```

## Управление вводом

### Добавление нового значения

Свойство `creatable` позволяет добавлять значения, которых нет в списке.

- `true` - значение добавляется по нажатию клавиши `Enter`;
- строковое значение - помимо клавиши `Enter`, в списке появляется кнопка, нажатие на которую приводит к добавлению значения.

```jsx
// Разрешить создание новых значений
<ChipsSelect creatable />

// В списке появляется кнопка
<ChipsSelect creatable="Добавить новую опцию" />
```

### Разделитель

> Работает только при заданном свойстве `creatable`

Задаётся свойством `delimiter`. Позволяет добавлять несколько элементов за раз, разделяя их указанным символом.

Представляет собой символ, который будет использоваться как разделитель для автоматического создания опций из текста,
введенного или вставленного в поле ввода. Например, при `delimiter=","` вставка текста "Красный,Синий" в поле ввода
создаст два элемента - "Красный" и "Синий".

Пока поддерживаются только строковые символы.

### Потеря фокуса

По умолчанию при потере полем фокуса добавления в список опций не происходит.
С помощью свойства `addOnBlur` можно включить поведение, при котором потеря фокуса будет приводить к добавлению нового элемента.

## Кастомизация

### Модель данных

С помощью свойств `getOptionValue`, `getOptionLabel` и `getNewOptionData` поддерживаются любые модели данных.

- `getOptionValue` - позволяет определить, какое значение использовать как уникальный ключ опции (по умолчанию поле `value`);
- `getOptionLabel` - позволяет определить, какой текст отображать для опции (по умолчанию поле `label`);
- `getNewOptionData` - используется для создания новой опции, позволяя менять параметры.

```jsx
// Функция для создания новой опции (при вводе текста, которого нет в списке)
const getNewOptionData = (inputValue) => {
  return {
    value: inputValue,
    id: inputValue,
    name: inputValue,
  };
};

return (
  <div>
    <ChipsInput
      // В качестве уникального идентификатора используем `id`
      getOptionValue={(option) => option.id}
      // В качестве отображаемого текста используем `name`
      getOptionLabel={(option) => option.name}
      getNewOptionData={getNewOptionData}
      placeholder="Добавьте пользователей"
      renderChip={(_, { name }) => <Chip>{name}</Chip>}
    />
  </div>
);
```

### Визуальное оформление

С помощью свойства `renderChip` можно влиять на отображение конкретного значения. Вы можете изменить
стандартный компонент `Chip` или использовать свой компонент.

```jsx
<ChipsInput
  renderChip={({ value, label, ...rest }, { src }) => (
    <Chip
      value={value}
      removable={false}
      before={<Avatar size={20} src={src} aria-hidden />}
      {...rest}
    >
      {label}
    </Chip>
  )}
/>
```

С помощью свойства `renderOption` можно влиять на отображение конкретного элемента выпадающего списка.
Вы можете изменить стандартный компонент `CustomSelectOption` или использовать свой компонент.

```jsx
<ChipsInput
  renderOption={(props, { src }) => {
    return <CustomSelectOption before={<Avatar size={20} aria-hidden src={src} />} {...props} />;
  }}
/>
```

Важно отметить, что первым параметром в обработчика `renderChip`/`renderOption` идёт объект со свойствами, необходимыми для
корректной работы `a11y`. Если для отображения элемента вы используете свой компонент, убедитесь, что все эти свойства
компонент получает и корректно обрабатывает. Вторым параметром идёт объект со значением конкретной опции
(значение, переданное в `value`/`defaultValue`).

## Доступность (a11y)

Компонент обеспечивает базовую доступность через стандартные `HTML`-атрибуты и `ARIA`-роли. Для улучшения доступности рекомендуется:

- добавлять `id` и `aria-label` для идентификации компонента;
- использовать `aria-describedby` для связывания с подсказками.

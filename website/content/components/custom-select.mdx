<Overview>

# CustomSelect

Компонент для выбора значения из выпадающего списка.
Поддерживает широкие возможности по изменению внешнего вида, поиск по опциям и пользовательский рендеринг опций.

</Overview>

> Важно: для отображения невыбранного состояния нужно использовать `value=null` вместо `undefined`.
>
> `undefined` ипользуется только для неконтролируемого компонента.

```jsx
<CustomSelect
  options={[
    { value: 0, label: 'Москва' },
    { value: 1, label: 'Санкт-Петербург' },
    { value: 2, label: 'Новосибирск' },
  ]}
/>
```

## Режим работы

Компонент поддерживает работу как в неконтролируемом режиме, так и контролируемом. Это стандартное поведение
React-компонентов, прочитать про это можно в [документации React](https://react.dev/reference/react-dom/components/input#controlling-an-input-with-a-state-variable).

Для использования неконтролируемого режима достаточно просто _не_ передавать `value` или передавать `defaultValue`, если
требуется задать значение по умолчанию.
Для контролируемого режима используйте связку свойств `value`/`onChange` для задания значения и его изменения.

```jsx
const colors = [
  {
    value: 'red',
    label: 'Красный',
  },
  {
    value: 'green',
    label: 'Зелёный',
  },
  {
    value: 'blue',
    label: 'Синий',
  },
];

// Неконтролируемое состояние
<CustomSelect options={colors} defaultValue="red" />;

// Контролируемое состояние
const [color, setColor] = React.useState('red');

<CustomSelect options={colors} value={color} onChange={(_, newColor) => setColor(newColor)} />;
```

## CustomSelectOption

```jsx
<CustomSelectOption selected>Иван Иванов</CustomSelectOption>
```

Универсальный компонент для отрисовки одного из значений в выпадающем списке.
Помимо `CustomSelect` используется и в `ChipsSelect`.

### Вложенные CustomSelectOption

Для реализации многоуровневых `CustomSelectOption` используйте свойство `hierarchy`,
которое позволяет создать нужный отступ в зависимости от уровня вложенности.

```jsx
<CustomSelectOption hierarchy={3}>Файл 1</CustomSelectOption>
```

## Тестирование (e2e) [#e2e]

Для поиска компонента и его элементов на странице cуществует ряд вспомогательных свойств:

По умолчанию все `data-*` атрибуты попадают на `<input>` компонента, это значит, что при передаче
`data-testid` или `data-test-id` идентификатор попадёт `<input>`.
Доступ к полю ввода может быть полезен для:

- получения текста, введённого пользователем при поиске опций, в режиме `searchable`;
- получения информации о наличии фокуса на компоненте;
- симуляции работы с компонентом с клавиатуры.

Используйте `labelTextTestId`:

- для симуляции работы с компонентом с помощью мыши, тач-устройства;
- для получения текста выбранной в данный момент опции.

Для взаимодействия с кнопкой очистки состояния компонента, которая появляется,
если `CustomSelect` имеет свойство `searchable` и пользователь выбрал опцию, используйте свойство `clearButtonTestId`.

`CustomSelect` внутри себя хранит невидимый `<select>`, для того, чтобы `CustomSelect` можно было использовать внутри формы.
Для получения доступа к `<select>` используйте свойство `nativeSelectTestId`. Полезно для доступа к значению `value`,
выбранной в данный момент опции.

Все перечисленные выше свойства устанавливают аттрибут `data-testid` у соответствующих элементов. Учитывайте это при построении селекторов.

## Доступность (a11y)

Следуйте рекомендациям из раздела [Цифровая доступность компонента `Select`](/components/select#a11y).

"use strict";(self.webpackChunk_vkontakte_vkui=self.webpackChunk_vkontakte_vkui||[]).push([[4922],{"./src/components/Gallery/Gallery.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>Gallery});var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),react=__webpack_require__("../../node_modules/react/index.js"),math=__webpack_require__("./src/helpers/math.ts"),useIsClient=__webpack_require__("./src/hooks/useIsClient.ts"),es6=__webpack_require__("../../node_modules/@vkontakte/vkjs/lib/es6/index.js"),useAdaptivityHasPointer=__webpack_require__("./src/hooks/useAdaptivityHasPointer.ts"),useExternRef=__webpack_require__("./src/hooks/useExternRef.ts"),useGlobalEventListener=__webpack_require__("./src/hooks/useGlobalEventListener.ts"),dom=__webpack_require__("./src/lib/dom.tsx"),useIsomorphicLayoutEffect=__webpack_require__("./src/lib/useIsomorphicLayoutEffect.ts"),RootComponent=__webpack_require__("./src/components/RootComponent/RootComponent.tsx"),ScrollArrow=__webpack_require__("./src/components/ScrollArrow/ScrollArrow.tsx"),Touch=__webpack_require__("./src/components/Touch/Touch.tsx"),calcMin=function(param){var _param_containerWidth=param.containerWidth,containerWidth=void 0===_param_containerWidth?0:_param_containerWidth,_param_layerWidth=param.layerWidth,layerWidth=void 0===_param_layerWidth?0:_param_layerWidth,_param_slides=param.slides,slides=void 0===_param_slides?[]:_param_slides,_param_viewportOffsetWidth=param.viewportOffsetWidth,viewportOffsetWidth=void 0===_param_viewportOffsetWidth?0:_param_viewportOffsetWidth,align=param.align,isCenterWithCustomWidth=param.isCenterWithCustomWidth;switch(align){case"left":return containerWidth-layerWidth;case"right":return viewportOffsetWidth-layerWidth;case"center":if(isCenterWithCustomWidth&&slides.length){var _slides_=slides[slides.length-1];return viewportOffsetWidth/2-_slides_.coordX-_slides_.width/2}return viewportOffsetWidth-(containerWidth-viewportOffsetWidth)/2-layerWidth}},calcMax=function(param){var _param_slides=param.slides,slides=void 0===_param_slides?[]:_param_slides,_param_viewportOffsetWidth=param.viewportOffsetWidth,viewportOffsetWidth=void 0===_param_viewportOffsetWidth?0:_param_viewportOffsetWidth;if(param.isCenterWithCustomWidth&&slides.length){var _slides_=slides[0],width=_slides_.width;return viewportOffsetWidth/2-_slides_.coordX-width/2}return 0},injectStylesIntoStyleTag=__webpack_require__("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),singletonStyleDomAPI=__webpack_require__("../../node_modules/style-loader/dist/runtime/singletonStyleDomAPI.js"),singletonStyleDomAPI_default=__webpack_require__.n(singletonStyleDomAPI),insertBySelector=__webpack_require__("../../node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithAttributesAndNonce=__webpack_require__("../../node_modules/style-loader/dist/runtime/setAttributesWithAttributesAndNonce.js"),setAttributesWithAttributesAndNonce_default=__webpack_require__.n(setAttributesWithAttributesAndNonce),insertStyleElement=__webpack_require__("../../node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),BaseGallery_module=__webpack_require__("../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!./src/components/BaseGallery/BaseGallery.module.css"),options={attributes:{class:"vkui-style"}};options.setAttributes=setAttributesWithAttributesAndNonce_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=singletonStyleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(BaseGallery_module.A,options);const BaseGallery_BaseGallery_module=BaseGallery_module.A&&BaseGallery_module.A.locals?BaseGallery_module.A.locals:void 0;function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){_define_property(target,key,source[key])}))}return target}function _object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function _object_without_properties(source,excluded){if(null==source)return{};var key,i,target=function _object_without_properties_loose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _sliced_to_array(arr,i){return function _array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function _iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}(arr,i)||function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var LAYOUT_DEFAULT_STATE={containerWidth:0,viewportOffsetWidth:0,layerWidth:0,min:0,max:0,slides:[],isFullyVisible:!0},SHIFT_DEFAULT_STATE={animation:void 0,shiftX:0,dragging:!1,deltaX:0,indent:0},stylesBullets={dark:BaseGallery_BaseGallery_module["BaseGallery__bullets--dark"],light:BaseGallery_BaseGallery_module["BaseGallery__bullets--light"]},BaseGallery=function(_param){var _param_bullets=_param.bullets,bullets=void 0!==_param_bullets&&_param_bullets,getRootRef=_param.getRootRef,children=_param.children,_param_slideWidth=_param.slideWidth,slideWidth=void 0===_param_slideWidth?"100%":_param_slideWidth,_param_slideIndex=_param.slideIndex,slideIndex=void 0===_param_slideIndex?0:_param_slideIndex,_param_dragDisabled=_param.dragDisabled,dragDisabled=void 0!==_param_dragDisabled&&_param_dragDisabled,onDragStart=_param.onDragStart,onDragEnd=_param.onDragEnd,onChange=_param.onChange,onPrevClick=_param.onPrevClick,onNextClick=_param.onNextClick,_param_align=_param.align,align=void 0===_param_align?"left":_param_align,showArrows=_param.showArrows,getRef=_param.getRef,_param_arrowSize=_param.arrowSize,arrowSize=void 0===_param_arrowSize?"l":_param_arrowSize,restProps=_object_without_properties(_param,["bullets","getRootRef","children","slideWidth","slideIndex","dragDisabled","onDragStart","onDragEnd","onChange","onPrevClick","onNextClick","align","showArrows","getRef","arrowSize"]),slidesStore=react.useRef({}),layoutState=react.useRef(LAYOUT_DEFAULT_STATE),_React_useState=_sliced_to_array(react.useState(SHIFT_DEFAULT_STATE),2),shiftState=_React_useState[0],setShiftState=_React_useState[1],rootRef=(0,useExternRef.Z)(getRootRef),viewportRef=(0,useExternRef.Z)(getRef),window=(0,dom.a4)().window,hasPointer=(0,useAdaptivityHasPointer.Y)(),isCenterWithCustomWidth="custom"===slideWidth&&"center"===align,validateIndent=function(value){var _layoutState_current_max,_layoutState_current_min,localMax=null!==(_layoutState_current_max=layoutState.current.max)&&void 0!==_layoutState_current_max?_layoutState_current_max:0,localMin=null!==(_layoutState_current_min=layoutState.current.min)&&void 0!==_layoutState_current_min?_layoutState_current_min:0;return value<localMin?localMin:value>localMax?localMax:value},calculateIndent=function(targetIndex){var _layoutState_current_slides;if(layoutState.current.isFullyVisible)return 0;var targetSlide=(null===(_layoutState_current_slides=layoutState.current.slides)||void 0===_layoutState_current_slides?void 0:_layoutState_current_slides.length)?layoutState.current.slides[targetIndex]:null;if(targetSlide){var _layoutState_current_viewportOffsetWidth,coordX=targetSlide.coordX,width=targetSlide.width;return isCenterWithCustomWidth?(null!==(_layoutState_current_viewportOffsetWidth=layoutState.current.viewportOffsetWidth)&&void 0!==_layoutState_current_viewportOffsetWidth?_layoutState_current_viewportOffsetWidth:0)/2-coordX-width/2:validateIndent(-1*coordX)}return 0},calculateDragIndent=function(){var _layoutState_current_max,_layoutState_current_min,localMax=null!==(_layoutState_current_max=layoutState.current.max)&&void 0!==_layoutState_current_max?_layoutState_current_max:0,localMin=null!==(_layoutState_current_min=layoutState.current.min)&&void 0!==_layoutState_current_min?_layoutState_current_min:0,indent=shiftState.shiftX+shiftState.deltaX;return indent>localMax?localMax+Number((indent-localMax)/3):indent<localMin?localMin+Number((indent-localMin)/3):indent},initializeSlides=function(){var _rootRef_current,_viewportRef_current,_layoutState_current_slides_slideIndex,_localSlides_slideIndex,_React_Children_map,_rootRef_current_offsetWidth,_viewportRef_current_offsetWidth,options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},localSlides=null!==(_React_Children_map=react.Children.map(children,(function(_item,i){var _elem_offsetLeft,_elem_offsetWidth,elem=slidesStore.current["slide-".concat(i)];return{coordX:null!==(_elem_offsetLeft=null==elem?void 0:elem.offsetLeft)&&void 0!==_elem_offsetLeft?_elem_offsetLeft:0,width:null!==(_elem_offsetWidth=null==elem?void 0:elem.offsetWidth)&&void 0!==_elem_offsetWidth?_elem_offsetWidth:0}})))&&void 0!==_React_Children_map?_React_Children_map:[],localContainerWidth=null!==(_rootRef_current_offsetWidth=null===(_rootRef_current=rootRef.current)||void 0===_rootRef_current?void 0:_rootRef_current.offsetWidth)&&void 0!==_rootRef_current_offsetWidth?_rootRef_current_offsetWidth:0,localViewportOffsetWidth=null!==(_viewportRef_current_offsetWidth=null===(_viewportRef_current=viewportRef.current)||void 0===_viewportRef_current?void 0:_viewportRef_current.offsetWidth)&&void 0!==_viewportRef_current_offsetWidth?_viewportRef_current_offsetWidth:0,localLayerWidth=localSlides.reduce((function(val,slide){return slide.width+val}),0),adjustShiftX=localSlides.length<=layoutState.current.slides.length||(null===(_layoutState_current_slides_slideIndex=layoutState.current.slides[slideIndex])||void 0===_layoutState_current_slides_slideIndex?void 0:_layoutState_current_slides_slideIndex.coordX)!==(null===(_localSlides_slideIndex=localSlides[slideIndex])||void 0===_localSlides_slideIndex?void 0:_localSlides_slideIndex.coordX);layoutState.current={containerWidth:localContainerWidth,viewportOffsetWidth:localViewportOffsetWidth,layerWidth:localLayerWidth,max:calcMax({slides:localSlides,viewportOffsetWidth:localViewportOffsetWidth,isCenterWithCustomWidth}),min:calcMin({containerWidth:localContainerWidth,layerWidth:localLayerWidth,slides:localSlides,viewportOffsetWidth:localViewportOffsetWidth,isCenterWithCustomWidth,align}),slides:localSlides,isFullyVisible:localLayerWidth<=localContainerWidth},setShiftState((function(prevState){var _options_animation;return _object_spread_props(_object_spread({},prevState),{shiftX:adjustShiftX?calculateIndent(slideIndex):prevState.shiftX,animation:null!==(_options_animation=options.animation)&&void 0!==_options_animation?_options_animation:prevState.shiftX===validateIndent(prevState.shiftX)})}))};(0,useGlobalEventListener.l)(window,"resize",(function(){void 0!==shiftState.animation&&initializeSlides({animation:!1})})),(0,useIsomorphicLayoutEffect.E)((function(){initializeSlides({animation:!1})}),[children,align,slideWidth]),(0,useIsomorphicLayoutEffect.E)((function(){void 0!==shiftState.animation&&setShiftState((function(prevState){return _object_spread_props(_object_spread({},prevState),{animation:!0,deltaX:0,shiftX:calculateIndent(null!=slideIndex?slideIndex:0)})}))}),[slideIndex]);var _layoutState_current_layerWidth,isDraggable=!dragDisabled&&!layoutState.current.isFullyVisible,indent=shiftState.dragging?calculateDragIndent():shiftState.shiftX,layerStyle={WebkitTransform:"translateX(".concat(indent,"px)"),transform:"translateX(".concat(indent,"px)"),WebkitTransition:shiftState.animation?"-webkit-transform ".concat(.24,"s cubic-bezier(.1, 0, .25, 1)"):"none",transition:shiftState.animation?"transform ".concat(.24,"s cubic-bezier(.1, 0, .25, 1)"):"none"},canSlideLeft=!layoutState.current.isFullyVisible&&shiftState.shiftX<0,canSlideRight=!layoutState.current.isFullyVisible&&("left"===align&&layoutState.current.containerWidth-shiftState.shiftX<(null!==(_layoutState_current_layerWidth=layoutState.current.layerWidth)&&void 0!==_layoutState_current_layerWidth?_layoutState_current_layerWidth:0)||"left"!==align&&slideIndex<layoutState.current.slides.length-1);return(0,jsx_runtime.jsxs)(RootComponent.I,_object_spread_props(_object_spread({},restProps),{baseClassName:(0,es6.xW)(BaseGallery_BaseGallery_module.BaseGallery,"center"===align&&BaseGallery_BaseGallery_module["BaseGallery--align-center"],"custom"===slideWidth&&BaseGallery_BaseGallery_module["BaseGallery--custom-width"],isDraggable&&BaseGallery_BaseGallery_module["BaseGallery--draggable"]),getRootRef:rootRef,children:[(0,jsx_runtime.jsx)(Touch.U,{className:BaseGallery_BaseGallery_module.BaseGallery__viewport,onStartX:function(e){e.originalEvent.stopPropagation(),isDraggable&&(null==onDragStart||onDragStart(e),setShiftState((function(prevState){return _object_spread_props(_object_spread({},prevState),{animation:!1})})))},onMoveX:function(e){isDraggable&&(e.originalEvent.preventDefault(),e.isSlideX&&shiftState.deltaX!==e.shiftX&&setShiftState((function(prevState){return _object_spread_props(_object_spread({},prevState),{deltaX:e.shiftX,dragging:e.isSlideX})})))},onEnd:function(e){if(isDraggable){var targetIndex=e.isSlide?function(e){var _layoutState_current_max,expectDeltaX=shiftState.deltaX/e.duration*240*.6,shift=shiftState.shiftX+shiftState.deltaX+expectDeltaX-(null!==(_layoutState_current_max=layoutState.current.max)&&void 0!==_layoutState_current_max?_layoutState_current_max:0),direction=shiftState.deltaX<0?1:-1,targetIndex=layoutState.current.slides.reduce((function(val,item,index){return Math.abs(layoutState.current.slides[val].coordX+shift)<Math.abs(item.coordX+shift)?val:index}),slideIndex);if(targetIndex===slideIndex){var targetSlide=slideIndex+direction;targetSlide>=0&&targetSlide<layoutState.current.slides.length&&Math.abs(shiftState.deltaX)>.05*layoutState.current.slides[targetSlide].width&&(targetIndex=targetSlide)}return targetIndex}(e):null!=slideIndex?slideIndex:0;null==onDragEnd||onDragEnd(e,targetIndex);var nextShiftState={animation:!0,dragging:!1,deltaX:0},shiftXStick=calculateDragIndent();targetIndex!==slideIndex&&(nextShiftState.shiftX=shiftXStick),setShiftState((function(prevState){return _object_spread({},prevState,nextShiftState)})),targetIndex!==slideIndex&&(null==onChange||onChange(targetIndex))}},style:{width:"custom"===slideWidth?"100%":slideWidth},getRootRef:viewportRef,noSlideClick:!0,children:(0,jsx_runtime.jsx)("div",{className:BaseGallery_BaseGallery_module.BaseGallery__layer,style:layerStyle,children:react.Children.map(children,(function(item,i){return(0,jsx_runtime.jsx)("div",{className:BaseGallery_BaseGallery_module.BaseGallery__slide,ref:function(el){return function(slideRef,slideIndex){slidesStore.current["slide-".concat(slideIndex)]=slideRef}(el,i)},children:item},"slide-".concat(i))}))})}),bullets&&(0,jsx_runtime.jsx)("div",{"aria-hidden":!0,className:(0,es6.xW)(BaseGallery_BaseGallery_module.BaseGallery__bullets,stylesBullets[bullets]),children:react.Children.map(children,(function(_item,index){return(0,jsx_runtime.jsx)("div",{className:(0,es6.xW)(BaseGallery_BaseGallery_module.BaseGallery__bullet,index===slideIndex&&BaseGallery_BaseGallery_module["BaseGallery__bullet--active"])},index)}))}),showArrows&&hasPointer&&canSlideLeft&&(0,jsx_runtime.jsx)(ScrollArrow.L,{className:BaseGallery_BaseGallery_module.BaseGallery__arrow,direction:"left",onClick:function(event){null==onChange||onChange(slideIndex-1),null==onPrevClick||onPrevClick(event)},size:arrowSize}),showArrows&&hasPointer&&canSlideRight&&(0,jsx_runtime.jsx)(ScrollArrow.L,{className:BaseGallery_BaseGallery_module.BaseGallery__arrow,direction:"right",onClick:function(event){null==onChange||onChange(slideIndex+1),null==onNextClick||onNextClick(event)},size:arrowSize})]}))};try{BaseGallery.displayName="BaseGallery",BaseGallery.__docgenInfo={description:"",displayName:"BaseGallery",props:{slideWidth:{defaultValue:{value:"100%"},description:"",name:"slideWidth",required:!1,type:{name:"string | number"}},slideIndex:{defaultValue:{value:"0"},description:"",name:"slideIndex",required:!1,type:{name:"number"}},onDragStart:{defaultValue:null,description:"",name:"onDragStart",required:!1,type:{name:"TouchEventHandler"}},onDragEnd:{defaultValue:null,description:"",name:"onDragEnd",required:!1,type:{name:"((e: TouchEvent, targetIndex: number) => void)"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((current: number) => void)"}},onPrevClick:{defaultValue:null,description:"Будет вызвано при клике на кнопку-стрелку влево",name:"onPrevClick",required:!1,type:{name:"((event: MouseEvent<Element, MouseEvent>) => void)"}},onNextClick:{defaultValue:null,description:"Будет вызвано при клике на кнопку-стрелку вправо",name:"onNextClick",required:!1,type:{name:"((event: MouseEvent<Element, MouseEvent>) => void)"}},bullets:{defaultValue:{value:"false"},description:"",name:"bullets",required:!1,type:{name:'false | "light" | "dark"'}},dragDisabled:{defaultValue:{value:"false"},description:"Позволяет отключить реагирование на тач-события",name:"dragDisabled",required:!1,type:{name:"boolean"}},showArrows:{defaultValue:null,description:"",name:"showArrows",required:!1,type:{name:"boolean"}},hasPointer:{defaultValue:null,description:"",name:"hasPointer",required:!1,type:{name:"boolean"}},arrowSize:{defaultValue:{value:"l"},description:"",name:"arrowSize",required:!1,type:{name:"enum",value:[{value:'"m"'},{value:'"l"'}]}},arrowPrevLabel:{defaultValue:null,description:"Текст для кнопки-стрелки влево (назад). Делает ее доступной для ассистивных технологий",name:"arrowPrevLabel",required:!1,type:{name:"string"}},arrowNextLabel:{defaultValue:null,description:"Текст для кнопки-стрелки вправо (вперед). Делает ее доступной для ассистивных технологий",name:"arrowNextLabel",required:!1,type:{name:"string"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLDivElement>"}},align:{defaultValue:{value:"left"},description:"",name:"align",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"right"'},{value:'"left"'}]}},getRef:{defaultValue:null,description:"",name:"getRef",required:!1,type:{name:"Ref<HTMLElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/BaseGallery/BaseGallery.tsx#BaseGallery"]={docgenInfo:BaseGallery.__docgenInfo,name:"BaseGallery",path:"src/components/BaseGallery/BaseGallery.tsx#BaseGallery"})}catch(__react_docgen_typescript_loader_error){}var warnOnce=__webpack_require__("./src/lib/warnOnce.ts"),CONTROL_ELEMENTS_STATE={canSlideLeft:!0,canSlideRight:!0,isDraggable:!0},SLIDES_MANAGER_STATE={viewportOffsetWidth:0,slides:[],isFullyVisible:!0,loopPoints:[],contentSize:0,snaps:[]};function helpers_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _to_consumable_array(arr){return function _array_without_holes(arr){if(Array.isArray(arr))return helpers_array_like_to_array(arr)}(arr)||function _iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function helpers_unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return helpers_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return helpers_array_like_to_array(o,minLen)}(arr)||function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function getShiftedIndexes(direction,slides,availableWidth){for(var gap=availableWidth,shiftedSlideIndexes=[],startIndex=1===direction?0:slides.length-1,endIndex=1===direction?slides.length-1:0,i=startIndex;(1===direction?i<=endIndex:i>=endIndex)&&gap>0;i+=direction){var slideWidth=slides[i].width;gap>0&&shiftedSlideIndexes.push(i),gap-=slideWidth}return shiftedSlideIndexes}function calculateLoopPoints(indexes,edge,slidesManager,containerWidth){var contentSize=slidesManager.contentSize,slides=slidesManager.slides,snaps=slidesManager.snaps,isStartEdge="start"===edge,offset=isStartEdge?-contentSize:contentSize;return indexes.map((function(index){var initial=isStartEdge?0:-contentSize,altered=isStartEdge?contentSize:0,loopPoint=isStartEdge?snaps[index]+containerWidth+offset:snaps[index]-slides[index].width+offset-snaps[0];return{index,target:function(currentLocation){return currentLocation>=loopPoint?initial:altered}}}))}var TIMING_FUNCTION=(0,__webpack_require__("./src/lib/fx.ts").A)(.8,1);function useSlideAnimation(){var animationQueue=react.useRef([]);return{getAnimateFunction:function getAnimateFunction(drawFunction){return function(){!function animate(param){var start,duration=param.duration,timing=param.timing,draw=param.draw,_param_animationQueue=param.animationQueue,animationQueue=void 0===_param_animationQueue?[]:_param_animationQueue;es6.Sw&&requestAnimationFrame((function animate(time){start||(start=time);var timeFraction=Math.min((time-start)/duration,1),progress=timing(timeFraction);draw(progress),timeFraction<1?requestAnimationFrame(animate):(animationQueue.shift(),animationQueue.length>0&&animationQueue[0]())}))}({duration:240,timing:TIMING_FUNCTION,animationQueue:animationQueue.current,draw:drawFunction})}},addToAnimationQueue:function addToAnimationQueue(func){animationQueue.current.push(func)},startAnimation:function startAnimation(){1===animationQueue.current.length&&animationQueue.current[0]()}}}function CarouselBase_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function CarouselBase_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function CarouselBase_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){CarouselBase_define_property(target,key,source[key])}))}return target}function CarouselBase_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function CarouselBase_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function CarouselBase_object_without_properties(source,excluded){if(null==source)return{};var key,i,target=function CarouselBase_object_without_properties_loose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function CarouselBase_sliced_to_array(arr,i){return function CarouselBase_array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function CarouselBase_iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function CarouselBase_unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return CarouselBase_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CarouselBase_array_like_to_array(o,minLen)}(arr,i)||function CarouselBase_non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var CarouselBase_stylesBullets={dark:BaseGallery_BaseGallery_module["BaseGallery__bullets--dark"],light:BaseGallery_BaseGallery_module["BaseGallery__bullets--light"]},CarouselBase=((0,warnOnce.m)("Gallery"),function(_param){var _param_bullets=_param.bullets,bullets=void 0!==_param_bullets&&_param_bullets,getRootRef=_param.getRootRef,children=_param.children,_param_slideWidth=_param.slideWidth,slideWidth=void 0===_param_slideWidth?"100%":_param_slideWidth,_param_slideIndex=_param.slideIndex,slideIndex=void 0===_param_slideIndex?0:_param_slideIndex,_param_dragDisabled=_param.dragDisabled,dragDisabled=void 0!==_param_dragDisabled&&_param_dragDisabled,onDragStart=_param.onDragStart,onDragEnd=_param.onDragEnd,onChange=_param.onChange,onPrevClick=_param.onPrevClick,onNextClick=_param.onNextClick,_param_align=_param.align,align=void 0===_param_align?"left":_param_align,showArrows=_param.showArrows,getRef=_param.getRef,_param_arrowSize=_param.arrowSize,arrowSize=void 0===_param_arrowSize?"l":_param_arrowSize,restProps=CarouselBase_object_without_properties(_param,["bullets","getRootRef","children","slideWidth","slideIndex","dragDisabled","onDragStart","onDragEnd","onChange","onPrevClick","onNextClick","align","showArrows","getRef","arrowSize"]),slidesStore=react.useRef({}),slidesManager=react.useRef(SLIDES_MANAGER_STATE),rootRef=(0,useExternRef.Z)(getRootRef),viewportRef=(0,useExternRef.Z)(getRef),layerRef=react.useRef(null),animationFrameRef=react.useRef(null),shiftXCurrentRef=react.useRef(0),shiftXDeltaRef=react.useRef(0),initialized=react.useRef(!1),_useSlideAnimation=useSlideAnimation(),addToAnimationQueue=_useSlideAnimation.addToAnimationQueue,getAnimateFunction=_useSlideAnimation.getAnimateFunction,startAnimation=_useSlideAnimation.startAnimation,_React_useState=CarouselBase_sliced_to_array(react.useState(CONTROL_ELEMENTS_STATE),2),controlElementsState=_React_useState[0],setControlElementsState=_React_useState[1],window=(0,dom.a4)().window,hasPointer=(0,useAdaptivityHasPointer.Y)(),isCenterWithCustomWidth="custom"===slideWidth&&"center"===align,transformCssStyles=function(shiftX){var animation=arguments.length>1&&void 0!==arguments[1]&&arguments[1];slidesManager.current.loopPoints.forEach((function(loopPoint){var target=loopPoint.target,index=loopPoint.index,slide=slidesStore.current[index];slide&&(slide.style.transform="translate3d(".concat(target(shiftX),"px, 0, 0)"))})),layerRef.current&&(layerRef.current.style.transform="translate3d(".concat(shiftX,"px, 0, 0)"),layerRef.current.style.transition=animation?"transform ".concat(240,"ms cubic-bezier(.1, 0, .25, 1)"):"")},requestTransform=function(shiftX){var animation=arguments.length>1&&void 0!==arguments[1]&&arguments[1],_slidesManager_current=slidesManager.current,snaps=_slidesManager_current.snaps,contentSize=_slidesManager_current.contentSize,slides=_slidesManager_current.slides;null!==animationFrameRef.current&&cancelAnimationFrame(animationFrameRef.current),animationFrameRef.current=requestAnimationFrame((function(){shiftX>snaps[0]&&(shiftXCurrentRef.current=-contentSize+snaps[0],shiftX=shiftXCurrentRef.current+shiftXDeltaRef.current);var lastPoint=slides[slides.length-1].width+slides[slides.length-1].coordX;shiftX<=-lastPoint&&(shiftXCurrentRef.current=Math.abs(shiftXDeltaRef.current)+snaps[0]),transformCssStyles(shiftX,animation)}))},initializeSlides=function(){if(rootRef.current&&viewportRef.current){var localSlides=react.Children.map(children,(function(_item,i){var elem=slidesStore.current[i]||{offsetLeft:0,offsetWidth:0};return{coordX:elem.offsetLeft,width:elem.offsetWidth}}))||[],containerWidth=rootRef.current.offsetWidth,viewportOffsetWidth=viewportRef.current.offsetWidth,layerWidth=localSlides.reduce((function(val,slide){return slide.width+val}),0);if("center"===align){var firstSlideShift=(containerWidth-localSlides[0].width)/2;localSlides=localSlides.map((function(item){return{width:item.width,coordX:item.coordX-firstSlideShift}}))}slidesManager.current=CarouselBase_object_spread_props(CarouselBase_object_spread({},slidesManager.current),{viewportOffsetWidth,slides:localSlides,isFullyVisible:layerWidth<=containerWidth});var snaps=localSlides.map((function(_,index){return function calculateIndent(targetIndex,slidesManager,isCenterWithCustomWidth){if(slidesManager.isFullyVisible||!slidesManager.slides.length)return 0;var targetSlide=slidesManager.slides[targetIndex];if(targetSlide){var coordX=targetSlide.coordX,width=targetSlide.width;return isCenterWithCustomWidth?slidesManager.viewportOffsetWidth/2-coordX-width/2:-1*coordX}return 0}(index,slidesManager.current,isCenterWithCustomWidth)})),contentSize=-snaps[snaps.length-1]+localSlides[localSlides.length-1].width;"center"===align&&(contentSize+=snaps[0]),slidesManager.current.snaps=snaps,slidesManager.current.contentSize=contentSize,slidesManager.current.loopPoints=function getLoopPoints(slidesManager,containerWidth){var slides=slidesManager.slides,snaps=slidesManager.snaps,startShiftedIndexes=getShiftedIndexes(-1,slides,snaps[0]);return _to_consumable_array(calculateLoopPoints(getShiftedIndexes(1,slides,containerWidth-snaps[0]),"start",slidesManager,containerWidth)).concat(_to_consumable_array(calculateLoopPoints(startShiftedIndexes,"end",slidesManager,containerWidth)))}(slidesManager.current,containerWidth),setControlElementsState({canSlideLeft:!slidesManager.current.isFullyVisible,canSlideRight:!slidesManager.current.isFullyVisible,isDraggable:!(dragDisabled||slidesManager.current.isFullyVisible)}),shiftXCurrentRef.current=snaps[slideIndex],initialized.current=!0,requestTransform(shiftXCurrentRef.current)}};(0,useGlobalEventListener.l)(window,"resize",(function(){initialized.current&&initializeSlides()})),(0,useIsomorphicLayoutEffect.E)((function performSlideChange(){if(initialized.current){var _slidesManager_current=slidesManager.current,snaps=_slidesManager_current.snaps,slides=_slidesManager_current.slides,indent=snaps[slideIndex],startPoint=shiftXCurrentRef.current;if(indent===snaps[0]&&shiftXCurrentRef.current<=snaps[snaps.length-1]){var distance=Math.abs(snaps[snaps.length-1])+slides[slides.length-1].width+startPoint;addToAnimationQueue(getAnimateFunction((function(progress){var shiftX=startPoint+progress*distance*-1;transformCssStyles(shiftX),shiftX<=snaps[snaps.length-1]-slides[slides.length-1].width&&requestAnimationFrame((function(){shiftXCurrentRef.current=indent,transformCssStyles(snaps[0])}))})))}else indent===snaps[snaps.length-1]&&shiftXCurrentRef.current===snaps[0]?(startPoint=indent-slides[slides.length-1].width,addToAnimationQueue((function(){requestAnimationFrame((function(){var shiftX=indent-slides[slides.length-1].width;transformCssStyles(shiftX),getAnimateFunction((function(progress){transformCssStyles(startPoint+progress*slides[slides.length-1].width)}))()}))}))):addToAnimationQueue((function(){var distance=Math.abs(indent-startPoint),direction=startPoint<=indent?1:-1;getAnimateFunction((function(progress){transformCssStyles(startPoint+progress*distance*direction)}))()}));startAnimation(),shiftXCurrentRef.current=indent}}),[slideIndex]),(0,useIsomorphicLayoutEffect.E)((function(){initializeSlides()}),[children,align,slideWidth]);var canSlideLeft=controlElementsState.canSlideLeft,canSlideRight=controlElementsState.canSlideRight,isDraggable=controlElementsState.isDraggable;return(0,jsx_runtime.jsxs)(RootComponent.I,CarouselBase_object_spread_props(CarouselBase_object_spread({},restProps),{baseClassName:(0,es6.xW)(BaseGallery_BaseGallery_module.BaseGallery,"custom"===slideWidth&&BaseGallery_BaseGallery_module["BaseGallery--custom-width"],isDraggable&&BaseGallery_BaseGallery_module["BaseGallery--draggable"]),getRootRef:rootRef,children:[(0,jsx_runtime.jsx)(Touch.U,{className:BaseGallery_BaseGallery_module.BaseGallery__viewport,onStartX:function(e){e.originalEvent.stopPropagation(),controlElementsState.isDraggable&&(null==onDragStart||onDragStart(e),shiftXCurrentRef.current=slidesManager.current.snaps[slideIndex],shiftXDeltaRef.current=0)},onMoveX:function(e){controlElementsState.isDraggable&&(e.originalEvent.preventDefault(),e.isSlideX&&shiftXDeltaRef.current!==e.shiftX&&(shiftXDeltaRef.current=e.shiftX,requestTransform(shiftXCurrentRef.current+shiftXDeltaRef.current)))},onEnd:function(e){if(controlElementsState.isDraggable){var targetIndex=slideIndex;if(e.isSlide&&(targetIndex=function getTargetIndex(slides,slideIndex,currentShiftX,currentShiftXDelta){var shift=currentShiftX+currentShiftXDelta,direction=currentShiftXDelta<0?1:-1,targetIndex=slides.reduce((function(val,item,index){return Math.abs(slides[val].coordX+shift)<Math.abs(item.coordX+shift)?val:index}),slideIndex);if(targetIndex===slideIndex){var targetSlide=slideIndex+direction;return targetSlide>=0&&targetSlide<slides.length?Math.abs(currentShiftXDelta)>.05*slides[targetSlide].width?targetSlide:targetIndex:direction<0?(targetSlide+slides.length)%slides.length:targetSlide%slides.length}return targetIndex}(slidesManager.current.slides,slideIndex,shiftXCurrentRef.current,shiftXDeltaRef.current)),null==onDragEnd||onDragEnd(e,targetIndex),targetIndex!==slideIndex)shiftXCurrentRef.current=shiftXCurrentRef.current+shiftXDeltaRef.current,null==onChange||onChange(targetIndex);else{var initialShiftX=slidesManager.current.snaps[targetIndex];requestTransform(initialShiftX,!0)}}},style:{width:"custom"===slideWidth?"100%":slideWidth},getRootRef:viewportRef,noSlideClick:!0,children:(0,jsx_runtime.jsx)("div",{className:BaseGallery_BaseGallery_module.BaseGallery__layer,ref:layerRef,children:react.Children.map(children,(function(item,i){return(0,jsx_runtime.jsx)("div",{className:BaseGallery_BaseGallery_module.BaseGallery__slide,ref:function(el){return function(slideRef,slideIndex){slidesStore.current[slideIndex]=slideRef}(el,i)},children:item},"slide-".concat(i))}))})}),bullets&&(0,jsx_runtime.jsx)("div",{"aria-hidden":!0,className:(0,es6.xW)(BaseGallery_BaseGallery_module.BaseGallery__bullets,CarouselBase_stylesBullets[bullets]),children:react.Children.map(children,(function(_item,index){return(0,jsx_runtime.jsx)("div",{className:(0,es6.xW)(BaseGallery_BaseGallery_module.BaseGallery__bullet,index===slideIndex&&BaseGallery_BaseGallery_module["BaseGallery__bullet--active"])},index)}))}),showArrows&&hasPointer&&canSlideLeft&&(0,jsx_runtime.jsx)(ScrollArrow.L,{className:BaseGallery_BaseGallery_module.BaseGallery__arrow,direction:"left",onClick:function(event){null==onChange||onChange((slideIndex-1+slidesManager.current.slides.length)%slidesManager.current.slides.length),null==onPrevClick||onPrevClick(event)},size:arrowSize}),showArrows&&hasPointer&&canSlideRight&&(0,jsx_runtime.jsx)(ScrollArrow.L,{className:BaseGallery_BaseGallery_module.BaseGallery__arrow,direction:"right",onClick:function(event){null==onChange||onChange((slideIndex+1)%slidesManager.current.slides.length),null==onNextClick||onNextClick(event)},size:arrowSize})]}))});try{CarouselBase.displayName="CarouselBase",CarouselBase.__docgenInfo={description:"",displayName:"CarouselBase",props:{slideWidth:{defaultValue:{value:"100%"},description:"",name:"slideWidth",required:!1,type:{name:"string | number"}},slideIndex:{defaultValue:{value:"0"},description:"",name:"slideIndex",required:!1,type:{name:"number"}},onDragStart:{defaultValue:null,description:"",name:"onDragStart",required:!1,type:{name:"TouchEventHandler"}},onDragEnd:{defaultValue:null,description:"",name:"onDragEnd",required:!1,type:{name:"((e: TouchEvent, targetIndex: number) => void)"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((current: number) => void)"}},onPrevClick:{defaultValue:null,description:"Будет вызвано при клике на кнопку-стрелку влево",name:"onPrevClick",required:!1,type:{name:"((event: MouseEvent<Element, MouseEvent>) => void)"}},onNextClick:{defaultValue:null,description:"Будет вызвано при клике на кнопку-стрелку вправо",name:"onNextClick",required:!1,type:{name:"((event: MouseEvent<Element, MouseEvent>) => void)"}},bullets:{defaultValue:{value:"false"},description:"",name:"bullets",required:!1,type:{name:'false | "light" | "dark"'}},dragDisabled:{defaultValue:{value:"false"},description:"Позволяет отключить реагирование на тач-события",name:"dragDisabled",required:!1,type:{name:"boolean"}},showArrows:{defaultValue:null,description:"",name:"showArrows",required:!1,type:{name:"boolean"}},hasPointer:{defaultValue:null,description:"",name:"hasPointer",required:!1,type:{name:"boolean"}},arrowSize:{defaultValue:{value:"l"},description:"",name:"arrowSize",required:!1,type:{name:"enum",value:[{value:'"m"'},{value:'"l"'}]}},arrowPrevLabel:{defaultValue:null,description:"Текст для кнопки-стрелки влево (назад). Делает ее доступной для ассистивных технологий",name:"arrowPrevLabel",required:!1,type:{name:"string"}},arrowNextLabel:{defaultValue:null,description:"Текст для кнопки-стрелки вправо (вперед). Делает ее доступной для ассистивных технологий",name:"arrowNextLabel",required:!1,type:{name:"string"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLDivElement>"}},align:{defaultValue:{value:"left"},description:"",name:"align",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"right"'},{value:'"left"'}]}},getRef:{defaultValue:null,description:"",name:"getRef",required:!1,type:{name:"Ref<HTMLElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/BaseGallery/CarouselBase/CarouselBase.tsx#CarouselBase"]={docgenInfo:CarouselBase.__docgenInfo,name:"CarouselBase",path:"src/components/BaseGallery/CarouselBase/CarouselBase.tsx#CarouselBase"})}catch(__react_docgen_typescript_loader_error){}var useStableCallback=__webpack_require__("./src/hooks/useStableCallback.ts");function Gallery_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Gallery_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function Gallery_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function Gallery_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function Gallery_object_without_properties(source,excluded){if(null==source)return{};var key,i,target=function Gallery_object_without_properties_loose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function Gallery_sliced_to_array(arr,i){return function Gallery_array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function Gallery_iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function Gallery_unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return Gallery_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gallery_array_like_to_array(o,minLen)}(arr,i)||function Gallery_non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Gallery=function(_param){var _props_slideIndex,_param_initialSlideIndex=_param.initialSlideIndex,initialSlideIndex=void 0===_param_initialSlideIndex?0:_param_initialSlideIndex,children=_param.children,_param_timeout=_param.timeout,timeout=void 0===_param_timeout?0:_param_timeout,onChange=_param.onChange,bullets=_param.bullets,looped=_param.looped,props=Gallery_object_without_properties(_param,["initialSlideIndex","children","timeout","onChange","bullets","looped"]),_React_useState=Gallery_sliced_to_array(react.useState(initialSlideIndex),2),localSlideIndex=_React_useState[0],setSlideIndex=_React_useState[1],isControlled="number"==typeof props.slideIndex,slideIndex=isControlled?null!==(_props_slideIndex=props.slideIndex)&&void 0!==_props_slideIndex?_props_slideIndex:0:localSlideIndex,slides=react.useMemo((function(){return react.Children.toArray(children).filter((function(item){return Boolean(item)}))}),[children]),childCount=slides.length,isClient=(0,useIsClient.D)(),handleChange=react.useCallback((function(current){current!==slideIndex&&(!isControlled&&setSlideIndex(current),onChange&&onChange(current))}),[isControlled,onChange,slideIndex]);!function useAutoPlay(timeout,slideIndex,callbackFnProp){var document=(0,dom.a4)().document,callbackFn=(0,useStableCallback.K)(callbackFnProp);react.useEffect((function initializeAutoPlay(){if(document&&timeout){var timeoutId=null,stop=function(){timeoutId&&(clearTimeout(timeoutId),timeoutId=null)},start=function(){switch(document.visibilityState){case"visible":stop(),timeoutId=setTimeout(callbackFn,timeout);break;case"hidden":stop()}};return start(),document.addEventListener("visibilitychange",start),function(){stop(),document.removeEventListener("visibilitychange",start)}}}),[document,timeout,slideIndex,callbackFn])}(timeout,slideIndex,(function(){return handleChange((slideIndex+1)%childCount)}));var safeSlideIndex=childCount>0?(0,math.qE)(slideIndex,0,childCount-1):slideIndex;if(react.useEffect((function(){onChange&&safeSlideIndex!==slideIndex&&onChange(safeSlideIndex),setSlideIndex(safeSlideIndex)}),[onChange,safeSlideIndex,slideIndex]),!isClient)return null;var Component=looped?CarouselBase:BaseGallery;return(0,jsx_runtime.jsx)(Component,Gallery_object_spread_props(function Gallery_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){Gallery_define_property(target,key,source[key])}))}return target}({dragDisabled:isControlled&&!onChange},props),{bullets:childCount>0&&bullets,slideIndex:safeSlideIndex,onChange:handleChange,children:slides}))};try{Gallery.displayName="Gallery",Gallery.__docgenInfo={description:"",displayName:"Gallery",props:{initialSlideIndex:{defaultValue:{value:"0"},description:"",name:"initialSlideIndex",required:!1,type:{name:"number"}},timeout:{defaultValue:{value:"0"},description:"",name:"timeout",required:!1,type:{name:"number"}},looped:{defaultValue:null,description:"",name:"looped",required:!1,type:{name:"boolean"}},slideWidth:{defaultValue:null,description:"",name:"slideWidth",required:!1,type:{name:"string | number"}},slideIndex:{defaultValue:null,description:"",name:"slideIndex",required:!1,type:{name:"number"}},onDragStart:{defaultValue:null,description:"",name:"onDragStart",required:!1,type:{name:"TouchEventHandler"}},onDragEnd:{defaultValue:null,description:"",name:"onDragEnd",required:!1,type:{name:"((e: TouchEvent, targetIndex: number) => void)"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((current: number) => void)"}},onPrevClick:{defaultValue:null,description:"Будет вызвано при клике на кнопку-стрелку влево",name:"onPrevClick",required:!1,type:{name:"((event: MouseEvent<Element, MouseEvent>) => void)"}},onNextClick:{defaultValue:null,description:"Будет вызвано при клике на кнопку-стрелку вправо",name:"onNextClick",required:!1,type:{name:"((event: MouseEvent<Element, MouseEvent>) => void)"}},bullets:{defaultValue:null,description:"",name:"bullets",required:!1,type:{name:'false | "light" | "dark"'}},dragDisabled:{defaultValue:null,description:"Позволяет отключить реагирование на тач-события",name:"dragDisabled",required:!1,type:{name:"boolean"}},showArrows:{defaultValue:null,description:"",name:"showArrows",required:!1,type:{name:"boolean"}},hasPointer:{defaultValue:null,description:"",name:"hasPointer",required:!1,type:{name:"boolean"}},arrowSize:{defaultValue:null,description:"",name:"arrowSize",required:!1,type:{name:"enum",value:[{value:'"m"'},{value:'"l"'}]}},arrowPrevLabel:{defaultValue:null,description:"Текст для кнопки-стрелки влево (назад). Делает ее доступной для ассистивных технологий",name:"arrowPrevLabel",required:!1,type:{name:"string"}},arrowNextLabel:{defaultValue:null,description:"Текст для кнопки-стрелки вправо (вперед). Делает ее доступной для ассистивных технологий",name:"arrowNextLabel",required:!1,type:{name:"string"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLDivElement>"}},align:{defaultValue:null,description:"",name:"align",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"right"'},{value:'"left"'}]}},getRef:{defaultValue:null,description:"",name:"getRef",required:!1,type:{name:"Ref<HTMLElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Gallery/Gallery.tsx#Gallery"]={docgenInfo:Gallery.__docgenInfo,name:"Gallery",path:"src/components/Gallery/Gallery.tsx#Gallery"})}catch(__react_docgen_typescript_loader_error){}},"../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!./src/components/BaseGallery/BaseGallery.module.css":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".BaseGallery--aehDU{overflow:hidden;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.BaseGallery__viewport--I1eNk{block-size:100%;margin:0;position:relative}.BaseGallery--align-center--JQQn4 .BaseGallery__viewport--I1eNk{margin-block:0;margin-inline:auto}.BaseGallery__layer--nJ0KW{align-items:stretch;block-size:100%;display:flex;inline-size:100%;min-block-size:100px}.BaseGallery--draggable--J_egI .BaseGallery__layer--nJ0KW{cursor:-webkit-grab;cursor:grab}.BaseGallery__layer--nJ0KW:empty{min-block-size:0}.BaseGallery__slide--N5num{flex:0 0 auto;inline-size:100%;max-inline-size:100%;overflow:hidden}.BaseGallery--custom-width--Cet7r .BaseGallery__slide--N5num{inline-size:auto}.BaseGallery__slide--N5num>*{inline-size:100%;min-block-size:100%}.BaseGallery__bullets--acbMd{align-items:center;block-size:6px;display:flex;inline-size:100%;inset-block-end:10px;inset-inline-start:0;justify-content:center;position:absolute}.BaseGallery__bullets--dark--T_Veu .BaseGallery__bullet--YYi6w{background-color:var(--vkui--color_icon_primary_invariably)}.BaseGallery__bullets--light--wkxQq .BaseGallery__bullet--YYi6w{background-color:var(--vkui--color_icon_contrast)}.BaseGallery__bullet--YYi6w{block-size:6px;border-radius:50%;inline-size:6px;margin-block:0;margin-inline:3px;opacity:var(--vkui--opacity_disable_accessibility)}.BaseGallery__bullet--active--WpJY6{opacity:1}.BaseGallery__arrow--Z8JoJ{inset-block-start:0;opacity:0;position:absolute}.BaseGallery--aehDU:hover .BaseGallery__arrow--Z8JoJ{opacity:var(--vkui--opacity_disable_accessibility)}.BaseGallery--aehDU .BaseGallery__arrow--Z8JoJ:hover{opacity:1}","",{version:3,sources:["webpack://./src/components/BaseGallery/BaseGallery.module.css"],names:[],mappings:"AAAA,oBAEE,eAAgB,CADhB,iBAAkB,CAElB,wBAAiB,CAAjB,qBAAiB,CAAjB,oBAAiB,CAAjB,gBACF,CAEA,8BAEE,eAAgB,CADhB,QAAS,CAET,iBACF,CAEA,gEACE,cAAe,CACf,kBACF,CAEA,2BAKE,mBAAoB,CAFpB,eAAgB,CAFhB,YAAa,CACb,gBAAiB,CAEjB,oBAEF,CAEA,0DACE,mBAAY,CAAZ,WACF,CAEA,iCACE,gBACF,CAEA,2BAEE,aAAc,CADd,gBAAiB,CAEjB,oBAAqB,CACrB,eACF,CAEA,6DACE,gBACF,CAGA,6BACE,gBAAiB,CACjB,mBACF,CAEA,6BAOE,kBAAmB,CAJnB,cAAe,CAGf,YAAa,CAFb,gBAAiB,CAFjB,oBAAqB,CAGrB,oBAAqB,CAGrB,sBAAuB,CAPvB,iBAQF,CAEA,+DACE,2DACF,CAEA,gEACE,iDACF,CAEA,4BACE,cAAe,CAEf,iBAAkB,CADlB,eAAgB,CAEhB,cAAe,CACf,iBAAkB,CAClB,kDACF,CAEA,oCACE,SACF,CAEA,2BAEE,mBAAoB,CACpB,SAAU,CAFV,iBAGF,CAEA,qDACE,kDACF,CAEA,qDACE,SACF",sourcesContent:[".BaseGallery {\n  position: relative;\n  overflow: hidden;\n  user-select: none;\n}\n\n.BaseGallery__viewport {\n  margin: 0;\n  block-size: 100%;\n  position: relative;\n}\n\n.BaseGallery--align-center .BaseGallery__viewport {\n  margin-block: 0;\n  margin-inline: auto;\n}\n\n.BaseGallery__layer {\n  display: flex;\n  inline-size: 100%;\n  block-size: 100%;\n  min-block-size: 100px;\n  align-items: stretch;\n}\n\n.BaseGallery--draggable .BaseGallery__layer {\n  cursor: grab;\n}\n\n.BaseGallery__layer:empty {\n  min-block-size: 0;\n}\n\n.BaseGallery__slide {\n  inline-size: 100%;\n  flex: 0 0 auto;\n  max-inline-size: 100%;\n  overflow: hidden;\n}\n\n.BaseGallery--custom-width .BaseGallery__slide {\n  inline-size: auto;\n}\n\n/* stylelint-disable-next-line selector-max-universal */\n.BaseGallery__slide > * {\n  inline-size: 100%;\n  min-block-size: 100%;\n}\n\n.BaseGallery__bullets {\n  position: absolute;\n  inset-block-end: 10px;\n  block-size: 6px;\n  inline-size: 100%;\n  inset-inline-start: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.BaseGallery__bullets--dark .BaseGallery__bullet {\n  background-color: var(--vkui--color_icon_primary_invariably);\n}\n\n.BaseGallery__bullets--light .BaseGallery__bullet {\n  background-color: var(--vkui--color_icon_contrast);\n}\n\n.BaseGallery__bullet {\n  block-size: 6px;\n  inline-size: 6px;\n  border-radius: 50%;\n  margin-block: 0;\n  margin-inline: 3px;\n  opacity: var(--vkui--opacity_disable_accessibility);\n}\n\n.BaseGallery__bullet--active {\n  opacity: 1;\n}\n\n.BaseGallery__arrow {\n  position: absolute;\n  inset-block-start: 0;\n  opacity: 0;\n}\n\n.BaseGallery:hover .BaseGallery__arrow {\n  opacity: var(--vkui--opacity_disable_accessibility);\n}\n\n.BaseGallery .BaseGallery__arrow:hover {\n  opacity: 1;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={BaseGallery:"BaseGallery--aehDU",BaseGallery__viewport:"BaseGallery__viewport--I1eNk","BaseGallery--align-center":"BaseGallery--align-center--JQQn4",BaseGallery__layer:"BaseGallery__layer--nJ0KW","BaseGallery--draggable":"BaseGallery--draggable--J_egI",BaseGallery__slide:"BaseGallery__slide--N5num","BaseGallery--custom-width":"BaseGallery--custom-width--Cet7r",BaseGallery__bullets:"BaseGallery__bullets--acbMd","BaseGallery__bullets--dark":"BaseGallery__bullets--dark--T_Veu",BaseGallery__bullet:"BaseGallery__bullet--YYi6w","BaseGallery__bullets--light":"BaseGallery__bullets--light--wkxQq","BaseGallery__bullet--active":"BaseGallery__bullet--active--WpJY6",BaseGallery__arrow:"BaseGallery__arrow--Z8JoJ"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___}}]);
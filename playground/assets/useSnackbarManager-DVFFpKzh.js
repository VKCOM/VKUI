import{r as o,c as O,j as S,g as Y,ah as L,o as M,al as B,am as h,q as y}from"./iframe-DP0c1f9Y.js";import{F as N}from"./Flex-C--pQgbh.js";import{u as z}from"./useCSSKeyframesAnimationController-gogItWDj.js";import{a as W,S as j}from"./Snackbar-BtOebo0G.js";import{v as H}from"./v4-EwEgHOG0.js";const R="_host_1q8dk_1",Q="_placementTop_1q8dk_12",$="_placementBottom_1q8dk_13",Z="_ios_1q8dk_17",K="_stateEnter_1q8dk_21",U="_stateExit_1q8dk_25",k={host:R,placementTop:Q,placementBottom:$,ios:Z,stateEnter:K,stateExit:U},X={enter:k.stateEnter,entering:k.stateEnter,entered:k.stateEnter,exit:k.stateExit,exiting:k.stateExit,exited:void 0},G={top:k.placementTop,bottom:k.placementBottom},F=({snackbarItem:u,close:e=!1,onClosed:n,placement:c})=>{const a=o.useRef(null),t=O(),[r,i]=z(e?"exit":"enter",{onExited:()=>n(u.id)});return o.useEffect(()=>{a.current&&r==="entered"&&a.current.style.setProperty("--vkui_internal--SnackbarAnimatedWrapper_height",`${a.current.offsetHeight}px`)},[r]),r==="exited"?null:S.jsx("div",{ref:a,className:Y(k.host,X[r],t==="ios"&&k.ios,G[c]),...i,children:S.jsx(u.component,{...u.additionalProps,id:u.id,snackbarProps:u.snackbarProps,close:u.close,update:u.update})})};try{F.displayName="SnackbarAnimatedWrapper",F.__docgenInfo={description:"",displayName:"SnackbarAnimatedWrapper",props:{snackbarItem:{defaultValue:null,description:"",name:"snackbarItem",required:!0,type:{name:"SnackbarItem"}},close:{defaultValue:{value:"false"},description:"",name:"close",required:!1,type:{name:"boolean"}},onClosed:{defaultValue:null,description:"",name:"onClosed",required:!0,type:{name:"(id: string) => void"}},placement:{defaultValue:null,description:"",name:"placement",required:!0,type:{name:"enum",value:[{value:'"bottom"'},{value:'"top"'}]}}}}}catch{}const J="_host_1rwsu_1",uu="_placementTop_1rwsu_11",eu="_placementBottom_1rwsu_12",tu="_placementTopStart_1rwsu_27",au="_placementTopEnd_1rwsu_28",nu="_placementBottomStart_1rwsu_37",su="_placementBottomEnd_1rwsu_38",D={host:J,placementTop:uu,placementBottom:eu,placementTopStart:tu,placementTopEnd:au,placementBottomStart:nu,placementBottomEnd:su},ru={"top-start":D.placementTopStart,"top-end":D.placementTopEnd,top:D.placementTop,"bottom-start":D.placementBottomStart,"bottom-end":D.placementBottomEnd,bottom:D.placementBottom},q=u=>typeof u>"u"?"":typeof u=="number"?`${u}px`:u,x=({snackbars:u,placement:e,onSnackbarOpen:n,onSnackbarContainerClosed:c,offsetYStart:a,offsetYEnd:t,zIndex:r})=>{const[i,p]=o.useState(new Set),l=o.useCallback(s=>{p(d=>new Set([...d,s]))},[]),m=o.useCallback(s=>{p(d=>(d.delete(s),new Set(d))),c(s)},[c]),E=o.useMemo(()=>({isInsideContainer:!0,onClosed:l,onOpen:n}),[l,n]),b={"--vkui_internal--snackbars_container_offset_y_start":q(a),"--vkui_internal--snackbars_container_offset_y_end":q(t),...r!==void 0&&{zIndex:r}};return S.jsx(W.Provider,{value:E,children:S.jsx(N,{className:Y(D.host,ru[e]),style:b,children:u.map(s=>S.jsx(F,{snackbarItem:s,onClosed:m,close:i.has(s.id),placement:e.startsWith("top")?"top":"bottom"},s.id))})})};try{x.displayName="SnackbarsContainer",x.__docgenInfo={description:"",displayName:"SnackbarsContainer",props:{snackbars:{defaultValue:null,description:"",name:"snackbars",required:!0,type:{name:"SnackbarItem[]"}},placement:{defaultValue:null,description:"",name:"placement",required:!0,type:{name:"enum",value:[{value:'"bottom"'},{value:'"top"'},{value:'"bottom-start"'},{value:'"bottom-end"'},{value:'"top-start"'},{value:'"top-end"'}]}},onSnackbarOpen:{defaultValue:null,description:"",name:"onSnackbarOpen",required:!0,type:{name:"(id: string) => void"}},onSnackbarContainerClosed:{defaultValue:null,description:"",name:"onSnackbarContainerClosed",required:!0,type:{name:"(id: string) => void"}},zIndex:{defaultValue:null,description:"Свойство для установки стиля `z-index` на контейнере снекбаров.",name:"zIndex",required:!1,type:{name:"string | number"}},offsetYStart:{defaultValue:null,description:"Вертикальный отступ контейнера со снекбарами от верха. Полезно, когда на странице используется компонент `FixedLayout`.",name:"offsetYStart",required:!1,type:{name:"OffsetY"}},offsetYEnd:{defaultValue:null,description:"Вертикальный отступ контейнера со снекбарами от низа. Полезно, когда на странице используется компонент `FixedLayout`.",name:"offsetYEnd",required:!1,type:{name:"OffsetY"}}}}}catch{}const g=({store:u,limit:e,offsetYStart:n,offsetYEnd:c,zIndex:a})=>{const t=o.useSyncExternalStore(u.subscribe,u.getState,u.getState),r=o.useCallback(l=>{u.showedSnackbars.add(l)},[u]),[i,p]=o.useMemo(()=>{const l={},m=[],E={};for(const b of t.snackbars){const s=b.snackbarProps.placement,d=t.snackbarsToClose.has(b.id);l[s]||(l[s]=[],E[s]=0,m.push(s));const f=E[s];f>=e&&!d||(l[s].push({...b,snackbarProps:{...b.snackbarProps,open:d?!1:void 0}}),d||(E[s]=f+1))}return[l,m]},[t.snackbars,t.snackbarsToClose,e]);return p.length===0?null:S.jsx(S.Fragment,{children:p.map(l=>S.jsx(x,{snackbars:i[l],placement:l,onSnackbarContainerClosed:u.removeSnackbar,onSnackbarOpen:r,offsetYStart:n,offsetYEnd:c,zIndex:a},l))})};try{g.displayName="SnackbarHolder",g.__docgenInfo={description:"",displayName:"SnackbarHolder",props:{store:{defaultValue:null,description:"",name:"store",required:!0,type:{name:"SnackbarStore"}},limit:{defaultValue:null,description:"",name:"limit",required:!0,type:{name:"number"}},zIndex:{defaultValue:null,description:"Свойство для установки стиля `z-index` на контейнере снекбаров.",name:"zIndex",required:!1,type:{name:"string | number"}},offsetYStart:{defaultValue:null,description:"Вертикальный отступ контейнера со снекбарами от верха. Полезно, когда на странице используется компонент `FixedLayout`.",name:"offsetYStart",required:!1,type:{name:"OffsetY"}},offsetYEnd:{defaultValue:null,description:"Вертикальный отступ контейнера со снекбарами от низа. Полезно, когда на странице используется компонент `FixedLayout`.",name:"offsetYEnd",required:!1,type:{name:"OffsetY"}}}}}catch{}const ou=(u,e)=>({...u,snackbars:[...u.snackbars,e]}),cu=(u,e)=>({snackbars:u.snackbars.filter(n=>n.id!==e),snackbarsToClose:(()=>{const n=new Set(u.snackbarsToClose);return n.delete(e),n})()}),lu=(u,e,n)=>({...u,snackbars:u.snackbars.map(c=>c.id===e?{...c,snackbarProps:{...c.snackbarProps,...n}}:c)}),I=(u,e)=>{const n=new Set(u.snackbarsToClose);return n.add(e),{...u,snackbarsToClose:n}},iu=(u,e)=>({snackbars:u.snackbars.filter(({id:n})=>e.has(n)),snackbarsToClose:new Set(e)}),du=(u,e)=>{const n=e.find(c=>!u.snackbarsToClose.has(c.id));return n?I(u,n.id):u},pu=()=>{let u={snackbars:[],snackbarsToClose:new Set};const e=new Set,n=new Set,c=()=>{e.forEach(t=>t())},a=t=>{u=t(u),c()};return{getState:()=>u,getSnackbarsByPlacement:(t,r)=>{const i=[];let p=0;for(const l of u.snackbars){if(l.snackbarProps.placement!==t)continue;const m=u.snackbarsToClose.has(l.id);if(p>=r&&!m)break;i.push(l),m||p++}return i},subscribe:t=>(e.add(t),()=>e.delete(t)),showedSnackbars:n,addSnackbar:t=>{a(r=>ou(r,t))},removeSnackbar:t=>{a(r=>cu(r,t)),n.delete(t)},updateSnackbar:(t,r)=>{a(i=>lu(i,t,r))},closeSnackbar:t=>{a(r=>I(r,t))},closeAll:t=>{a(r=>iu(r,t))},closeOverflowedSnackbars:t=>{a(r=>du(r,t))}}};function mu(){const u=L(),{window:e}=M(),[n,c]=o.useState(()=>{const a=u.smallTabletPlus.matches,t=u.mediumHeight.matches,r=e?.matchMedia("(pointer: fine)").matches??!1;return a&&(r||t)});return o.useEffect(()=>{if(!e)return;const a=e.matchMedia("(pointer: fine)"),t=()=>{const r=u.smallTabletPlus.matches,i=u.mediumHeight.matches,p=a.matches;c(r&&(p||i))};return t(),B(u.smallTabletPlus,t),B(u.mediumHeight,t),B(a,t),()=>{h(u.smallTabletPlus,t),h(u.mediumHeight,t),h(a,t)}},[u,e]),n}const v=({snackbarProps:u})=>S.jsx(j,{...u});try{v.displayName="SnackbarWrapper",v.__docgenInfo={description:"",displayName:"SnackbarWrapper",props:{close:{defaultValue:null,description:"",name:"close",required:!0,type:{name:"() => void"}},update:{defaultValue:null,description:"",name:"update",required:!0,type:{name:"(props: UpdateProps) => void"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},snackbarProps:{defaultValue:null,description:"",name:"snackbarProps",required:!0,type:{name:"SnackbarData"}}}}}catch{}const fu=u=>u.startsWith("top")?"top":"bottom-start",Eu=u=>"component"in u?u:{component:u},bu=({store:u,limit:e,queueStrategy:n,isDesktop:c})=>{const a=o.useRef(e),t=o.useRef(n),r=o.useRef(c);o.useEffect(()=>{a.current=e},[e]),o.useEffect(()=>{t.current=n},[n]),o.useEffect(()=>{r.current=c},[c]);const i=o.useCallback((s,d)=>{u.updateSnackbar(s,d)},[u]),p=o.useCallback(s=>{u.showedSnackbars.has(s)?u.closeSnackbar(s):u.removeSnackbar(s)},[u]),l=o.useCallback(s=>{const d=s.snackbarProps?.placement||"bottom-start",f=r.current?d:fu(d),A=u.getSnackbarsByPlacement(f,a.current),w=t.current==="shift"&&A.length>=a.current;let P;const V=new Promise(C=>{P=C}),_=s.id;return w&&u.closeOverflowedSnackbars(A),u.addSnackbar({...s,id:_,snackbarProps:{...s.snackbarProps,id:_,placement:f,onClosed:()=>{P(),s.snackbarProps?.onClosed?.()}}}),{id:_,close:()=>p(_),update:C=>i(_,C),onClose:C=>V.then(C)}},[p,u,i]),m=o.useCallback(s=>{const d=Eu(s),f=d.id||H();return l({id:f,component:d.component,snackbarProps:d.baseProps,additionalProps:d.additionalProps,close:()=>p(f),update:A=>i(f,A)})},[p,l,i]),E=o.useCallback(s=>m({id:s.id,component:v,baseProps:s}),[m]),b=o.useCallback(()=>{u.closeAll(u.showedSnackbars)},[u]);return{open:E,openCustom:m,update:i,close:p,closeAll:b}},Su=4,ku=(u={})=>{const{limit:e=Su,queueStrategy:n="shift",offsetYStart:c,offsetYEnd:a,zIndex:t}=u,[r,i]=o.useState(e),[p,l]=o.useState(n),[m,E]=o.useState(c),[b,s]=o.useState(a),[d,f]=o.useState(t);return y(()=>i(e),[e]),y(()=>l(n),[n]),y(()=>E(c),[c]),y(()=>s(a),[a]),y(()=>f(t),[t]),{limit:r,queueStrategy:p,offsetYStart:m,offsetYEnd:b,zIndex:d,setLimit:i,setQueueStrategy:l,setOffsetYStart:E,setOffsetYEnd:s,setZIndex:f}},T=(u={})=>{const e=ku(u),[n]=o.useState(pu),c=mu(),a=bu({store:n,limit:e.limit,queueStrategy:e.queueStrategy,isDesktop:c}),t=o.useMemo(()=>({open:a.open,openCustom:a.openCustom,update:a.update,close:a.close,closeAll:a.closeAll,setLimit:e.setLimit,setQueueStrategy:e.setQueueStrategy,setOffsetYStart:e.setOffsetYStart,setOffsetYEnd:e.setOffsetYEnd,setZIndex:e.setZIndex}),[a.close,a.closeAll,a.open,a.openCustom,a.update,e.setLimit,e.setQueueStrategy,e.setOffsetYEnd,e.setOffsetYStart,e.setZIndex]),r=o.useMemo(()=>S.jsx(g,{store:n,limit:e.limit,offsetYStart:e.offsetYStart,offsetYEnd:e.offsetYEnd,zIndex:e.zIndex}),[n,e.limit,e.offsetYStart,e.offsetYEnd,e.zIndex]);return[t,r]};try{T.displayName="useSnackbarManager",T.__docgenInfo={description:"",displayName:"useSnackbarManager",props:{limit:{defaultValue:null,description:"Максимальное число открытых на одном `placement` снекбаров",name:"limit",required:!1,type:{name:"number"}},queueStrategy:{defaultValue:null,description:'Поведение переполнения очереди снекбаров:\n- `"queue"` - снекбары не откроются, пока для них не появится место.\n- `"shift"` - снекбары форсируют закрытие более старых снекбаров, чтобы освободить место. Значение по умолчанию.',name:"queueStrategy",required:!1,type:{name:"enum",value:[{value:'"shift"'},{value:'"queue"'}]}},offsetYStart:{defaultValue:null,description:"Вертикальный отступ контейнера со снекбарами от верха. Полезно, когда на странице используется компонент `FixedLayout`.",name:"offsetYStart",required:!1,type:{name:"OffsetY"}},offsetYEnd:{defaultValue:null,description:"Вертикальный отступ контейнера со снекбарами от низа. Полезно, когда на странице используется компонент `FixedLayout`.",name:"offsetYEnd",required:!1,type:{name:"OffsetY"}},zIndex:{defaultValue:null,description:"Свойство для установки стиля `z-index` на контейнере снекбаров.",name:"zIndex",required:!1,type:{name:"string | number"}}}}}catch{}export{T as u};

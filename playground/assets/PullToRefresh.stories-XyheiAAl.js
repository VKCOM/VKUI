import{r as e,j as o,R as ru,m as O,B as su,aU as ou,e as au,f as x,aV as iu,X as lu,au as N,b as cu,w as pu}from"./iframe-CDzsgUJ6.js";import{D as fu,C as mu}from"./constants-DdkjnEgz.js";import{a as du,b as Eu,d as hu}from"./mock-KFM_xxXO.js";import{c as gu}from"./createStoryParameters-CcwS40kl.js";import{A as Cu}from"./Avatar-P09vjEf9.js";import{C as Du}from"./Cell-BwqG9bVQ.js";import{G as Fu}from"./Group-BHUvSep0.js";import{L as xu}from"./List-QYjs1kz9.js";import{u as yu}from"./useStateWithPrev-C_uAPEx8.js";import{F as vu}from"./FixedLayout-C-hyj_8N.js";import{V as Ru}from"./VisuallyHidden-hrbUbT1W.js";import"./preload-helper-PPVm8Dsz.js";import"./ImageBase-Dib2k8_n.js";import"./Clickable-Dfoj99Ww.js";import"./useState-QDdZr02K.js";import"./mergeCalls-Bc-HqyI0.js";import"./callMultiple-ChqatQlo.js";import"./type_checkers-CVMjkZjG.js";import"./useFocusVisibleClassName-BNUMQRcR.js";import"./ImageBaseBadge-BJaRDGAe.js";import"./useColorScheme-BJ9q12Ap.js";import"./InputUtils-DkBsdccT.js";import"./useFocusWithin-UKmiu0Co.js";import"./useIsClient-CDj3wCHu.js";import"./useConfigDirection-BVbAx_rU.js";import"./online_mobile_12-D0RCPVny.js";import"./SvgIconRootV2-Atv9uK4X.js";import"./_object_spread_props-DRD4qu7p.js";import"./helpers-QklJbEbU.js";import"./Removable-DwrvQD9J.js";import"./children-__GeZXUq.js";import"./IconButton-DmVT1v_5.js";import"./Tappable-BF8rCM_k.js";import"./cancel_24-D42vZ9MX.js";import"./SimpleCell-BDHKWT_s.js";import"./Footnote-EhoXcm5o.js";import"./Headline-BViG_F4T.js";import"./Subhead-BNbydgjR.js";import"./chevron_compact_right_24-LzGagLF8.js";import"./chevron_16-BoVPvRqg.js";import"./AdaptiveIconRenderer-DYyXL8CC.js";import"./reorder_ios_24-pUC9VdWS.js";import"./check_box_on_24-CVoHOfkf.js";import"./check_circle_on_24-DAurImow.js";import"./constants-CtEIZ0Vq.js";import"./useResizeObserver-HbA0siNX.js";import"./customResizeObserver-CzwDpNji.js";import"./isRefObject-Dh5CqLqK.js";const _u=e.createContext(!1),Bu="_host_18xkx_1",Su="_refreshing_18xkx_7",Tu="_controls_18xkx_12",Pu="_ios_18xkx_17",Vu="_spinner_18xkx_21",Au="_watching_18xkx_46",qu="_spinnerSelf_18xkx_50",wu="_spinnerPath_18xkx_58",bu="_spinnerOn_18xkx_69",ku="_content_18xkx_73",c={host:Bu,refreshing:Su,controls:Tu,ios:Pu,spinner:Vu,watching:Au,spinnerSelf:qu,spinnerPath:wu,spinnerOn:bu,content:ku};function Mu(t,u){const i=t/100;return 2*Math.PI*u*(1-i)}const H=({on:t=!0,size:u=24,strokeWidth:i=2.5,progress:E=0,children:d="Пожалуйста, подождите...",...r})=>{const p=.5*u-.5*i,f=2*Math.PI*p,l=.5*u,a=Mu(t?80:E,p);return o.jsxs(ru,{baseClassName:O(c.spinner,t&&c.spinnerOn),...r,children:[t&&o.jsx(Ru,{children:d}),o.jsx("svg",{role:"presentation",className:c.spinnerSelf,style:{width:u,height:u},viewBox:`0 0 ${u} ${u}`,xmlns:"http://www.w3.org/2000/svg",children:o.jsx("g",{style:{width:u,height:u,transformOrigin:`${l}px ${l}px`},children:o.jsx("circle",{className:c.spinnerPath,fill:"none",strokeDasharray:f,strokeDashoffset:a,strokeWidth:i,strokeLinecap:"round",cx:l,cy:l,r:p})})})]})};try{H.displayName="PullToRefreshSpinner",H.__docgenInfo={description:"",displayName:"PullToRefreshSpinner",props:{size:{defaultValue:{value:"24"},description:"",name:"size",required:!1,type:{name:"number"}},strokeWidth:{defaultValue:{value:"2.5"},description:"",name:"strokeWidth",required:!1,type:{name:"number"}},on:{defaultValue:{value:"true"},description:"",name:"on",required:!1,type:{name:"boolean"}},progress:{defaultValue:{value:"0"},description:"",name:"progress",required:!1,type:{name:"number"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLDivElement>"}}}}}catch{}const Hu=1e3;function M(t){return t&&("preventDefault"in t.originalEvent&&t.originalEvent.cancelable&&t.originalEvent.preventDefault(),"stopPropagation"in t.originalEvent&&t.originalEvent.stopPropagation()),!1}const v=({children:t,isFetching:u,onRefresh:i,className:E,...d})=>{const r=su(),p=ou(),{window:f}=au(),l=e.useRef(void 0);e.useEffect(()=>{l.current=u});const a=e.useMemo(()=>({start:r==="ios"?-10:-45,max:r==="ios"?50:80,maxY:r==="ios"?400:80,refreshing:r==="ios"?36:50,positionMultiplier:r==="ios"?.21:1}),[r]),[G,h]=e.useState(a.start),[g,R]=e.useState(!1),[n,j]=e.useState(!1),[_,I]=e.useState(!1),[[m,B],Y]=yu(!1),L=e.useRef(0),[U,S]=e.useState(0),[X,D]=e.useState(0),T=e.useCallback(()=>{R(!1),I(!1),j(!1),h(a.start),D(0),S(0)},[a]),C=e.useCallback(()=>{m||T()},[m,T]),P=e.useRef(void 0);x(()=>{const s=l.current;s!==void 0&&s&&!u&&C()},[u,C]),x(()=>{const s=l.current;s!==void 0&&!s&&u&&clearTimeout(P.current)},[u]);const V=e.useCallback(()=>{!n&&i&&(clearTimeout(P.current),P.current=setTimeout(C,Hu),j(!0),h(s=>r==="ios"?s:a.refreshing),i())},[n,i,C,r,a.refreshing]);x(()=>{B!==void 0&&B&&!m&&(!n&&_?V():n&&!u?T():(h(n?a.refreshing:a.start),D(0),S(0)))},[a,u,C,B,m,n,_,V]),x(function(){return f&&(g||n)?iu(f):void 0},[f,g,n]);const W=e.useRef(0),$=s=>{if(n){M(s);return}Y(!0),W.current=s.startY},A=e.useRef(!1),K=s=>{const{isY:Z,shiftY:w}=s,{start:b,max:z}=a,uu=p?.getScroll().y;if(g&&m){M(s);const{positionMultiplier:eu,maxY:tu}=a,nu=Math.max(0,w-L.current),F=N(b+nu*eu,b,tu),k=F>-10?Math.abs((F+10)/z)*80:0;h(F),D(N(k,0,80)),I(k>80),S((F+10)*2.3),r==="ios"&&k>85&&!n&&!A.current&&(A.current=!0,V())}else Z&&uu===0&&w>0&&!n&&m&&(M(s),L.current=w,R(!0),h(b),D(0))},J=()=>{R(!1),Y(!1),A.current=!1},Q=`translate3d(0, ${G}px, 0)`;let q="";return r==="ios"&&n&&!m?q="translate3d(0, 100px, 0)":r==="ios"&&(U||n)&&(q=`translate3d(0, ${U}px, 0)`),o.jsx(_u.Provider,{value:!0,children:o.jsxs(lu,{"aria-live":"polite","aria-busy":!!u,...d,onStart:$,onMove:K,onEnd:J,className:O(c.host,r==="ios"&&c.ios,g&&c.watching,n&&c.refreshing,E),children:[o.jsx(vu,{className:c.controls,useParentWidth:!0,children:o.jsx(H,{style:{transform:Q,opacity:g||n||_?1:0},on:n,progress:n?void 0:X})}),o.jsx("div",{className:c.content,style:{transform:q},children:t})]})})};try{v.displayName="PullToRefresh",v.__docgenInfo={description:"",displayName:"PullToRefresh",props:{onRefresh:{defaultValue:null,description:"Будет вызвана для обновления контента (прим.: функция должна быть мемоизированным обработчиком).",name:"onRefresh",required:!0,type:{name:"AnyFunction"}},isFetching:{defaultValue:null,description:"Определяет, выполняется ли обновление. Для скрытия спиннера после получения контента необходимо передать `false`.",name:"isFetching",required:!1,type:{name:"boolean"}},scroll:{defaultValue:null,description:"@ignore",name:"scroll",required:!1,type:{name:"ScrollContextInterface"}},window:{defaultValue:null,description:"@ignore",name:"window",required:!1,type:{name:"Window"}},document:{defaultValue:null,description:"@ignore",name:"document",required:!1,type:{name:"Document"}},usePointerHover:{defaultValue:null,description:`Использовать pointer-events для hover-состояний.
Работает на отключенных элементах (disabled inputs).`,name:"usePointerHover",required:!1,type:{name:"boolean"}},useCapture:{defaultValue:null,description:"Использовать фазу capture для событий.",name:"useCapture",required:!1,type:{name:"boolean"}},slideThreshold:{defaultValue:{value:"5"},description:"Порог расстояния в пикселях для активации свайпа.",name:"slideThreshold",required:!1,type:{name:"number"}},noSlideClick:{defaultValue:null,description:"Блокировать click-события после распознавания свайпа.",name:"noSlideClick",required:!1,type:{name:"boolean"}},stopPropagation:{defaultValue:null,description:"Останавливать всплытие событий.",name:"stopPropagation",required:!1,type:{name:"boolean"}},onEnter:{defaultValue:null,description:"Обработчик входа курсора в область.",name:"onEnter",required:!1,type:{name:"HoverHandler"}},onLeave:{defaultValue:null,description:"Обработчик выхода курсора из области.",name:"onLeave",required:!1,type:{name:"HoverHandler"}},onStart:{defaultValue:null,description:"Общий обработчик начала взаимодействия.",name:"onStart",required:!1,type:{name:"CustomTouchEventHandler"}},onStartX:{defaultValue:null,description:"Обработчик начала горизонтального перемещения.",name:"onStartX",required:!1,type:{name:"CustomTouchEventHandler"}},onStartY:{defaultValue:null,description:"Обработчик начала вертикального перемещения.",name:"onStartY",required:!1,type:{name:"CustomTouchEventHandler"}},onMove:{defaultValue:null,description:"Общий обработчик перемещения.",name:"onMove",required:!1,type:{name:"CustomTouchEventHandler"}},onMoveX:{defaultValue:null,description:"Обработчик горизонтального перемещения.",name:"onMoveX",required:!1,type:{name:"CustomTouchEventHandler"}},onMoveY:{defaultValue:null,description:"Обработчик вертикального перемещения.",name:"onMoveY",required:!1,type:{name:"CustomTouchEventHandler"}},onEnd:{defaultValue:null,description:"Общий обработчик завершения взаимодействия.",name:"onEnd",required:!1,type:{name:"CustomTouchEventHandler"}},onEndX:{defaultValue:null,description:"Обработчик завершения горизонтального свайпа.",name:"onEndX",required:!1,type:{name:"CustomTouchEventHandler"}},onEndY:{defaultValue:null,description:"Обработчик завершения вертикального свайпа.",name:"onEndY",required:!1,type:{name:"CustomTouchEventHandler"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLElement>"}},Component:{defaultValue:null,description:"",name:"Component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}}}}}catch{}const b4={title:"Feedback/PullToRefresh",component:v,parameters:gu("PullToRefresh",mu,fu),decorators:[cu,pu],tags:["Обратная связь"]},ju=du(20),y={render:function(){const[u,i]=e.useState(ju),[E,d]=e.useState(!1),r=e.useCallback(()=>{d(!0),setTimeout(()=>{d(!1),i(p=>[Eu(),...p])},hu(600,2e3))},[]);return o.jsx(v,{onRefresh:r,isFetching:E,children:o.jsx(Fu,{children:o.jsx(xu,{children:u.map(({name:p,photo_100:f},l)=>o.jsx(Du,{before:o.jsx(Cu,{src:f}),children:p},l))})})})}};y.parameters={...y.parameters,docs:{...y.parameters?.docs,source:{originalSource:`{
  render: function Render() {
    const [users, setUsers] = React.useState(initUsers);
    const [fetching, setFetching] = React.useState(false);
    const onRefresh = React.useCallback(() => {
      setFetching(true);
      setTimeout(() => {
        setFetching(false);
        setUsers(prevUsers => [getRandomUser(), ...prevUsers]);
      }, getRandomInt(600, 2000));
    }, []);
    return <PullToRefresh onRefresh={onRefresh} isFetching={fetching}>
        <Group>
          <List>
            {users.map(({
            name,
            photo_100
          }, i) => {
            return <Cell key={i} before={<Avatar src={photo_100} />}>
                  {name}
                </Cell>;
          })}
          </List>
        </Group>
      </PullToRefresh>;
  }
}`,...y.parameters?.docs?.source}}};const k4=["Example"];export{y as Example,k4 as __namedExportsOrder,b4 as default};

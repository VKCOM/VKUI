import{r as m,i as _u,j as o,h as N,aM as Su,k as Bu,ae as G,N as Vu,X as Au,w as Tu,b as wu}from"./iframe-WscSQxk_.js";import{D as Ru,C as Pu}from"./constants-DdkjnEgz.js";import{c as zu}from"./createStoryParameters-CcwS40kl.js";import{F as xu}from"./FormItem-C5jU3y7N.js";import{G as Iu}from"./Group-qAlp-RAW.js";import{u as Mu}from"./useConfigDirection-f8qxYIIC.js";import{u as Nu}from"./useBooleanState-DjNPmzUO.js";import{u as qu,a as Lu}from"./useFocusVisibleClassName-LTUayfN7.js";import{T as ju}from"./TooltipBase-xTNnisSC.js";import{o as ku,f as Yu,s as Xu,i as Hu,u as Ou,c as Wu}from"./floating-ui.react-dom-DLxqAOSM.js";const $u="_host_m3lrr_1",Gu="_focusVisible_m3lrr_15",Ku="_hover_m3lrr_20",Uu="_active_m3lrr_24",Ju="_nativeInput_m3lrr_31",V={host:$u,focusVisible:Gu,hover:Ku,active:Uu,nativeInput:Ju},q=({className:u,getRootRef:e,inputProps:t,withTooltip:r,isActive:s,...c})=>{const{focusVisible:n,onBlur:F,onFocus:T}=qu(),b=Lu({focusVisible:n,mode:V.focusVisible}),[f,L]=m.useState(null),j=m.useMemo(()=>[ku({crossAxis:0,mainAxis:15}),Yu(),Xu({padding:8}),Hu({element:f})],[f]),{x:g,y:w,placement:k,refs:R,strategy:Y,middlewareData:{arrow:P},update:X}=Ou({placement:"top",middleware:j}),{value:_,setTrue:h,setFalse:z}=Nu(!1),x=_u(e,R.setReference),d=r&&(n||_||s),i=t&&t.value;return m.useEffect(function(){d&&i!=="undefined"&&X()},[i,X,d]),o.jsxs(m.Fragment,{children:[o.jsx("span",{...c,ref:x,onMouseEnter:h,onMouseLeave:z,className:N(V.host,b,s&&V.active,_&&V.hover,u),children:o.jsx("input",{...t,type:"range",className:V.nativeInput,"aria-orientation":"horizontal",onBlur:F,onFocus:T})}),d&&o.jsx(ju,{appearance:"neutral",getRootRef:R.setFloating,style:Wu({strategy:Y,x:g,y:w}),arrowProps:{coords:P,placement:k,getRootRef:L},description:i})]})};try{q.displayName="SliderThumb",q.__docgenInfo={description:"",displayName:"SliderThumb",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},inputProps:{defaultValue:null,description:"",name:"inputProps",required:!1,type:{name:"(InputHTMLAttributes<HTMLInputElement> & RefAttributes<HTMLInputElement> & HasDataAttribute)"}},withTooltip:{defaultValue:null,description:"",name:"withTooltip",required:!1,type:{name:"boolean"}},isActive:{defaultValue:null,description:"",name:"isActive",required:!1,type:{name:"boolean"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLSpanElement>"}}}}}catch{}const lu=(u,e,t)=>(u-e)/(t-e)*100,ou=(u,e,t,r,s)=>Su(u,[0,e],[t,r],{step:s}),K=(u,e,t)=>u<e?e:u>t?t:u,iu=(u,e,t,r,s)=>{const[c,n]=u;if(n===null)return[K(e,t,r),null];switch(s){case"start":return e>n?[n,n]:[K(e,t,r),n];case"end":return e<c?[c,c]:[c,K(e,t,r)];case null:default:return u}},Qu=(u,e,t)=>{const[r,s]=u;switch(t){case"start":return[e,s];case"end":return[r,e];case null:default:return u}};function Zu(u){return u[1]!==null}const u4=(u,e,t)=>{if(t==="start")return"start";if(t==="end")return"end";const[r,s]=u,c=.1,n=s!==null?r-c:r,F=s!==null?s+c:0;return Math.abs(n-e)<=Math.abs(F-e)?"start":"end"},cu=u=>{if(u){if(u.dataset.type==="start")return"start";if(u.dataset.type==="end")return"end"}return null},e4={"aria-label":void 0,"aria-valuetext":void 0,"aria-labelledby":void 0},t4=u=>{const e=u["aria-label"],t=u["aria-valuetext"],r=u["aria-labelledby"];return{...u,...e4,ariaLabel:e,ariaValueText:t,ariaLabelledBy:r}},a4="_host_f9owr_1",r4="_disabled_f9owr_10",n4="_track_f9owr_15",s4="_trackFill_f9owr_16",l4="_multiple_f9owr_34",o4="_thumbs_f9owr_40",i4="_thumb_f9owr_40",c4="_rtl_f9owr_52",d4="_thumbStart_f9owr_56",m4="_thumbEnd_f9owr_60",p4="_sizeL_f9owr_64",f4="_sizeM_f9owr_68",E4="_sizeS_f9owr_72",b4="_sizeYCompact_f9owr_80",g4="_sizeYNone_f9owr_93",l={host:a4,disabled:r4,track:n4,trackFill:s4,multiple:l4,thumbs:o4,thumb:i4,rtl:c4,thumbStart:d4,thumbEnd:m4,sizeL:p4,sizeM:f4,sizeS:E4,sizeYCompact:b4,sizeYNone:g4},_4={none:l.sizeYNone,compact:l.sizeYCompact},h4={l:l.sizeL,m:l.sizeM,s:l.sizeS},U=({step:u=1,min:e=0,max:t=100,value:r,multiple:s,defaultValue:c=s?[e,t]:e,disabled:n,className:F,getRootRef:T,getAriaLabel:b,getAriaValueText:f,startThumbTestId:L,endThumbTestId:j,onChange:g,withTooltip:w,size:k="l",style:R,...Y})=>{const{sizeY:P="none"}=Bu(),_=Mu()==="rtl",h=r!==void 0,[z,x]=m.useState(c),d=m.useMemo(()=>{const a=h?r:z;return Array.isArray(a)?[G(a[0],e,t),G(a[1],e,t)]:[G(a,e,t),null]},[h,r,z,e,t]),[i,p]=d,D=s&&p!==null,J=lu(i,e,t),hu=D?lu(p,e,t):0,[Q,Z]=m.useState(null),y=m.useRef({dragging:null,startX:0,containerWidth:0}).current,H=_u(T),O=m.useRef(null),W=m.useRef(null),{ariaLabel:uu,ariaValueText:eu,ariaLabelledBy:tu,...Du}=t4(Y),$=(a,v)=>{n||d[0]===a[0]&&d[1]===a[1]||(s?Zu(a)&&(!h&&x(a),g&&g(a,v)):(!h&&x(a[0]),g&&g(a[0],v)))},yu=a=>{if(!H.current)return;const{left:v,width:S}=H.current.getBoundingClientRect(),B=cu(a.originalEvent.target);let E=a.startX-v;_&&(E=S-E);const I=ou(E,S,e,t,u),M=u4(d,I,B);y.dragging=M,y.containerWidth=S,y.startX=E;const ru=iu(d,I,e,t,M),[nu,su]=ru;O.current&&(B==="start"||nu!==i&&su===p)?(O.current.focus(),a.originalEvent.preventDefault()):W.current&&(B==="end"||su!==p&&nu===i)&&(W.current.focus(),a.originalEvent.preventDefault()),$(ru,a),a.originalEvent.stopPropagation(),Z(y.dragging)},vu=a=>{const{startX:v,containerWidth:S,dragging:B}=y,{shiftX:E=0}=a,I=v+(_?-E:E),M=ou(I,S,e,t,u);$(iu(d,M,e,t,B),a),a.originalEvent.stopPropagation(),a.originalEvent.preventDefault()},Cu=a=>{y.dragging=null,a.originalEvent.stopPropagation(),Z(null)},au=a=>{$(Qu(d,Number(a.target.value),cu(a.target)),a)},Fu={"--vkui_internal--Slider_start_value":String(J),"--vkui_internal--Slider_end_value":String(hu)};return o.jsxs(Vu,{"data-value":D?`${i},${p}`:i,...Du,className:N(l.host,n&&l.disabled,P!=="regular"&&_4[P],h4[k],D&&l.multiple,_&&l.rtl,F),style:Au(R,Fu),getRootRef:T,onStart:n?void 0:yu,onMove:n?void 0:vu,onEnd:n?void 0:Cu,children:[o.jsx("div",{className:l.track}),o.jsx("div",{className:l.trackFill}),o.jsxs("div",{ref:H,className:l.thumbs,children:[o.jsx(q,{"data-type":"start",className:N(l.thumb,l.thumbStart),style:{zIndex:D&&J>=50?2:void 0},withTooltip:w,inputProps:{"data-type":"start","data-testid":L,ref:O,step:u,min:e,value:i,max:D?p:t,disabled:n,"aria-label":b?b(0):uu,"aria-valuetext":f?f(i,0):eu,"aria-labelledby":tu,onChange:au},isActive:Q==="start"}),D&&o.jsx(q,{"data-type":"end",className:N(l.thumb,l.thumbEnd),withTooltip:w,inputProps:{"data-type":"end","data-testid":j,ref:W,step:u,min:i,value:p,max:t,disabled:n,"aria-label":b?b(1):uu,"aria-valuetext":f?f(p,1):eu,"aria-labelledby":tu,onChange:au},isActive:Q==="end"})]})]})};try{U.displayName="Slider",U.__docgenInfo={description:"",displayName:"Slider",props:{multiple:{defaultValue:null,description:`Флаг множественного выбора (должен быть false или не указан).
Флаг множественного выбора (должен быть true).`,name:"multiple",required:!1,type:{name:"boolean"}},value:{defaultValue:null,description:`Текущее значение слайдера.
Текущие значения слайдера в виде массива [начальное, конечное].`,name:"value",required:!1,type:{name:"number | [number, number]"}},defaultValue:{defaultValue:{value:"multipleProp ? [min, max] : min"},description:`Значение слайдера по умолчанию.
Значения слайдера по умолчанию в виде массива [начальное, конечное].`,name:"defaultValue",required:!1,type:{name:"number | [number, number]"}},onChange:{defaultValue:null,description:`Обработчик изменения значения слайдера.
Обработчик изменения значений слайдера.`,name:"onChange",required:!1,type:{name:"((value: number, event: CustomTouchEvent | ChangeEvent<Element>) => void) | ((value: [number, number], event: CustomTouchEvent | ChangeEvent<...>) => void)"}},min:{defaultValue:{value:"0"},description:"Минимальное значение слайдера.",name:"min",required:!1,type:{name:"number"}},max:{defaultValue:{value:"100"},description:"Максимальное значение слайдера.",name:"max",required:!1,type:{name:"number"}},step:{defaultValue:{value:"1"},description:"Шаг изменения значения слайдера.",name:"step",required:!1,type:{name:"number"}},disabled:{defaultValue:null,description:"Блокировка взаимодействия с компонентом.",name:"disabled",required:!1,type:{name:"boolean"}},getAriaLabel:{defaultValue:null,description:"Тоже самое, что и `aria-label`, но на вход можно получать индекс текущего ползунка и в зависимости от этого выдавать разный текст.\n\n> Перебивает `aria-label`.",name:"getAriaLabel",required:!1,type:{name:"((index: number) => string)"}},getAriaValueText:{defaultValue:null,description:"В отличие от `aria-valuetext`, позволяет более гибко форматировать текст в зависимости от значения ползунка.\n\nПолезно при использовании компонента как неконтролируемого.\n\n> Перебивает `aria-valuetext`.",name:"getAriaValueText",required:!1,type:{name:"((value: number, index: number) => string)"}},withTooltip:{defaultValue:null,description:"Включает отображение всплывающей подсказки при взаимодействии с ползунком.",name:"withTooltip",required:!1,type:{name:"boolean"}},size:{defaultValue:{value:"l"},description:"Размер ползунка.",name:"size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"m"'},{value:'"l"'}]}},startThumbTestId:{defaultValue:null,description:"Передает атрибут `data-testid` для первого ползунка.",name:"startThumbTestId",required:!1,type:{name:"string"}},endThumbTestId:{defaultValue:null,description:"Передает атрибут `data-testid` для второго ползунка когда `multiple=true`.",name:"endThumbTestId",required:!1,type:{name:"string"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLDivElement>"}}}}}catch{}function du(u){return u===1?"Pineapple Maximum Count":"Pineapple Minimum Count"}const D4={title:"Forms/Slider",component:U,parameters:zu("Slider",Pu,Ru),args:{getAriaLabel:du},argTypes:{defaultValue:{table:{defaultValue:{summary:"min | [min, max]"}}},multiple:{table:{defaultValue:{summary:"false"}}},getAriaLabel:{table:{defaultValue:{summary:`Для примера используется функция: ${du.toString()}`}}}},tags:["Формы и поля ввода"]},y4=u=>u!=null&&u.multiple?"multiple":"single",C={decorators:[(u,e)=>o.jsx(Iu,{children:o.jsx(xu,{top:"Pineapple Count",children:o.jsx(u,{...e.args},y4(e.args))})}),Tu,wu]},A={...C,args:{withTooltip:!0}};var mu,pu,fu;C.parameters={...C.parameters,docs:{...(mu=C.parameters)==null?void 0:mu.docs,source:{originalSource:`{
  decorators: [(Component: typeof Slider, context: StoryContext<SliderProps | SliderMultipleProps>) => <Group>
        <FormItem top="Pineapple Count">
          <Component key={forceRemountKey(context.args)} {...context.args} />
        </FormItem>
      </Group>, withSinglePanel, withVKUILayout]
}`,...(fu=(pu=C.parameters)==null?void 0:pu.docs)==null?void 0:fu.source}}};var Eu,bu,gu;A.parameters={...A.parameters,docs:{...(Eu=A.parameters)==null?void 0:Eu.docs,source:{originalSource:`{
  ...Playground,
  args: {
    withTooltip: true
  }
}`,...(gu=(bu=A.parameters)==null?void 0:bu.docs)==null?void 0:gu.source}}};const v4=["Playground","Tooltip"],z4=Object.freeze(Object.defineProperty({__proto__:null,Playground:C,Tooltip:A,__namedExportsOrder:v4,default:D4},Symbol.toStringTag,{value:"Module"}));export{C as P,U as S,z4 as a};

import{r as e,j as o,R as au,h as X,c as iu,aR as lu,q as cu,l as y,aS as pu,N as fu,M as mu,am as U,w as du,b as Eu}from"./iframe-Bz8JpgqB.js";import{D as hu,C as gu}from"./constants-DdkjnEgz.js";import{b as Cu,a as Du,d as Fu}from"./mock-BznupqUM.js";import{c as yu}from"./createStoryParameters-CcwS40kl.js";import{A as vu}from"./Avatar-Djz9XYEE.js";import{C as Ru}from"./Cell-49yG8G3y.js";import{G as _u}from"./Group-DTDZzv4b.js";import{L as Bu}from"./List-C-AzMsof.js";import{u as Su}from"./useStateWithPrev-BJAqxh9n.js";import{V as Tu}from"./VisuallyHidden-Civmtkn4.js";import"./preload-helper-Dp1pzeXC.js";import"./ImageBase-ClmHHqwk.js";import"./Clickable-C8sAptP9.js";import"./useFocusVisible-DI7o-w5D.js";import"./useFocusVisibleClassName-DeYZ6Bju.js";import"./mergeCalls-Bc-HqyI0.js";import"./callMultiple-ChqatQlo.js";import"./type_checkers-CVMjkZjG.js";import"./ImageBaseBadge-UmCFkqsi.js";import"./useColorScheme-DVyOIIkN.js";import"./InputUtils-C36z3TAr.js";import"./useFocusWithin-DoazkeVF.js";import"./useIsClient-BRGUFVjE.js";import"./useConfigDirection-1j4RIbQo.js";import"./online_mobile_12-BjrG8SuA.js";import"./SvgIconRootV2-PiPT7FW9.js";import"./_object_spread_props-DRD4qu7p.js";import"./helpers-QklJbEbU.js";import"./Removable-BGzPp3kl.js";import"./children-CZEp9rCJ.js";import"./IconButton-SCSZUFVl.js";import"./Tappable-DGSycWIS.js";import"./useGlobalEventListener-CHrHveT6.js";import"./useEventListener-D6V4uhmf.js";import"./cancel_24-RdK71gIA.js";import"./SimpleCell-BZ1hDoNl.js";import"./react_utils-CSZjvU4X.js";import"./Footnote-CXG5ZQyY.js";import"./Headline-DOUR4p3R.js";import"./Subhead-CQ9JxnC_.js";import"./chevron_compact_right_24-DCACY6v7.js";import"./chevron_16-r7AvM1qe.js";import"./AdaptiveIconRenderer-Dqx16JeB.js";import"./reorder_ios_24-C1cTNx6s.js";import"./check_box_on_24-CqvgWjWx.js";import"./check_circle_on_24-DEFiirW7.js";import"./constants-CtEIZ0Vq.js";const xu=e.createContext(!1),Pu="_host_kle00_1",Vu="_refreshing_kle00_7",Au="_controls_kle00_12",qu="_ios_kle00_17",wu="_spinner_kle00_21",bu="_watching_kle00_46",ku="_spinnerSelf_kle00_50",Mu="_spinnerPath_kle00_58",Hu="_spinnerOn_kle00_69",ju="_content_kle00_73",p={host:Pu,refreshing:Vu,controls:Au,ios:qu,spinner:wu,watching:bu,spinnerSelf:ku,spinnerPath:Mu,spinnerOn:Hu,content:ju};function Iu(t,u){const l=t/100;return 2*Math.PI*u*(1-l)}const H=({on:t=!0,size:u=24,strokeWidth:l=2.5,progress:E=0,children:d="Пожалуйста, подождите...",...r})=>{const i=.5*u-.5*l,f=2*Math.PI*i,c=.5*u,a=Iu(t?80:E,i);return o.jsxs(au,{baseClassName:X(p.spinner,t&&p.spinnerOn),...r,children:[t&&o.jsx(Tu,{children:d}),o.jsx("svg",{role:"presentation",className:p.spinnerSelf,style:{width:u,height:u},viewBox:`0 0 ${u} ${u}`,xmlns:"http://www.w3.org/2000/svg",children:o.jsx("g",{style:{width:u,height:u,transformOrigin:`${c}px ${c}px`},children:o.jsx("circle",{className:p.spinnerPath,fill:"none",strokeDasharray:f,strokeDashoffset:a,strokeWidth:l,strokeLinecap:"round",cx:c,cy:c,r:i})})})]})};try{H.displayName="PullToRefreshSpinner",H.__docgenInfo={description:"",displayName:"PullToRefreshSpinner",props:{size:{defaultValue:{value:"24"},description:"",name:"size",required:!1,type:{name:"number"}},strokeWidth:{defaultValue:{value:"2.5"},description:"",name:"strokeWidth",required:!1,type:{name:"number"}},on:{defaultValue:{value:"true"},description:"",name:"on",required:!1,type:{name:"boolean"}},progress:{defaultValue:{value:"0"},description:"",name:"progress",required:!1,type:{name:"number"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLDivElement>"}}}}}catch{}const Yu=1e3;function M(t){return t&&("preventDefault"in t.originalEvent&&t.originalEvent.cancelable&&t.originalEvent.preventDefault(),"stopPropagation"in t.originalEvent&&t.originalEvent.stopPropagation()),!1}const R=({children:t,isFetching:u,onRefresh:l,className:E,...d})=>{const r=iu(),i=lu(),{window:f}=cu(),c=e.useRef(void 0);e.useEffect(()=>{c.current=u});const a=e.useMemo(()=>({start:r==="ios"?-10:-45,max:r==="ios"?50:80,maxY:r==="ios"?400:80,refreshing:r==="ios"?36:50,positionMultiplier:r==="ios"?.21:1}),[r]),[$,h]=e.useState(a.start),[g,_]=e.useState(!1),[n,j]=e.useState(!1),[B,I]=e.useState(!1),[[m,S],Y]=Su(!1),L=e.useRef(0),[N,T]=e.useState(0),[K,D]=e.useState(0),x=e.useCallback(()=>{_(!1),I(!1),j(!1),h(a.start),D(0),T(0)},[a]),C=e.useCallback(()=>{m||x()},[m,x]),P=e.useRef(void 0);y(()=>{const s=c.current;s!==void 0&&s&&!u&&C()},[u,C]),y(()=>{const s=c.current;s!==void 0&&!s&&u&&clearTimeout(P.current)},[u]);const V=e.useCallback(()=>{!n&&l&&(clearTimeout(P.current),P.current=setTimeout(C,Yu),j(!0),h(s=>r==="ios"?s:a.refreshing),l())},[n,l,C,r,a.refreshing]);y(()=>{S!==void 0&&S&&!m&&(!n&&B?V():n&&!u?x():(h(n?a.refreshing:a.start),D(0),T(0)))},[a,u,C,S,m,n,B,V]),y(function(){return f&&(g||n)?pu(f):void 0},[f,g,n]);const J=e.useRef(0),Q=s=>{if(n){M(s);return}Y(!0),J.current=s.startY},A=e.useRef(!1),Z=s=>{const{isY:eu,shiftY:w}=s,{start:b,max:tu}=a,nu=i==null?void 0:i.getScroll().y;if(g&&m){M(s);const{positionMultiplier:ru,maxY:su}=a,ou=Math.max(0,w-L.current),F=U(b+ou*ru,b,su),k=F>-10?Math.abs((F+10)/tu)*80:0;h(F),D(U(k,0,80)),I(k>80),T((F+10)*2.3),r==="ios"&&k>85&&!n&&!A.current&&(A.current=!0,V())}else eu&&nu===0&&w>0&&!n&&m&&(M(s),L.current=w,_(!0),h(b),D(0))},z=()=>{_(!1),Y(!1),A.current=!1},uu=`translate3d(0, ${$}px, 0)`;let q="";return r==="ios"&&n&&!m?q="translate3d(0, 100px, 0)":r==="ios"&&(N||n)&&(q=`translate3d(0, ${N}px, 0)`),o.jsx(xu.Provider,{value:!0,children:o.jsxs(fu,{"aria-live":"polite","aria-busy":!!u,...d,onStart:Q,onMove:Z,onEnd:z,className:X(p.host,r==="ios"&&p.ios,g&&p.watching,n&&p.refreshing,E),children:[o.jsx(mu,{className:p.controls,useParentWidth:!0,children:o.jsx(H,{style:{transform:uu,opacity:g||n||B?1:0},on:n,progress:n?void 0:K})}),o.jsx("div",{className:p.content,style:{transform:q},children:t})]})})};try{R.displayName="PullToRefresh",R.__docgenInfo={description:"",displayName:"PullToRefresh",props:{onRefresh:{defaultValue:null,description:"Будет вызвана для обновления контента (прим.: функция должна быть мемоизированным обработчиком).",name:"onRefresh",required:!0,type:{name:"AnyFunction"}},isFetching:{defaultValue:null,description:"Определяет, выполняется ли обновление. Для скрытия спиннера после получения контента необходимо передать `false`.",name:"isFetching",required:!1,type:{name:"boolean"}},scroll:{defaultValue:null,description:"@ignore",name:"scroll",required:!1,type:{name:"ScrollContextInterface"}},window:{defaultValue:null,description:"@ignore",name:"window",required:!1,type:{name:"Window"}},document:{defaultValue:null,description:"@ignore",name:"document",required:!1,type:{name:"Document"}},usePointerHover:{defaultValue:null,description:`Использовать pointer-events для hover-состояний.
Работает на отключенных элементах (disabled inputs).`,name:"usePointerHover",required:!1,type:{name:"boolean"}},useCapture:{defaultValue:null,description:"Использовать фазу capture для событий.",name:"useCapture",required:!1,type:{name:"boolean"}},slideThreshold:{defaultValue:{value:"5"},description:"Порог расстояния в пикселях для активации свайпа.",name:"slideThreshold",required:!1,type:{name:"number"}},noSlideClick:{defaultValue:null,description:"Блокировать click-события после распознавания свайпа.",name:"noSlideClick",required:!1,type:{name:"boolean"}},stopPropagation:{defaultValue:null,description:"Останавливать всплытие событий.",name:"stopPropagation",required:!1,type:{name:"boolean"}},onEnter:{defaultValue:null,description:"Обработчик входа курсора в область.",name:"onEnter",required:!1,type:{name:"HoverHandler"}},onLeave:{defaultValue:null,description:"Обработчик выхода курсора из области.",name:"onLeave",required:!1,type:{name:"HoverHandler"}},onStart:{defaultValue:null,description:"Общий обработчик начала взаимодействия.",name:"onStart",required:!1,type:{name:"CustomTouchEventHandler"}},onStartX:{defaultValue:null,description:"Обработчик начала горизонтального перемещения.",name:"onStartX",required:!1,type:{name:"CustomTouchEventHandler"}},onStartY:{defaultValue:null,description:"Обработчик начала вертикального перемещения.",name:"onStartY",required:!1,type:{name:"CustomTouchEventHandler"}},onMove:{defaultValue:null,description:"Общий обработчик перемещения.",name:"onMove",required:!1,type:{name:"CustomTouchEventHandler"}},onMoveX:{defaultValue:null,description:"Обработчик горизонтального перемещения.",name:"onMoveX",required:!1,type:{name:"CustomTouchEventHandler"}},onMoveY:{defaultValue:null,description:"Обработчик вертикального перемещения.",name:"onMoveY",required:!1,type:{name:"CustomTouchEventHandler"}},onEnd:{defaultValue:null,description:"Общий обработчик завершения взаимодействия.",name:"onEnd",required:!1,type:{name:"CustomTouchEventHandler"}},onEndX:{defaultValue:null,description:"Обработчик завершения горизонтального свайпа.",name:"onEndX",required:!1,type:{name:"CustomTouchEventHandler"}},onEndY:{defaultValue:null,description:"Обработчик завершения вертикального свайпа.",name:"onEndY",required:!1,type:{name:"CustomTouchEventHandler"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLElement>"}},Component:{defaultValue:null,description:"",name:"Component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}}}}}catch{}const M4={title:"Feedback/PullToRefresh",component:R,parameters:yu("PullToRefresh",gu,hu),decorators:[du,Eu],tags:["Обратная связь"]},Lu=Cu(20),v={render:function(){const[u,l]=e.useState(Lu),[E,d]=e.useState(!1),r=e.useCallback(()=>{d(!0),setTimeout(()=>{d(!1),l(i=>[Du(),...i])},Fu(600,2e3))},[]);return o.jsx(R,{onRefresh:r,isFetching:E,children:o.jsx(_u,{children:o.jsx(Bu,{children:u.map(({name:i,photo_100:f},c)=>o.jsx(Ru,{before:o.jsx(vu,{src:f}),children:i},c))})})})}};var O,G,W;v.parameters={...v.parameters,docs:{...(O=v.parameters)==null?void 0:O.docs,source:{originalSource:`{
  render: function Render() {
    const [users, setUsers] = React.useState(initUsers);
    const [fetching, setFetching] = React.useState(false);
    const onRefresh = React.useCallback(() => {
      setFetching(true);
      setTimeout(() => {
        setFetching(false);
        setUsers(prevUsers => [getRandomUser(), ...prevUsers]);
      }, getRandomInt(600, 2000));
    }, []);
    return <PullToRefresh onRefresh={onRefresh} isFetching={fetching}>
        <Group>
          <List>
            {users.map(({
            name,
            photo_100
          }, i) => {
            return <Cell key={i} before={<Avatar src={photo_100} />}>
                  {name}
                </Cell>;
          })}
          </List>
        </Group>
      </PullToRefresh>;
  }
}`,...(W=(G=v.parameters)==null?void 0:G.docs)==null?void 0:W.source}}};const H4=["Example"];export{v as Example,H4 as __namedExportsOrder,M4 as default};

import{r,c as O,j as S,g as Y,ag as V,o as L,ak as A,al as B,q as y}from"./iframe-CGSrC79H.js";import{F as M}from"./Flex-CmxIyQQi.js";import{S as z,a as N}from"./Snackbar-CiYNhlp9.js";import{u as j}from"./useCSSKeyframesAnimationController-3EPmQPbL.js";import{v as H}from"./v4-BKrj-4V8.js";const R="_host_1q8dk_1",W="_placementTop_1q8dk_12",Q="_placementBottom_1q8dk_13",$="_ios_1q8dk_17",Z="_stateEnter_1q8dk_21",K="_stateExit_1q8dk_25",k={host:R,placementTop:W,placementBottom:Q,ios:$,stateEnter:Z,stateExit:K},U={enter:k.stateEnter,entering:k.stateEnter,entered:k.stateEnter,exit:k.stateExit,exiting:k.stateExit,exited:void 0},X={top:k.placementTop,bottom:k.placementBottom},h=({snackbarItem:u,close:e=!1,onClosed:s,placement:c})=>{const n=r.useRef(null),t=O(),[o,d]=j(e?"exit":"enter",{onExited:()=>s(u.id)});return r.useEffect(()=>{n.current&&o==="entered"&&n.current.style.setProperty("--vkui_internal--SnackbarAnimatedWrapper_height",`${n.current.offsetHeight}px`)},[o]),o==="exited"?null:S.jsx("div",{ref:n,className:Y(k.host,U[o],t==="ios"&&k.ios,X[c]),...d,children:u.type==="simple"?S.jsx(z,{...u.snackbarProps}):S.jsx(u.component,{...u.additionalProps,id:u.id,snackbarProps:u.snackbarProps,close:u.close,update:u.update})})};try{h.displayName="SnackbarAnimatedWrapper",h.__docgenInfo={description:"",displayName:"SnackbarAnimatedWrapper",props:{snackbarItem:{defaultValue:null,description:"",name:"snackbarItem",required:!0,type:{name:"SnackbarItem"}},close:{defaultValue:{value:"false"},description:"",name:"close",required:!1,type:{name:"boolean"}},onClosed:{defaultValue:null,description:"",name:"onClosed",required:!0,type:{name:"(id: string) => void"}},placement:{defaultValue:null,description:"",name:"placement",required:!0,type:{name:"enum",value:[{value:'"top"'},{value:'"bottom"'}]}}}}}catch{}const G="_host_1rwsu_1",J="_placementTop_1rwsu_11",uu="_placementBottom_1rwsu_12",eu="_placementTopStart_1rwsu_27",tu="_placementTopEnd_1rwsu_28",au="_placementBottomStart_1rwsu_37",nu="_placementBottomEnd_1rwsu_38",C={host:G,placementTop:J,placementBottom:uu,placementTopStart:eu,placementTopEnd:tu,placementBottomStart:au,placementBottomEnd:nu},su={"top-start":C.placementTopStart,"top-end":C.placementTopEnd,top:C.placementTop,"bottom-start":C.placementBottomStart,"bottom-end":C.placementBottomEnd,bottom:C.placementBottom},P=u=>typeof u>"u"?"":typeof u=="number"?`${u}px`:u,F=({snackbars:u,placement:e,onSnackbarOpen:s,onSnackbarContainerClosed:c,offsetYStart:n,offsetYEnd:t,zIndex:o})=>{const[d,p]=r.useState(new Set),i=r.useCallback(a=>{p(l=>new Set([...l,a]))},[]),f=r.useCallback(a=>{p(l=>(l.delete(a),new Set(l))),c(a)},[c]),E=r.useMemo(()=>({isInsideContainer:!0,onClosed:i,onOpen:s}),[i,s]),b={"--vkui_internal--snackbars_container_offset_y_start":P(n),"--vkui_internal--snackbars_container_offset_y_end":P(t),...o!==void 0&&{zIndex:o}};return S.jsx(N.Provider,{value:E,children:S.jsx(M,{className:Y(C.host,su[e]),style:b,children:u.map(a=>S.jsx(h,{snackbarItem:a,onClosed:f,close:d.has(a.id),placement:e.startsWith("top")?"top":"bottom"},a.id))})})};try{F.displayName="SnackbarsContainer",F.__docgenInfo={description:"",displayName:"SnackbarsContainer",props:{snackbars:{defaultValue:null,description:"",name:"snackbars",required:!0,type:{name:"SnackbarItem[]"}},placement:{defaultValue:null,description:"",name:"placement",required:!0,type:{name:"enum",value:[{value:'"top-start"'},{value:'"top"'},{value:'"top-end"'},{value:'"bottom-start"'},{value:'"bottom"'},{value:'"bottom-end"'}]}},onSnackbarOpen:{defaultValue:null,description:"",name:"onSnackbarOpen",required:!0,type:{name:"(id: string) => void"}},onSnackbarContainerClosed:{defaultValue:null,description:"",name:"onSnackbarContainerClosed",required:!0,type:{name:"(id: string) => void"}},zIndex:{defaultValue:null,description:"Свойство для установки стиля `z-index` на контейнере снекбаров.",name:"zIndex",required:!1,type:{name:"string | number"}},offsetYStart:{defaultValue:null,description:"Вертикальный отступ контейнера со снекбарами от верха. Полезно, когда на странице используется компонент `FixedLayout`.",name:"offsetYStart",required:!1,type:{name:"OffsetY"}},offsetYEnd:{defaultValue:null,description:"Вертикальный отступ контейнера со снекбарами от низа. Полезно, когда на странице используется компонент `FixedLayout`.",name:"offsetYEnd",required:!1,type:{name:"OffsetY"}}}}}catch{}const x=({store:u,limit:e,offsetYStart:s,offsetYEnd:c,zIndex:n})=>{const t=r.useSyncExternalStore(u.subscribe,u.getState,u.getState),o=r.useCallback(i=>{u.showedSnackbars.add(i)},[u]),[d,p]=r.useMemo(()=>{const i={},f=[],E={};for(const b of t.snackbars){const a=b.snackbarProps.placement,l=t.snackbarsToClose.has(b.id);i[a]||(i[a]=[],E[a]=0,f.push(a));const m=E[a];m>=e&&!l||(i[a].push({...b,snackbarProps:{...b.snackbarProps,open:l?!1:void 0}}),l||(E[a]=m+1))}return[i,f]},[t.snackbars,t.snackbarsToClose,e]);return p.length===0?null:S.jsx(S.Fragment,{children:p.map(i=>S.jsx(F,{snackbars:d[i],placement:i,onSnackbarContainerClosed:u.removeSnackbar,onSnackbarOpen:o,offsetYStart:s,offsetYEnd:c,zIndex:n},i))})};try{x.displayName="SnackbarHolder",x.__docgenInfo={description:"",displayName:"SnackbarHolder",props:{store:{defaultValue:null,description:"",name:"store",required:!0,type:{name:"SnackbarStore"}},limit:{defaultValue:null,description:"",name:"limit",required:!0,type:{name:"number"}},zIndex:{defaultValue:null,description:"Свойство для установки стиля `z-index` на контейнере снекбаров.",name:"zIndex",required:!1,type:{name:"string | number"}},offsetYStart:{defaultValue:null,description:"Вертикальный отступ контейнера со снекбарами от верха. Полезно, когда на странице используется компонент `FixedLayout`.",name:"offsetYStart",required:!1,type:{name:"OffsetY"}},offsetYEnd:{defaultValue:null,description:"Вертикальный отступ контейнера со снекбарами от низа. Полезно, когда на странице используется компонент `FixedLayout`.",name:"offsetYEnd",required:!1,type:{name:"OffsetY"}}}}}catch{}const ou=(u,e)=>({...u,snackbars:[...u.snackbars,e]}),ru=(u,e)=>({snackbars:u.snackbars.filter(s=>s.id!==e),snackbarsToClose:(()=>{const s=new Set(u.snackbarsToClose);return s.delete(e),s})()}),cu=(u,e,s)=>({...u,snackbars:u.snackbars.map(c=>c.id===e?{...c,snackbarProps:{...c.snackbarProps,...s}}:c)}),q=(u,e)=>{const s=new Set(u.snackbarsToClose);return s.add(e),{...u,snackbarsToClose:s}},lu=(u,e)=>({snackbars:u.snackbars.filter(({id:s})=>e.has(s)),snackbarsToClose:new Set(e)}),iu=(u,e)=>{const s=e.find(c=>!u.snackbarsToClose.has(c.id));return s?q(u,s.id):u},du=()=>{let u={snackbars:[],snackbarsToClose:new Set};const e=new Set,s=new Set,c=()=>{e.forEach(t=>t())},n=t=>{u=t(u),c()};return{getState:()=>u,getSnackbarsByPlacement:(t,o)=>{const d=[];let p=0;for(const i of u.snackbars){if(i.snackbarProps.placement!==t)continue;const f=u.snackbarsToClose.has(i.id);if(p>=o&&!f)break;d.push(i),f||p++}return d},subscribe:t=>(e.add(t),()=>e.delete(t)),showedSnackbars:s,addSnackbar:t=>{n(o=>ou(o,t))},removeSnackbar:t=>{n(o=>ru(o,t)),s.delete(t)},updateSnackbar:(t,o)=>{n(d=>cu(d,t,o))},closeSnackbar:t=>{n(o=>q(o,t))},closeAll:t=>{n(o=>lu(o,t))},closeOverflowedSnackbars:t=>{n(o=>iu(o,t))}}};function pu(){const u=V(),{window:e}=L(),[s,c]=r.useState(()=>{const n=u.smallTabletPlus.matches,t=u.mediumHeight.matches,o=e?.matchMedia("(pointer: fine)").matches??!1;return n&&(o||t)});return r.useEffect(()=>{if(!e)return;const n=e.matchMedia("(pointer: fine)"),t=()=>{const o=u.smallTabletPlus.matches,d=u.mediumHeight.matches,p=n.matches;c(o&&(p||d))};return t(),A(u.smallTabletPlus,t),A(u.mediumHeight,t),A(n,t),()=>{B(u.smallTabletPlus,t),B(u.mediumHeight,t),B(n,t)}},[u,e]),s}const mu=u=>u.startsWith("top")?"top":"bottom-start",fu=({store:u,limit:e,queueStrategy:s,isDesktop:c})=>{const n=r.useRef(e),t=r.useRef(s),o=r.useRef(c);r.useEffect(()=>{n.current=e},[e]),r.useEffect(()=>{t.current=s},[s]),r.useEffect(()=>{o.current=c},[c]);const d=r.useCallback(a=>{const l=a.snackbarProps?.placement||"bottom-start",m=o.current?l:mu(l),g=u.getSnackbarsByPlacement(m,n.current),w=t.current==="shift"&&g.length>=n.current;let v;const I=new Promise(_=>{v=_}),D=a.id||H();return w&&u.closeOverflowedSnackbars(g),u.addSnackbar({...a,id:D,snackbarProps:{...a.snackbarProps,id:D,placement:m,onClosed:()=>{v(),a.snackbarProps?.onClosed?.()}}}),{id:D,close:()=>{u.showedSnackbars.has(D)?u.closeSnackbar(D):u.removeSnackbar(D)},update:_=>u.updateSnackbar(D,_),onClose:_=>I.then(_)}},[u]),p=r.useCallback(a=>d({type:"simple",id:a.id,snackbarProps:a}),[d]),i=r.useCallback(a=>{if("component"in a){const l=d({type:"custom",id:a.id,component:a.component,snackbarProps:a.baseProps,additionalProps:a.additionalProps,close:()=>l.close(),update:m=>l.update(m)});return l}else{const l=d({type:"custom",component:a,close:()=>l.close(),update:m=>l.update(m)});return l}},[d]),f=r.useCallback((a,l)=>{u.updateSnackbar(a,l)},[u]),E=r.useCallback(a=>{u.showedSnackbars.has(a)?u.closeSnackbar(a):u.removeSnackbar(a)},[u]),b=r.useCallback(()=>{u.closeAll(u.showedSnackbars)},[u]);return{open:p,openCustom:i,update:f,close:E,closeAll:b}},Eu=4,bu=(u={})=>{const{limit:e=Eu,queueStrategy:s="shift",offsetYStart:c,offsetYEnd:n,zIndex:t}=u,[o,d]=r.useState(e),[p,i]=r.useState(s),[f,E]=r.useState(c),[b,a]=r.useState(n),[l,m]=r.useState(t);return y(()=>d(e),[e]),y(()=>i(s),[s]),y(()=>E(c),[c]),y(()=>a(n),[n]),y(()=>m(t),[t]),{limit:o,queueStrategy:p,offsetYStart:f,offsetYEnd:b,zIndex:l,setLimit:d,setQueueStrategy:i,setOffsetYStart:E,setOffsetYEnd:a,setZIndex:m}},T=(u={})=>{const e=bu(u),[s]=r.useState(du),c=pu(),n=fu({store:s,limit:e.limit,queueStrategy:e.queueStrategy,isDesktop:c}),t=r.useMemo(()=>({open:n.open,openCustom:n.openCustom,update:n.update,close:n.close,closeAll:n.closeAll,setLimit:e.setLimit,setQueueStrategy:e.setQueueStrategy,setOffsetYStart:e.setOffsetYStart,setOffsetYEnd:e.setOffsetYEnd,setZIndex:e.setZIndex}),[n.close,n.closeAll,n.open,n.openCustom,n.update,e.setLimit,e.setQueueStrategy,e.setOffsetYEnd,e.setOffsetYStart,e.setZIndex]),o=r.useMemo(()=>S.jsx(x,{store:s,limit:e.limit,offsetYStart:e.offsetYStart,offsetYEnd:e.offsetYEnd,zIndex:e.zIndex}),[s,e.limit,e.offsetYStart,e.offsetYEnd,e.zIndex]);return[t,o]};try{T.displayName="useSnackbarManager",T.__docgenInfo={description:"",displayName:"useSnackbarManager",props:{limit:{defaultValue:null,description:"Максимальное число открытых на одном `placement` снекбаров",name:"limit",required:!1,type:{name:"number"}},queueStrategy:{defaultValue:null,description:'Поведение переполнения очереди снекбаров:\n- `"queue"` - снекбары не откроются, пока для них не появится место.\n- `"shift"` - снекбары форсируют закрытие более старых снекбаров, чтобы освободить место. Значение по умолчанию.',name:"queueStrategy",required:!1,type:{name:"enum",value:[{value:'"shift"'},{value:'"queue"'}]}},offsetYStart:{defaultValue:null,description:"Вертикальный отступ контейнера со снекбарами от верха. Полезно, когда на странице используется компонент `FixedLayout`.",name:"offsetYStart",required:!1,type:{name:"OffsetY"}},offsetYEnd:{defaultValue:null,description:"Вертикальный отступ контейнера со снекбарами от низа. Полезно, когда на странице используется компонент `FixedLayout`.",name:"offsetYEnd",required:!1,type:{name:"OffsetY"}},zIndex:{defaultValue:null,description:"Свойство для установки стиля `z-index` на контейнере снекбаров.",name:"zIndex",required:!1,type:{name:"string | number"}}}}}catch{}export{T as u};

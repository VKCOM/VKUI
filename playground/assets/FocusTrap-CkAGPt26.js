import{j as p,f,aQ as A,aR as I,r as y,h as F,ax as h,aS as g,aT as M}from"./iframe-CDzsgUJ6.js";import{u as S,D as q}from"./useMutationObserver-BHxydzuf.js";import{V as x}from"./VisuallyHidden-hrbUbT1W.js";const B=({onFocus:u})=>p.jsx(x,{"aria-hidden":!0,"data-focus-guard":!0,tabIndex:0,onFocus:u});try{B.displayName="FocusGuard",B.__docgenInfo={description:"",displayName:"FocusGuard",props:{onFocus:{defaultValue:null,description:"",name:"onFocus",required:!1,type:{name:"((event: FocusEvent<HTMLSpanElement, Element>) => void)"}}}}}catch{}const G=(u,{autoFocus:e,disabled:t,mount:r,autoFocusDelay:n,focusFirst:a})=>{f(function(){if(!u.current||!e||t||!r)return;const s=setTimeout(()=>{if(!u.current)return;const o=A(u.current);I(u.current,o)||(e==="root"?u.current.focus():a())},n);return()=>clearTimeout(s)},[e,n,t,r,a])};function j(u){return g.some(e=>u.matches(e))}const H=({restoreFocus:u,autoFocusDelay:e,mount:t,ref:r})=>{const n=y.useRef(u);f(()=>{n.current=u},[u]);const[a,c]=y.useState(null),s=F(()=>{const o=typeof n.current=="function"?n.current():n.current;if(!o)return;const l=A(r.current);l&&!r.current?.contains(l)&&j(l)||setTimeout(()=>{const m=h(o)&&o||h(a)&&a||null;m&&(m.focus(),c(null))},e)});f(function(){if(!r.current||!n.current||!t){c(null);return}c(A(r.current))},[r,t]),f(function(){return()=>{s()}},[s]),f(function(){t||s()},[t,s])},N=g.join(),T=u=>{const e=u.querySelectorAll(N),t=Array.from(e).filter(r=>{if(r.hasAttribute("data-focus-guard"))return!1;const{display:n,visibility:a}=getComputedStyle(r),c=n==="none"||a==="hidden",s=r.disabled??!1;return!c&&!s});return t.length===0&&t.push(u),t},U=u=>u&&T(u)[0]||null,k=u=>{if(!u)return null;const e=T(u);return e[e.length-1]||null},w=(u,{mount:e=!0,disabled:t=!1,autoFocus:r=!0,restoreFocus:n=!0,autoFocusDelay:a=0,mutationObserverOptions:c})=>{const s=d=>()=>{const i=d(u.current);i?i.focus({preventScroll:!0}):u.current&&u.current.focus()},o=F(s(U)),l=F(s(k));H({restoreFocus:n,autoFocusDelay:a,mount:e,ref:u}),G(u,{autoFocus:r,disabled:t,mount:e,autoFocusDelay:a,focusFirst:o});const m=F(d=>{if(t||!r||!e)return;const i=M(d)?.document;if(!i)return;const D=i.activeElement,E=T(d);if(E.length===0)return;const V=Math.max(D?E.indexOf(D):-1,0),C=E[V];C&&C.focus({preventScroll:!0})});S(u,()=>u.current&&m(u.current),c);const _=(d,i)=>D=>{if(!e||t||!u.current)return;const E=D.relatedTarget;if(E===null||E&&!u.current.contains(E)){i();return}d()},O=F(_(l,o)),L=F(_(o,l)),v=e&&!t;return{beforeGuard:v&&p.jsx(B,{onFocus:O}),afterGuard:v&&p.jsx(B,{onFocus:L})}},b=({autoFocus:u=!0,restoreFocus:e=!0,disabled:t=!1,mount:r=!0,autoFocusDelay:n=0,rootRef:a,children:c,mutationObserverOptions:s=q})=>{const{beforeGuard:o,afterGuard:l}=w(a,{autoFocus:u,restoreFocus:e,disabled:t,mount:r,autoFocusDelay:n,mutationObserverOptions:s});return p.jsxs(y.Fragment,{children:[o,c,l]})},R=u=>p.jsx(b,{...u});try{b.displayName="FocusTrapInternal",b.__docgenInfo={description:"",displayName:"FocusTrapInternal",props:{rootRef:{defaultValue:null,description:"Ref на корневой элемент.",name:"rootRef",required:!0,type:{name:"RefObject<HTMLElement | null>"}},disabled:{defaultValue:{value:"false"},description:"Форсированное отключение захвата фокуса",name:"disabled",required:!1,type:{name:"boolean"}},autoFocus:{defaultValue:{value:"true"},description:"Управление поведением автофокуса при появлении всплывающего окна.\nПри прокидывании `true` фокус будет установлен на первый элемент.\nПри прокидывании `root` фокус будет установлен в корень.",name:"autoFocus",required:!1,type:{name:'boolean | "root"'}},restoreFocus:{defaultValue:{value:"true"},description:"Управление поведением возврата фокуса при закрытии всплывающего окна.",name:"restoreFocus",required:!1,type:{name:"boolean | (() => boolean | HTMLElement)"}},autoFocusDelay:{defaultValue:{value:"0"},description:"Время в миллисекундах после которого срабатывает автофокус при появлении всплывающего окна.",name:"autoFocusDelay",required:!1,type:{name:"number"}},mutationObserverOptions:{defaultValue:{value:`{
  subtree: true,
  childList: true,
}`},description:"Пользовательские опции для MutationObserver, который отслеживает изменения DOM внутри компонента и пересчитывает ноды для фокуса.",name:"mutationObserverOptions",required:!1,type:{name:"MutationObserverInit"}},mount:{defaultValue:{value:"true"},description:"",name:"mount",required:!1,type:{name:"boolean"}}}}}catch{}try{R.displayName="FocusTrap",R.__docgenInfo={description:"",displayName:"FocusTrap",props:{autoFocus:{defaultValue:{value:"true"},description:"Управление поведением автофокуса при появлении всплывающего окна.\nПри прокидывании `true` фокус будет установлен на первый элемент.\nПри прокидывании `root` фокус будет установлен в корень.",name:"autoFocus",required:!1,type:{name:'boolean | "root"'}},disabled:{defaultValue:{value:"false"},description:"Форсированное отключение захвата фокуса",name:"disabled",required:!1,type:{name:"boolean"}},restoreFocus:{defaultValue:{value:"true"},description:"Управление поведением возврата фокуса при закрытии всплывающего окна.",name:"restoreFocus",required:!1,type:{name:"boolean | (() => boolean | HTMLElement)"}},autoFocusDelay:{defaultValue:{value:"0"},description:"Время в миллисекундах после которого срабатывает автофокус при появлении всплывающего окна.",name:"autoFocusDelay",required:!1,type:{name:"number"}},rootRef:{defaultValue:null,description:"Ref на корневой элемент.",name:"rootRef",required:!0,type:{name:"RefObject<HTMLElement | null>"}}}}}catch{}export{R as F,b as a};

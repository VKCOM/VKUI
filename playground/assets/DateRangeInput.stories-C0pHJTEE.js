import{r as a,a6 as d4,a7 as i4,i as au,h as tu,p as nu,j as u,g as lu,a8 as D4,T as ru}from"./iframe-BKqRoeRO.js";import{D as su,C as ou}from"./constants-DdkjnEgz.js";import{c as du}from"./createCalendarDayRenderField-eb-tXmZ2.js";import{g as iu}from"./getFormFieldIconsPresets-Dnj5Bh2F.js";import{c as Du}from"./createStoryParameters-CcwS40kl.js";import{u as cu}from"./useCustomArgs-DgxJ9Vvm.js";import{u as Eu,d as F,N as B,I as C}from"./DateInput.module-DASYkqbJ.js";import{u as mu}from"./useEnsuredControl-DrUFPpJz.js";import{u as pu}from"./useGlobalEscKeyDown-B6CseJM6.js";import{c as Bu}from"./CalendarHeader-k2GZyK-1.js";import{C as Fu}from"./CalendarRange-Cn0QZ2S1.js";import{a as fu}from"./FocusTrap-BrNSy_VJ.js";import{F as Cu}from"./FormField-Go62Y8Xh.js";import{I as c4}from"./IconButton-CDypKmxT.js";import{P as Au}from"./Popper-B-oQljLT.js";import{V as O}from"./VisuallyHidden-B-uFrHKw.js";import{I as gu}from"./calendar_outline_20-RPYOxH39.js";import{I as hu}from"./clear_16-Bo-gSsNk.js";const E4={weekday:"long",year:"numeric",month:"long",day:"numeric"},m4=Bu(),bu={none:F.densityNone,compact:F.densityCompact},Y=l=>{let t=2,d=1,o=0;switch(l){case 0:case 3:o=31;break;case 1:case 4:o=12;break;case 2:case 5:o=2100,d=1900,t=4;break}return{length:t,min:d,max:o}},yu=l=>{const t=["","","","","",""];return l?.[0]&&(t[0]=String(l[0].getDate()).padStart(2,"0"),t[1]=String(l[0].getMonth()+1).padStart(2,"0"),t[2]=String(l[0].getFullYear()).padStart(4,"0")),l?.[1]&&(t[3]=String(l[1].getDate()).padStart(2,"0"),t[4]=String(l[1].getMonth()+1).padStart(2,"0"),t[5]=String(l[1].getFullYear()).padStart(4,"0")),t},vu={childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]},y=({shouldDisableDate:l,disableFuture:t,disablePast:d,value:o,defaultValue:v,onChange:R,calendarPlacement:V="bottom-start",style:x,className:S,closeOnChange:f=!0,disablePickers:g,getRootRef:B4,name:F4,autoFocus:f4,disabled:U,disableFocusTrap:C4,restoreFocus:A4,calendarLabel:g4="Календарь",prevMonthLabel:h4="Предыдущий месяц",nextMonthLabel:b4="Следующий месяц",changeMonthLabel:y4="Месяц",changeYearLabel:v4="Год",changeStartDayLabel:R4="День начала",changeStartMonthLabel:V4="Месяц начала",changeStartYearLabel:x4="Год начала",changeEndDayLabel:S4="День окончания",changeEndMonthLabel:L4="Месяц окончания",changeEndYearLabel:I4="Год окончания",clearFieldLabel:q4="Очистить поле",showCalendarLabel:j4="Показать календарь","aria-label":H="",prevMonthIcon:w4,nextMonthIcon:M4,onCalendarOpenChanged:P4,renderDayContent:T4,calendarTestsProps:k4,startDateTestsProps:L,endDateTestsProps:I,clearButtonTestId:_4,showCalendarButtonTestId:N4,id:$4,accessible:i=!0,readOnly:r,disableCalendar:K4=!1,before:z,...O4})=>{const q=a.useRef(null),j=a.useRef(null),w=a.useRef(null),M=a.useRef(null),P=a.useRef(null),T=a.useRef(null),G=a.useRef(null),k=r?!0:K4,[e,c]=mu({value:o,defaultValue:v,onChange:R}),Y4=a.useCallback(n=>{let D=!0,h=!0;for(let s=0;s<=2;s+=1)n[s].length<Y(s).length&&(D=!1);for(let s=3;s<=5;s+=1)n[s].length<Y(s).length&&(h=!1);const l4=`${n[0]}.${n[1]}.${n[2]}`,r4=`${n[3]}.${n[4]}.${n[5]}`,b="dd.MM.yyyy";if(d4(l4,b)||(D=!1),d4(r4,b)||(h=!1),!D&&!h)return;const s4=Array.isArray(e),o4=new Date,$=D?i4(l4,b,s4&&e?.[0]||o4):null,K=h?i4(r4,b,s4&&e?.[1]||o4):null;$&&K&&K>$&&c([$,K])},[c,e]),U4=a.useMemo(()=>[q,j,w,M,P,T],[q,j,w,M,P,T]),H4=a.useCallback(()=>c(null),[c]),{rootRef:J,calendarRef:z4,open:Q,openCalendar:W,closeCalendar:G4,toggleCalendar:J4,internalValue:E,handleKeyDown:m,setFocusedElement:p,handleFieldEnter:_,clear:Q4,removeFocusFromField:X}=Eu({maxElement:5,refs:U4,autoFocus:f4,disabled:U||r,elementsConfig:Y,onClear:H4,onInternalValueChange:Y4,getInternalValue:yu,value:e,onCalendarOpenChanged:P4,accessible:i}),{density:Z="none"}=au(),W4=tu(J,B4),X4=a.useCallback(n=>{c(n),f&&n?.[1]&&n[1]!==e?.[1]&&X()},[c,f,e,X]),[Z4,uu]=a.useState(V),{locale:N}=nu(),u4=a.useMemo(()=>{if(!e)return null;const[n,D]=e;return!n||!D?null:[m4(N,E4).format(n),m4(N,E4).format(D)].join(" - ")},[N,e]),e4=a.useId(),a4=a.useId(),eu=a.useCallback(()=>{_(),i&&W()},[_,W,i]),t4=!k&&(i||!i&&!e),n4=e&&!r;return pu(Q&&!k,G4,{capture:!1}),u.jsxs(Cu,{style:x,className:lu(Z!=="regular"&&bu[Z],!!z&&F.hasBefore,(t4||n4)&&F.hasAfter,S),getRootRef:W4,role:"group","aria-labelledby":`${a4} ${e4}`,before:z,after:u.jsxs(u.Fragment,{children:[t4?u.jsx(c4,{hoverMode:"opacity",label:j4,onClick:J4,"data-testid":N4,children:u.jsx(gu,{})}):null,n4?u.jsx(c4,{hoverMode:"opacity",label:q4,onClick:Q4,"data-testid":_4,children:u.jsx(hu,{})}):null]}),disabled:U,...O4,children:[u.jsxs("div",{className:F.wrapper,children:[H&&u.jsx(O,{id:a4,children:H}),u4&&u.jsx(O,{id:e4,children:u4}),u.jsx(O,{id:$4,Component:"input",readOnly:!0,"aria-hidden":!0,name:F4,tabIndex:r?0:-1,value:e?`${e[0]?D4.format(e[0]):""} - ${e[1]?D4.format(e[1]):""}`:"",onFocus:_}),u.jsxs(ru,{className:F.input,onClick:eu,normalize:!1,children:[u.jsx(B,{value:E[0],minValue:1,maxValue:31,onKeyDown:r?void 0:m,length:2,getRootRef:q,index:0,readOnly:r,onElementSelect:p,label:R4,"data-testid":L?.day}),u.jsx(C,{children:"."}),u.jsx(B,{value:E[1],minValue:1,maxValue:12,onKeyDown:m,length:2,getRootRef:j,index:1,onElementSelect:p,readOnly:r,label:V4,"data-testid":L?.month}),u.jsx(C,{children:"."}),u.jsx(B,{value:E[2],minValue:1,maxValue:275750,onKeyDown:m,length:4,getRootRef:w,index:2,onElementSelect:p,readOnly:r,label:x4,"data-testid":L?.year}),u.jsx(C,{children:" — "}),u.jsx(B,{value:E[3],minValue:1,maxValue:31,onKeyDown:m,length:2,getRootRef:M,index:3,onElementSelect:p,readOnly:r,label:S4,"data-testid":I?.day}),u.jsx(C,{children:"."}),u.jsx(B,{value:E[4],minValue:1,maxValue:12,onKeyDown:m,length:2,getRootRef:P,index:4,onElementSelect:p,readOnly:r,label:L4,"data-testid":I?.month}),u.jsx(C,{children:"."}),u.jsx(B,{value:E[5],minValue:1,maxValue:275750,onKeyDown:m,length:4,getRootRef:T,index:5,onElementSelect:p,readOnly:r,label:I4,"data-testid":I?.year})]})]}),Q&&!k&&u.jsx(Au,{targetRef:J,offsetByMainAxis:8,placement:Z4,onPlacementChange:uu,children:u.jsx(fu,{rootRef:G,disabled:C4??!i,restoreFocus:A4??!!i,mutationObserverOptions:vu,children:u.jsx("div",{ref:G,children:u.jsx(Fu,{value:e,role:"dialog",onChange:X4,"aria-label":g4,disablePast:d,disableFuture:t,shouldDisableDate:l,getRootRef:z4,disablePickers:g,prevMonthLabel:h4,nextMonthLabel:b4,changeMonthLabel:y4,changeYearLabel:v4,prevMonthIcon:w4,nextMonthIcon:M4,renderDayContent:T4,...k4})})})})]})};try{y.displayName="DateRangeInput",y.__docgenInfo={description:"",displayName:"DateRangeInput",props:{onChange:{defaultValue:null,description:"Обработчик изменения выбранного промежутка.",name:"onChange",required:!1,type:{name:"((value: DateRangeType | null) => void)"}},calendarTestsProps:{defaultValue:null,description:"Передает атрибуты `data-testid` для интерактивных элементов в календаре.",name:"calendarTestsProps",required:!1,type:{name:"CalendarRangeTestsProps"}},calendarPlacement:{defaultValue:{value:"bottom-start"},description:"Расположение календаря относительно поля ввода.",name:"calendarPlacement",required:!1,type:{name:"enum",value:[{value:'"auto"'},{value:'"bottom"'},{value:'"left"'},{value:'"right"'},{value:'"top"'},{value:'"auto-start"'},{value:'"auto-end"'},{value:'"bottom-start"'},{value:'"bottom-end"'},{value:'"left-start"'},{value:'"left-end"'},{value:'"right-start"'},{value:'"right-end"'},{value:'"top-start"'},{value:'"top-end"'}]}},closeOnChange:{defaultValue:{value:"true"},description:"Автоматически закрывать календарь при изменениях.",name:"closeOnChange",required:!1,type:{name:"boolean"}},onCalendarOpenChanged:{defaultValue:null,description:"Обработчик изменения состояния открытия календаря.",name:"onCalendarOpenChanged",required:!1,type:{name:"((opened: boolean) => void)"}},calendarLabel:{defaultValue:{value:"Календарь"},description:"Label для календаря.",name:"calendarLabel",required:!1,type:{name:"string"}},clearFieldLabel:{defaultValue:{value:"Очистить поле"},description:"Label для кнопки очистки. Делает доступным для ассистивных технологий.",name:"clearFieldLabel",required:!1,type:{name:"string"}},showCalendarLabel:{defaultValue:{value:"Показать календарь"},description:"Label для кнопки открытия календаря. Делает доступным для ассистивных технологий.",name:"showCalendarLabel",required:!1,type:{name:"string"}},changeStartDayLabel:{defaultValue:{value:"День начала"},description:"Label для ввода дня начальной даты. Делает доступным для ассистивных технологий.",name:"changeStartDayLabel",required:!1,type:{name:"string"}},changeStartMonthLabel:{defaultValue:{value:"Месяц начала"},description:"Label для ввода месяца начальной даты. Делает доступным для ассистивных технологий.",name:"changeStartMonthLabel",required:!1,type:{name:"string"}},changeStartYearLabel:{defaultValue:{value:"Год начала"},description:"Label для ввода года начальной даты. Делает доступным для ассистивных технологий.",name:"changeStartYearLabel",required:!1,type:{name:"string"}},changeEndDayLabel:{defaultValue:{value:"День окончания"},description:"Label для ввода дня конечной даты. Делает доступным для ассистивных технологий.",name:"changeEndDayLabel",required:!1,type:{name:"string"}},changeEndMonthLabel:{defaultValue:{value:"Месяц окончания"},description:"Label для ввода месяца конечной даты. Делает доступным для ассистивных технологий.",name:"changeEndMonthLabel",required:!1,type:{name:"string"}},changeEndYearLabel:{defaultValue:{value:"Год окончания"},description:"Label для ввода года конечной даты. Делает доступным для ассистивных технологий.",name:"changeEndYearLabel",required:!1,type:{name:"string"}},disableCalendar:{defaultValue:{value:"false"},description:"Отключение открытия календаря.",name:"disableCalendar",required:!1,type:{name:"boolean"}},disableFocusTrap:{defaultValue:null,description:"Позволяет отключить захват фокуса при появлении календаря.",name:"disableFocusTrap",required:!1,type:{name:"boolean"}},restoreFocus:{defaultValue:{value:"true"},description:"Управление поведением возврата фокуса при закрытии всплывающего окна.",name:"restoreFocus",required:!1,type:{name:"boolean | (() => boolean | HTMLElement)"}},accessible:{defaultValue:{value:"true"},description:`@deprecated Since 8.0.0. Будет удалено в 9.0.0.

Включает режим в котором DateRangeInput доступен
для ассистивных технологий.
В этом режиме:
- календарь больше не открывает при фокусе на DateRangeInput;
- иконка календаря видна всегда, чтобы пользователи
ассистивных технологий могли открыть календарь по клику на иконку;
- календарь при открытии получает фокус, клавиатурный
фокус зациклен и не выходит за пределы календаря пока календарь не закрыт.`,name:"accessible",required:!1,type:{name:"boolean"}},defaultValue:{defaultValue:null,description:"Начальный промежуток при монтировании.",name:"defaultValue",required:!1,type:{name:"DateRangeType | null"}},value:{defaultValue:null,description:"Текущий выбранный промежуток.",name:"value",required:!1,type:{name:"DateRangeType | null"}},prevMonthLabel:{defaultValue:{value:"Предыдущий месяц"},description:"`aria-label` для кнопки предыдущего месяца.",name:"prevMonthLabel",required:!1,type:{name:"string"}},nextMonthLabel:{defaultValue:{value:"Следующий месяц"},description:"`aria-label` для кнопки следующего месяца.",name:"nextMonthLabel",required:!1,type:{name:"string"}},changeMonthLabel:{defaultValue:{value:"Месяц"},description:"`aria-label` для селектора месяца.",name:"changeMonthLabel",required:!1,type:{name:"string"}},changeYearLabel:{defaultValue:{value:"Год"},description:"`aria-label` для селектора года.",name:"changeYearLabel",required:!1,type:{name:"string"}},prevMonthIcon:{defaultValue:null,description:"Кастомная иконка для кнопки предыдущего месяца.",name:"prevMonthIcon",required:!1,type:{name:"ReactNode"}},nextMonthIcon:{defaultValue:null,description:"Кастомная иконка для кнопки следующего месяца.",name:"nextMonthIcon",required:!1,type:{name:"ReactNode"}},renderDayContent:{defaultValue:null,description:"Кастомизация отображения содержимого дня.",name:"renderDayContent",required:!1,type:{name:"((day: Date) => ReactNode)"}},disablePast:{defaultValue:null,description:"Запрещает выбор даты в прошлом.\nПрименяется, если не заданы `shouldDisableDate` и `disableFuture`.",name:"disablePast",required:!1,type:{name:"boolean"}},disableFuture:{defaultValue:null,description:"Запрещает выбор даты в будущем.\nПрименяется, если не задано `shouldDisableDate`.",name:"disableFuture",required:!1,type:{name:"boolean"}},shouldDisableDate:{defaultValue:null,description:"Функция для проверки запрета выбора даты.",name:"shouldDisableDate",required:!1,type:{name:"((value: Date) => boolean)"}},weekStartsOn:{defaultValue:null,description:"День недели, с которого начинается неделя.",name:"weekStartsOn",required:!1,type:{name:"enum",value:[{value:"0"},{value:"1"},{value:"2"},{value:"3"},{value:"4"},{value:"5"},{value:"6"}]}},disablePickers:{defaultValue:null,description:"Отключает селекторы выбора месяца/года.",name:"disablePickers",required:!1,type:{name:"boolean"}},changeDayLabel:{defaultValue:null,description:`\`aria-label\` для изменения дня.
@deprecated Since 7.4.0. Будет удалeно в **VKUI v9**.

Использовалось для задания aria-label для контейнера дней в календаре.
Теперь этот контейнер является таблицей (с помощью role="grid") и
в aria-label рендерится текущий открытый в календаре месяц и год.`,name:"changeDayLabel",required:!1,type:{name:"string"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLDivElement>"}},mode:{defaultValue:null,description:"Режим отображения.\n\n- `default` — показывает фон, обводку и, при наличии, текст-подсказку.\n- `plain` — показывает только текст-подсказку.",name:"mode",required:!1,type:{name:"enum",value:[{value:'"plain"'},{value:'"default"'}]}},status:{defaultValue:null,description:"Статус отображения поля в форме.",name:"status",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"error"'},{value:'"valid"'}]}},before:{defaultValue:null,description:"Добавляет иконку слева.\n\nРекомендации:\n\n- Используйте следующие размеры иконок `12` | `16` | `20` | `24` | `28`.\n- Используйте [IconButton](https://vkui.io/components/icon-button), если вам нужна иконка, реагирующая на нажатие.",name:"before",required:!1,type:{name:"ReactNode"}},after:{defaultValue:null,description:"Добавляет иконку справа.\n\nРекомендации:\n\n- Используйте следующие размеры иконок `12` | `16` | `20` | `24` | `28`.\n- Используйте [IconButton](https://vkui.io/components/icon-button), если вам нужна иконка, реагируюущая на нажатие.",name:"after",required:!1,type:{name:"ReactNode"}},beforeAlign:{defaultValue:null,description:"Вертикальное выравнивание иконки слева.",name:"beforeAlign",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"start"'},{value:'"end"'}]}},afterAlign:{defaultValue:null,description:"Вертикальное выравнивание иконки справа.",name:"afterAlign",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"start"'},{value:'"end"'}]}},startDateTestsProps:{defaultValue:null,description:"Передает атрибуты `data-testid` для полей ввода начальной даты.",name:"startDateTestsProps",required:!1,type:{name:"DateTestsProps"}},endDateTestsProps:{defaultValue:null,description:"Передает атрибуты `data-testid` для полей ввода конечной даты.",name:"endDateTestsProps",required:!1,type:{name:"DateTestsProps"}},showCalendarButtonTestId:{defaultValue:null,description:"Передает атрибут `data-testid` для кнопки показа календаря.",name:"showCalendarButtonTestId",required:!1,type:{name:"string"}},clearButtonTestId:{defaultValue:null,description:"Передает атрибут `data-testid` для кнопки очистки даты.",name:"clearButtonTestId",required:!1,type:{name:"string"}}}}}catch{}const p4=iu(),Ru={title:"Dates/DateRangeInput",component:y,parameters:Du("DateRangeInput",ou,su),argTypes:{readOnly:{control:{type:"boolean"}},value:{description:"Используйте startDate и endDate для задания периода",control:!1},startDate:{description:"Дата начала периода",table:{type:{summary:"string"}},control:{type:"date"}},endDate:{description:"Дата окончания периода",table:{type:{summary:"string"}},control:{type:"date"}},before:p4,after:p4,renderDayContent:du()},tags:["Работа с датами"]},A={render:function({startDate:t,endDate:d,...o}){const[,v]=cu(),R=S=>{const[f,g]=S||[null,null];v({startDate:f?new Date(f):null,endDate:g?new Date(g):null})},V=t?new Date(t):null,x=d?new Date(d):null;return u.jsx(y,{...o,value:[V,x],onChange:R})}};A.parameters={...A.parameters,docs:{...A.parameters?.docs,source:{originalSource:`{
  render: function Render({
    startDate,
    endDate,
    ...args
  }) {
    const [, updateArgs] = useCustomArgs();
    const handleDateRangeUpdate: DateRangeInputProps['onChange'] = updatedValue => {
      const [changedStartDate, changedEndDate] = updatedValue || [null, null];
      updateArgs({
        startDate: changedStartDate ? new Date(changedStartDate) : null,
        endDate: changedEndDate ? new Date(changedEndDate) : null
      });
    };
    const parsedStartDate = startDate ? new Date(startDate) : null;
    const parsedEndDate = endDate ? new Date(endDate) : null;
    return <DateRangeInput {...args} value={[parsedStartDate, parsedEndDate]} onChange={handleDateRangeUpdate} />;
  }
}`,...A.parameters?.docs?.source}}};const Vu=["Playground"],Hu=Object.freeze(Object.defineProperty({__proto__:null,Playground:A,__namedExportsOrder:Vu,default:Ru},Symbol.toStringTag,{value:"Module"}));export{y as D,A as P,Hu as a};

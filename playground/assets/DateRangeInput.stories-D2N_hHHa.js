import{r as n,l as eu,k as au,c as tu,j as u,i as nu,T as lu}from"./iframe-DDos8QSD.js";import{D as ru,C as ou}from"./constants-DdkjnEgz.js";import{c as du}from"./createCalendarDayRenderField-C7Hm60qg.js";import{g as su}from"./getFormFieldIconsPresets-Bjn4kl30.js";import{c as iu}from"./createStoryParameters-CcwS40kl.js";import{u as cu}from"./useCustomArgs-BoI2k3Ve.js";import{u as Eu,d as t4,N as C,I as A}from"./DateInput.module-BTKZdnfr.js";import{u as Du}from"./useEnsuredControl-DPf8E04f.js";import{i as n4,p as l4,f as r4}from"./date-DAg-m4Qt.js";import{C as mu}from"./CalendarRange-DcDOkLv1.js";import{F as Bu}from"./FocusTrap-kPWSjsD0.js";import{F as Fu}from"./FormField-nH1PGum8.js";import{I as o4}from"./IconButton-C3mRDxD7.js";import{P as pu}from"./Popper-BfobY8S-.js";import{V as K}from"./VisuallyHidden-Bn0ixRRD.js";import{I as fu}from"./calendar_outline_20-DzwCIN6F.js";import{I as Cu}from"./clear_16-IEFZOITA.js";import{i as gu}from"./CalendarHeader-1U13NKYV.js";const Au="_sizeYCompact_3ofbg_12",bu="_sizeYNone_3ofbg_17",d4={sizeYCompact:Au,sizeYNone:bu},yu={none:d4.sizeYNone,compact:d4.sizeYCompact},$=t=>{let l=2,c=1,i=0;switch(t){case 0:case 3:i=31;break;case 1:case 4:i=12;break;case 2:case 5:i=2100,c=1900,l=4;break}return{length:l,min:c,max:i}},hu=t=>{const l=["","","","","",""];return t!=null&&t[0]&&(l[0]=String(t[0].getDate()).padStart(2,"0"),l[1]=String(t[0].getMonth()+1).padStart(2,"0"),l[2]=String(t[0].getFullYear()).padStart(4,"0")),t!=null&&t[1]&&(l[3]=String(t[1].getDate()).padStart(2,"0"),l[4]=String(t[1].getMonth()+1).padStart(2,"0"),l[5]=String(t[1].getFullYear()).padStart(4,"0")),l},vu={childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]},R=({shouldDisableDate:t,disableFuture:l,disablePast:c,value:i,defaultValue:V,onChange:m,calendarPlacement:x="bottom-start",style:I,className:S,closeOnChange:g=!0,disablePickers:y,getRootRef:D4,name:m4,autoFocus:B4,disabled:O,disableFocusTrap:F4,restoreFocus:p4,calendarLabel:f4="Календарь",prevMonthLabel:C4="Предыдущий месяц",nextMonthLabel:g4="Следующий месяц",changeMonthLabel:A4="Месяц",changeYearLabel:b4="Год",changeStartDayLabel:y4="День начала",changeStartMonthLabel:h4="Месяц начала",changeStartYearLabel:v4="Год начала",changeEndDayLabel:R4="День окончания",changeEndMonthLabel:V4="Месяц окончания",changeEndYearLabel:x4="Год окончания",clearFieldLabel:I4="Очистить поле",showCalendarLabel:S4="Показать календарь","aria-label":U="",prevMonthIcon:L4,nextMonthIcon:q4,onCalendarOpenChanged:M4,renderDayContent:j4,calendarTestsProps:w4,startDateTestsProps:o,endDateTestsProps:d,clearButtonTestId:_4,showCalendarButtonTestId:k4,id:N4,accessible:E,readOnly:r,disableCalendar:Y4=!1,...z4})=>{const L=n.useRef(null),q=n.useRef(null),M=n.useRef(null),j=n.useRef(null),w=n.useRef(null),_=n.useRef(null),P=r?!0:Y4,K4=n.useCallback(a=>m==null?void 0:m(a||void 0),[m]),[e,B]=Du({value:i,defaultValue:V,onChange:K4}),$4=n.useCallback(a=>{let D=!0,h=!0;for(let s=0;s<=2;s+=1)a[s].length<$(s).length&&(D=!1);for(let s=3;s<=5;s+=1)a[s].length<$(s).length&&(h=!1);const Z=`${a[0]}.${a[1]}.${a[2]}`,u4=`${a[3]}.${a[4]}.${a[5]}`,v="dd.MM.yyyy";if(n4(Z,v)||(D=!1),n4(u4,v)||(h=!1),!D&&!h)return;const e4=Array.isArray(e),a4=new Date,Y=D?l4(Z,v,e4&&(e==null?void 0:e[0])||a4):null,z=h?l4(u4,v,e4&&(e==null?void 0:e[1])||a4):null;Y&&z&&gu(z,Y)&&B([Y,z])},[B,e]),O4=n.useMemo(()=>[L,q,M,j,w,_],[L,q,M,j,w,_]),U4=n.useCallback(()=>B(void 0),[B]),{rootRef:H,calendarRef:P4,open:H4,openCalendar:T,closeCalendar:T4,toggleCalendar:G4,internalValue:F,handleKeyDown:p,setFocusedElement:f,handleFieldEnter:k,clear:J4,removeFocusFromField:G}=Eu({maxElement:5,refs:O4,autoFocus:B4,disabled:O||r,elementsConfig:$,onClear:U4,onInternalValueChange:$4,getInternalValue:hu,value:e,onCalendarOpenChanged:M4,accessible:E}),{sizeY:J="none"}=eu(),Q4=au(H,D4),W4=n.useCallback(a=>{B(a),g&&(a!=null&&a[1])&&a[1]!==(e==null?void 0:e[1])&&G()},[B,g,e,G]),[X4,Z4]=n.useState(x),{locale:N}=tu(),Q=n.useMemo(()=>{if(!e)return null;const[a,D]=e;return!a||!D?null:[new Intl.DateTimeFormat(N,{weekday:"long",year:"numeric",month:"long",day:"numeric"}).format(a),new Intl.DateTimeFormat(N,{weekday:"long",year:"numeric",month:"long",day:"numeric"}).format(D)].join(" - ")},[N,e]),W=n.useId(),X=n.useId(),uu=n.useCallback(()=>{k(),E&&T()},[k,T,E]);return u.jsxs(Fu,{style:I,className:nu(J!=="regular"&&yu[J],S),getRootRef:Q4,role:"group","aria-labelledby":`${X} ${W}`,after:u.jsxs(u.Fragment,{children:[!P&&(E||!E&&!e)?u.jsx(o4,{hoverMode:"opacity",label:S4,onClick:G4,"data-testid":k4,children:u.jsx(fu,{})}):null,e&&!r?u.jsx(o4,{hoverMode:"opacity",label:I4,onClick:J4,"data-testid":_4,children:u.jsx(Cu,{})}):null]}),disabled:O,...z4,children:[u.jsxs("div",{className:t4.wrapper,children:[U&&u.jsx(K,{id:X,children:U}),Q&&u.jsx(K,{id:W,children:Q}),u.jsx(K,{id:N4,Component:"input",readOnly:!0,"aria-hidden":!0,name:m4,tabIndex:r?0:-1,value:e?`${e[0]?r4(e[0],"dd.MM.yyyy"):""} - ${e[1]?r4(e[1],"dd.MM.yyyy"):""}`:"",onFocus:k}),u.jsxs(lu,{className:t4.input,onClick:uu,children:[u.jsx(C,{value:F[0],minValue:1,maxValue:31,onKeyDown:r?void 0:p,length:2,getRootRef:L,index:0,readOnly:r,onElementSelect:f,label:y4,"data-testid":o==null?void 0:o.day}),u.jsx(A,{children:"."}),u.jsx(C,{value:F[1],minValue:1,maxValue:12,onKeyDown:p,length:2,getRootRef:q,index:1,onElementSelect:f,readOnly:r,label:h4,"data-testid":o==null?void 0:o.month}),u.jsx(A,{children:"."}),u.jsx(C,{value:F[2],minValue:1,maxValue:275750,onKeyDown:p,length:4,getRootRef:M,index:2,onElementSelect:f,readOnly:r,label:v4,"data-testid":o==null?void 0:o.year}),u.jsx(A,{children:" — "}),u.jsx(C,{value:F[3],minValue:1,maxValue:31,onKeyDown:p,length:2,getRootRef:j,index:3,onElementSelect:f,readOnly:r,label:R4,"data-testid":d==null?void 0:d.day}),u.jsx(A,{children:"."}),u.jsx(C,{value:F[4],minValue:1,maxValue:12,onKeyDown:p,length:2,getRootRef:w,index:4,onElementSelect:f,readOnly:r,label:V4,"data-testid":d==null?void 0:d.month}),u.jsx(A,{children:"."}),u.jsx(C,{value:F[5],minValue:1,maxValue:275750,onKeyDown:p,length:4,getRootRef:_,index:5,onElementSelect:f,readOnly:r,label:x4,"data-testid":d==null?void 0:d.year})]})]}),H4&&!P&&u.jsx(pu,{targetRef:H,offsetByMainAxis:8,placement:X4,onPlacementChange:Z4,children:u.jsx(Bu,{onClose:T4,disabled:F4??!E,restoreFocus:p4??!!E,captureEscapeKeyboardEvent:!1,mutationObserverOptions:vu,children:u.jsx(mu,{value:e,role:"dialog",onChange:W4,"aria-label":f4,disablePast:c,disableFuture:l,shouldDisableDate:t,getRootRef:P4,disablePickers:y,prevMonthLabel:C4,nextMonthLabel:g4,changeMonthLabel:A4,changeYearLabel:b4,prevMonthIcon:L4,nextMonthIcon:q4,renderDayContent:j4,...w4})})})]})};try{R.displayName="DateRangeInput",R.__docgenInfo={description:"",displayName:"DateRangeInput",props:{calendarTestsProps:{defaultValue:null,description:"Передает атрибуты `data-testid` для интерактивных элементов в календаре.",name:"calendarTestsProps",required:!1,type:{name:"CalendarRangeTestsProps"}},calendarPlacement:{defaultValue:null,description:"Расположение календаря относительно поля ввода.",name:"calendarPlacement",required:!1,type:{name:"enum",value:[{value:'"auto"'},{value:'"left"'},{value:'"right"'},{value:'"auto-start"'},{value:'"auto-end"'},{value:'"top"'},{value:'"bottom"'},{value:'"left-start"'},{value:'"left-end"'},{value:'"right-start"'},{value:'"right-end"'},{value:'"top-start"'},{value:'"top-end"'},{value:'"bottom-start"'},{value:'"bottom-end"'}]}},closeOnChange:{defaultValue:{value:"true"},description:"Автоматически закрывать календарь при изменениях.",name:"closeOnChange",required:!1,type:{name:"boolean"}},onCalendarOpenChanged:{defaultValue:null,description:"Обработчик изменения состояния открытия календаря.",name:"onCalendarOpenChanged",required:!1,type:{name:"((opened: boolean) => void)"}},calendarLabel:{defaultValue:{value:"Календарь"},description:"Label для календаря.",name:"calendarLabel",required:!1,type:{name:"string"}},clearFieldLabel:{defaultValue:{value:"Очистить поле"},description:"Label для кнопки очистки. Делает доступным для ассистивных технологий.",name:"clearFieldLabel",required:!1,type:{name:"string"}},showCalendarLabel:{defaultValue:{value:"Показать календарь"},description:"Label для кнопки открытия календаря. Делает доступным для ассистивных технологий.",name:"showCalendarLabel",required:!1,type:{name:"string"}},changeStartDayLabel:{defaultValue:{value:"День начала"},description:"Label для ввода дня начальной даты. Делает доступным для ассистивных технологий.",name:"changeStartDayLabel",required:!1,type:{name:"string"}},changeStartMonthLabel:{defaultValue:{value:"Месяц начала"},description:"Label для ввода месяца начальной даты. Делает доступным для ассистивных технологий.",name:"changeStartMonthLabel",required:!1,type:{name:"string"}},changeStartYearLabel:{defaultValue:{value:"Год начала"},description:"Label для ввода года начальной даты. Делает доступным для ассистивных технологий.",name:"changeStartYearLabel",required:!1,type:{name:"string"}},changeEndDayLabel:{defaultValue:{value:"День окончания"},description:"Label для ввода дня конечной даты. Делает доступным для ассистивных технологий.",name:"changeEndDayLabel",required:!1,type:{name:"string"}},changeEndMonthLabel:{defaultValue:{value:"Месяц окончания"},description:"Label для ввода месяца конечной даты. Делает доступным для ассистивных технологий.",name:"changeEndMonthLabel",required:!1,type:{name:"string"}},changeEndYearLabel:{defaultValue:{value:"Год окончания"},description:"Label для ввода года конечной даты. Делает доступным для ассистивных технологий.",name:"changeEndYearLabel",required:!1,type:{name:"string"}},disableCalendar:{defaultValue:null,description:"Отключение открытия календаря.",name:"disableCalendar",required:!1,type:{name:"boolean"}},disableFocusTrap:{defaultValue:null,description:"Позволяет отключить захват фокуса при появлении календаря.",name:"disableFocusTrap",required:!1,type:{name:"boolean"}},accessible:{defaultValue:null,description:`Включает режим в котором DateRangeInput доступен
для ассистивных технологий.
В этом режиме:
- календарь больше не открывает при фокусе на DateRangeInput;
- иконка календаря видна всегда, чтобы пользователи
ассистивных технологий могли открыть календарь по клику на иконку;
- календарь при открытии получает фокус, клавиатурный
фокус зациклен и не выходит за пределы календаря пока календарь не закрыт.`,name:"accessible",required:!1,type:{name:"boolean"}},defaultValue:{defaultValue:null,description:"Начальный промежуток при монтировании.",name:"defaultValue",required:!1,type:{name:"DateRangeType | null"}},onChange:{defaultValue:null,description:"Обработчик изменения выбранного промежутка.",name:"onChange",required:!1,type:{name:"((value: DateRangeType) => void)"}},value:{defaultValue:null,description:"Текущий выбранный промежуток.",name:"value",required:!1,type:{name:"DateRangeType | null"}},prevMonthLabel:{defaultValue:{value:"Предыдущий месяц"},description:"`aria-label` для кнопки предыдущего месяца.",name:"prevMonthLabel",required:!1,type:{name:"string"}},nextMonthLabel:{defaultValue:{value:"Следующий месяц"},description:"`aria-label` для кнопки следующего месяца.",name:"nextMonthLabel",required:!1,type:{name:"string"}},changeMonthLabel:{defaultValue:{value:"Месяц"},description:"`aria-label` для селектора месяца.",name:"changeMonthLabel",required:!1,type:{name:"string"}},changeYearLabel:{defaultValue:{value:"Год"},description:"`aria-label` для селектора года.",name:"changeYearLabel",required:!1,type:{name:"string"}},prevMonthIcon:{defaultValue:null,description:"Кастомная иконка для кнопки предыдущего месяца.",name:"prevMonthIcon",required:!1,type:{name:"ReactNode"}},nextMonthIcon:{defaultValue:null,description:"Кастомная иконка для кнопки следующего месяца.",name:"nextMonthIcon",required:!1,type:{name:"ReactNode"}},renderDayContent:{defaultValue:null,description:"Кастомизация отображения содержимого дня.",name:"renderDayContent",required:!1,type:{name:"((day: Date) => ReactNode)"}},disablePast:{defaultValue:null,description:"Запрещает выбор даты в прошлом.\nПрименяется, если не заданы `shouldDisableDate` и `disableFuture`.",name:"disablePast",required:!1,type:{name:"boolean"}},disableFuture:{defaultValue:null,description:"Запрещает выбор даты в будущем.\nПрименяется, если не задано `shouldDisableDate`.",name:"disableFuture",required:!1,type:{name:"boolean"}},shouldDisableDate:{defaultValue:null,description:"Функция для проверки запрета выбора даты.",name:"shouldDisableDate",required:!1,type:{name:"((value: Date) => boolean)"}},weekStartsOn:{defaultValue:null,description:"День недели, с которого начинается неделя.",name:"weekStartsOn",required:!1,type:{name:"enum",value:[{value:"0"},{value:"1"},{value:"2"},{value:"3"},{value:"4"},{value:"5"},{value:"6"}]}},disablePickers:{defaultValue:null,description:"Отключает селекторы выбора месяца/года.",name:"disablePickers",required:!1,type:{name:"boolean"}},changeDayLabel:{defaultValue:null,description:`\`aria-label\` для изменения дня.
@deprecated Since 7.4.0.

Будет удалeно в **VKUI v8**. Использовалось для задания aria-label для контейнера дней в календаре.
Теперь этот контейнер является таблицей (с помощью role="grid") и
в aria-label рендерится текущий открытый в календаре месяц и год.`,name:"changeDayLabel",required:!1,type:{name:"string"}},restoreFocus:{defaultValue:{value:"true"},description:"",name:"restoreFocus",required:!1,type:{name:"boolean | (() => boolean | HTMLElement)"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLDivElement>"}},mode:{defaultValue:null,description:"Режим отображения.\n\n- `default` — показывает фон, обводку и, при наличии, текст-подсказку.\n- `plain` — показывает только текст-подсказку.",name:"mode",required:!1,type:{name:"enum",value:[{value:'"plain"'},{value:'"default"'}]}},status:{defaultValue:null,description:"Статус отображения поля в форме.",name:"status",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"error"'},{value:'"valid"'}]}},after:{defaultValue:null,description:"Добавляет иконку справа.\n\nРекомендации:\n\n- Используйте следующие размеры иконок `12` | `16` | `20` | `24` | `28`.\n- Используйте [IconButton](https://vkcom.github.io/VKUI/#/IconButton), если вам нужна иконка, реагируюущая на нажатие.",name:"after",required:!1,type:{name:"ReactNode"}},before:{defaultValue:null,description:"Добавляет иконку слева.\n\nРекомендации:\n\n- Используйте следующие размеры иконок `12` | `16` | `20` | `24` | `28`.\n- Используйте [IconButton](https://vkcom.github.io/VKUI/#/IconButton), если вам нужна иконка, реагирующая на нажатие.",name:"before",required:!1,type:{name:"ReactNode"}},beforeAlign:{defaultValue:null,description:"Вертикальное выравнивание иконки слева.",name:"beforeAlign",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"start"'},{value:'"end"'}]}},afterAlign:{defaultValue:null,description:"Вертикальное выравнивание иконки справа.",name:"afterAlign",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"start"'},{value:'"end"'}]}},startDateTestsProps:{defaultValue:null,description:"Передает атрибуты `data-testid` для полей ввода начальной даты.",name:"startDateTestsProps",required:!1,type:{name:"DateTestsProps"}},endDateTestsProps:{defaultValue:null,description:"Передает атрибуты `data-testid` для полей ввода конечной даты.",name:"endDateTestsProps",required:!1,type:{name:"DateTestsProps"}},showCalendarButtonTestId:{defaultValue:null,description:"Передает атрибут `data-testid` для кнопки показа календаря.",name:"showCalendarButtonTestId",required:!1,type:{name:"string"}},clearButtonTestId:{defaultValue:null,description:"Передает атрибут `data-testid` для кнопки очистки даты.",name:"clearButtonTestId",required:!1,type:{name:"string"}}}}}catch{}const s4=su(),Ru={title:"Forms/DateRangeInput",component:R,parameters:iu("DateRangeInput",ou,ru),argTypes:{readOnly:{control:{type:"boolean"}},value:{description:"Используйте startDate и endDate для задания периода",control:!1},startDate:{description:"Дата начала периода",table:{type:{summary:"string"}},control:{type:"date"}},endDate:{description:"Дата окончания периода",table:{type:{summary:"string"}},control:{type:"date"}},before:s4,after:s4,renderDayContent:du()}},b={render:function({startDate:l,endDate:c,...i}){const[,V]=cu(),m=S=>{const[g,y]=S||[null,null];V({startDate:g?new Date(g):null,endDate:y?new Date(y):null})},x=l?new Date(l):null,I=c?new Date(c):null;return u.jsx(R,{...i,value:[x,I],onChange:m})}};var i4,c4,E4;b.parameters={...b.parameters,docs:{...(i4=b.parameters)==null?void 0:i4.docs,source:{originalSource:`{
  render: function Render({
    startDate,
    endDate,
    ...args
  }) {
    const [, updateArgs] = useCustomArgs();
    const handleDateRangeUpdate: DateRangeInputProps['onChange'] = updatedValue => {
      const [changedStartDate, changedEndDate] = updatedValue || [null, null];
      updateArgs({
        startDate: changedStartDate ? new Date(changedStartDate) : null,
        endDate: changedEndDate ? new Date(changedEndDate) : null
      });
    };
    const parsedStartDate = startDate ? new Date(startDate) : null;
    const parsedEndDate = endDate ? new Date(endDate) : null;
    return <DateRangeInput {...args} value={[parsedStartDate, parsedEndDate]} onChange={handleDateRangeUpdate} />;
  }
}`,...(E4=(c4=b.parameters)==null?void 0:c4.docs)==null?void 0:E4.source}}};const Vu=["Playground"],Hu=Object.freeze(Object.defineProperty({__proto__:null,Playground:b,__namedExportsOrder:Vu,default:Ru},Symbol.toStringTag,{value:"Module"}));export{R as D,b as P,Hu as a};

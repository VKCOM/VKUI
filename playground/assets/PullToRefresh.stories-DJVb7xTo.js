import{r as e,j as o,R as ru,h as O,c as su,aR as ou,q as au,l as y,aS as iu,N as lu,M as cu,am as U,w as pu,b as fu}from"./iframe-DvQ0hW0I.js";import{D as mu,C as du}from"./constants-DdkjnEgz.js";import{b as Eu,a as hu,d as gu}from"./mock-CiudtyON.js";import{c as Cu}from"./createStoryParameters-CcwS40kl.js";import{A as Du}from"./Avatar-BTwGZh-N.js";import{C as Fu}from"./Cell-BAZKofZQ.js";import{G as yu}from"./Group-DlJj6tsg.js";import{L as vu}from"./List-egVs-sRx.js";import{u as Ru}from"./useStateWithPrev-DauWq6Az.js";import{V as _u}from"./VisuallyHidden-CGlAvVNH.js";import"./preload-helper-PPVm8Dsz.js";import"./ImageBase-w-7-HB2A.js";import"./Clickable-CBovrC6X.js";import"./useFocusVisible-B22Xi0Zg.js";import"./useFocusVisibleClassName-DuyMNLO7.js";import"./mergeCalls-Bc-HqyI0.js";import"./callMultiple-ChqatQlo.js";import"./type_checkers-CVMjkZjG.js";import"./ImageBaseBadge-DWb_Z3tD.js";import"./useColorScheme-Du5ZuGtY.js";import"./InputUtils-BSmatczf.js";import"./useFocusWithin-C0XX_iqt.js";import"./useIsClient-DWoS3R9Q.js";import"./useConfigDirection-DmTY1Se6.js";import"./online_mobile_12-C81mBZXT.js";import"./SvgIconRootV2-L_sEShSp.js";import"./_object_spread_props-DRD4qu7p.js";import"./helpers-QklJbEbU.js";import"./Removable-B6FxApdQ.js";import"./children-BdLlg6DR.js";import"./IconButton-Dmx4oOAb.js";import"./Tappable-CzBKs2NQ.js";import"./useGlobalEventListener-Cq3tChGi.js";import"./useEventListener-BWoYhQmZ.js";import"./cancel_24-BcD8qa0A.js";import"./SimpleCell-B1KXyTvt.js";import"./react_utils-CSZjvU4X.js";import"./Footnote-DYSqrBFj.js";import"./Headline-U_eDzwn1.js";import"./Subhead-DE0FovKO.js";import"./chevron_compact_right_24-CrJLC7s5.js";import"./chevron_16-m8pRWD8o.js";import"./AdaptiveIconRenderer-Co7qE9ki.js";import"./reorder_ios_24-BZR57aXa.js";import"./check_box_on_24-DzSBkyrV.js";import"./check_circle_on_24-DystyaVO.js";import"./constants-CtEIZ0Vq.js";const Bu=e.createContext(!1),Su="_host_kle00_1",Tu="_refreshing_kle00_7",xu="_controls_kle00_12",Pu="_ios_kle00_17",Vu="_spinner_kle00_21",Au="_watching_kle00_46",qu="_spinnerSelf_kle00_50",wu="_spinnerPath_kle00_58",bu="_spinnerOn_kle00_69",ku="_content_kle00_73",c={host:Su,refreshing:Tu,controls:xu,ios:Pu,spinner:Vu,watching:Au,spinnerSelf:qu,spinnerPath:wu,spinnerOn:bu,content:ku};function Mu(t,u){const i=t/100;return 2*Math.PI*u*(1-i)}const H=({on:t=!0,size:u=24,strokeWidth:i=2.5,progress:E=0,children:d="Пожалуйста, подождите...",...r})=>{const p=.5*u-.5*i,f=2*Math.PI*p,l=.5*u,a=Mu(t?80:E,p);return o.jsxs(ru,{baseClassName:O(c.spinner,t&&c.spinnerOn),...r,children:[t&&o.jsx(_u,{children:d}),o.jsx("svg",{role:"presentation",className:c.spinnerSelf,style:{width:u,height:u},viewBox:`0 0 ${u} ${u}`,xmlns:"http://www.w3.org/2000/svg",children:o.jsx("g",{style:{width:u,height:u,transformOrigin:`${l}px ${l}px`},children:o.jsx("circle",{className:c.spinnerPath,fill:"none",strokeDasharray:f,strokeDashoffset:a,strokeWidth:i,strokeLinecap:"round",cx:l,cy:l,r:p})})})]})};try{H.displayName="PullToRefreshSpinner",H.__docgenInfo={description:"",displayName:"PullToRefreshSpinner",props:{size:{defaultValue:{value:"24"},description:"",name:"size",required:!1,type:{name:"number"}},strokeWidth:{defaultValue:{value:"2.5"},description:"",name:"strokeWidth",required:!1,type:{name:"number"}},on:{defaultValue:{value:"true"},description:"",name:"on",required:!1,type:{name:"boolean"}},progress:{defaultValue:{value:"0"},description:"",name:"progress",required:!1,type:{name:"number"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLDivElement>"}}}}}catch{}const Hu=1e3;function M(t){return t&&("preventDefault"in t.originalEvent&&t.originalEvent.cancelable&&t.originalEvent.preventDefault(),"stopPropagation"in t.originalEvent&&t.originalEvent.stopPropagation()),!1}const R=({children:t,isFetching:u,onRefresh:i,className:E,...d})=>{const r=su(),p=ou(),{window:f}=au(),l=e.useRef(void 0);e.useEffect(()=>{l.current=u});const a=e.useMemo(()=>({start:r==="ios"?-10:-45,max:r==="ios"?50:80,maxY:r==="ios"?400:80,refreshing:r==="ios"?36:50,positionMultiplier:r==="ios"?.21:1}),[r]),[G,h]=e.useState(a.start),[g,_]=e.useState(!1),[n,j]=e.useState(!1),[B,I]=e.useState(!1),[[m,S],Y]=Ru(!1),L=e.useRef(0),[N,T]=e.useState(0),[W,D]=e.useState(0),x=e.useCallback(()=>{_(!1),I(!1),j(!1),h(a.start),D(0),T(0)},[a]),C=e.useCallback(()=>{m||x()},[m,x]),P=e.useRef(void 0);y(()=>{const s=l.current;s!==void 0&&s&&!u&&C()},[u,C]),y(()=>{const s=l.current;s!==void 0&&!s&&u&&clearTimeout(P.current)},[u]);const V=e.useCallback(()=>{!n&&i&&(clearTimeout(P.current),P.current=setTimeout(C,Hu),j(!0),h(s=>r==="ios"?s:a.refreshing),i())},[n,i,C,r,a.refreshing]);y(()=>{S!==void 0&&S&&!m&&(!n&&B?V():n&&!u?x():(h(n?a.refreshing:a.start),D(0),T(0)))},[a,u,C,S,m,n,B,V]),y(function(){return f&&(g||n)?iu(f):void 0},[f,g,n]);const X=e.useRef(0),$=s=>{if(n){M(s);return}Y(!0),X.current=s.startY},A=e.useRef(!1),K=s=>{const{isY:Z,shiftY:w}=s,{start:b,max:z}=a,uu=p?.getScroll().y;if(g&&m){M(s);const{positionMultiplier:eu,maxY:tu}=a,nu=Math.max(0,w-L.current),F=U(b+nu*eu,b,tu),k=F>-10?Math.abs((F+10)/z)*80:0;h(F),D(U(k,0,80)),I(k>80),T((F+10)*2.3),r==="ios"&&k>85&&!n&&!A.current&&(A.current=!0,V())}else Z&&uu===0&&w>0&&!n&&m&&(M(s),L.current=w,_(!0),h(b),D(0))},J=()=>{_(!1),Y(!1),A.current=!1},Q=`translate3d(0, ${G}px, 0)`;let q="";return r==="ios"&&n&&!m?q="translate3d(0, 100px, 0)":r==="ios"&&(N||n)&&(q=`translate3d(0, ${N}px, 0)`),o.jsx(Bu.Provider,{value:!0,children:o.jsxs(lu,{"aria-live":"polite","aria-busy":!!u,...d,onStart:$,onMove:K,onEnd:J,className:O(c.host,r==="ios"&&c.ios,g&&c.watching,n&&c.refreshing,E),children:[o.jsx(cu,{className:c.controls,useParentWidth:!0,children:o.jsx(H,{style:{transform:Q,opacity:g||n||B?1:0},on:n,progress:n?void 0:W})}),o.jsx("div",{className:c.content,style:{transform:q},children:t})]})})};try{R.displayName="PullToRefresh",R.__docgenInfo={description:"",displayName:"PullToRefresh",props:{onRefresh:{defaultValue:null,description:"Будет вызвана для обновления контента (прим.: функция должна быть мемоизированным обработчиком).",name:"onRefresh",required:!0,type:{name:"AnyFunction"}},isFetching:{defaultValue:null,description:"Определяет, выполняется ли обновление. Для скрытия спиннера после получения контента необходимо передать `false`.",name:"isFetching",required:!1,type:{name:"boolean"}},scroll:{defaultValue:null,description:"@ignore",name:"scroll",required:!1,type:{name:"ScrollContextInterface"}},window:{defaultValue:null,description:"@ignore",name:"window",required:!1,type:{name:"Window"}},document:{defaultValue:null,description:"@ignore",name:"document",required:!1,type:{name:"Document"}},usePointerHover:{defaultValue:null,description:`Использовать pointer-events для hover-состояний.
Работает на отключенных элементах (disabled inputs).`,name:"usePointerHover",required:!1,type:{name:"boolean"}},useCapture:{defaultValue:null,description:"Использовать фазу capture для событий.",name:"useCapture",required:!1,type:{name:"boolean"}},slideThreshold:{defaultValue:{value:"5"},description:"Порог расстояния в пикселях для активации свайпа.",name:"slideThreshold",required:!1,type:{name:"number"}},noSlideClick:{defaultValue:null,description:"Блокировать click-события после распознавания свайпа.",name:"noSlideClick",required:!1,type:{name:"boolean"}},stopPropagation:{defaultValue:null,description:"Останавливать всплытие событий.",name:"stopPropagation",required:!1,type:{name:"boolean"}},onEnter:{defaultValue:null,description:"Обработчик входа курсора в область.",name:"onEnter",required:!1,type:{name:"HoverHandler"}},onLeave:{defaultValue:null,description:"Обработчик выхода курсора из области.",name:"onLeave",required:!1,type:{name:"HoverHandler"}},onStart:{defaultValue:null,description:"Общий обработчик начала взаимодействия.",name:"onStart",required:!1,type:{name:"CustomTouchEventHandler"}},onStartX:{defaultValue:null,description:"Обработчик начала горизонтального перемещения.",name:"onStartX",required:!1,type:{name:"CustomTouchEventHandler"}},onStartY:{defaultValue:null,description:"Обработчик начала вертикального перемещения.",name:"onStartY",required:!1,type:{name:"CustomTouchEventHandler"}},onMove:{defaultValue:null,description:"Общий обработчик перемещения.",name:"onMove",required:!1,type:{name:"CustomTouchEventHandler"}},onMoveX:{defaultValue:null,description:"Обработчик горизонтального перемещения.",name:"onMoveX",required:!1,type:{name:"CustomTouchEventHandler"}},onMoveY:{defaultValue:null,description:"Обработчик вертикального перемещения.",name:"onMoveY",required:!1,type:{name:"CustomTouchEventHandler"}},onEnd:{defaultValue:null,description:"Общий обработчик завершения взаимодействия.",name:"onEnd",required:!1,type:{name:"CustomTouchEventHandler"}},onEndX:{defaultValue:null,description:"Обработчик завершения горизонтального свайпа.",name:"onEndX",required:!1,type:{name:"CustomTouchEventHandler"}},onEndY:{defaultValue:null,description:"Обработчик завершения вертикального свайпа.",name:"onEndY",required:!1,type:{name:"CustomTouchEventHandler"}},getRootRef:{defaultValue:null,description:"",name:"getRootRef",required:!1,type:{name:"Ref<HTMLElement>"}},Component:{defaultValue:null,description:"",name:"Component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}}}}}catch{}const w4={title:"Feedback/PullToRefresh",component:R,parameters:Cu("PullToRefresh",du,mu),decorators:[pu,fu],tags:["Обратная связь"]},ju=Eu(20),v={render:function(){const[u,i]=e.useState(ju),[E,d]=e.useState(!1),r=e.useCallback(()=>{d(!0),setTimeout(()=>{d(!1),i(p=>[hu(),...p])},gu(600,2e3))},[]);return o.jsx(R,{onRefresh:r,isFetching:E,children:o.jsx(yu,{children:o.jsx(vu,{children:u.map(({name:p,photo_100:f},l)=>o.jsx(Fu,{before:o.jsx(Du,{src:f}),children:p},l))})})})}};v.parameters={...v.parameters,docs:{...v.parameters?.docs,source:{originalSource:`{
  render: function Render() {
    const [users, setUsers] = React.useState(initUsers);
    const [fetching, setFetching] = React.useState(false);
    const onRefresh = React.useCallback(() => {
      setFetching(true);
      setTimeout(() => {
        setFetching(false);
        setUsers(prevUsers => [getRandomUser(), ...prevUsers]);
      }, getRandomInt(600, 2000));
    }, []);
    return <PullToRefresh onRefresh={onRefresh} isFetching={fetching}>
        <Group>
          <List>
            {users.map(({
            name,
            photo_100
          }, i) => {
            return <Cell key={i} before={<Avatar src={photo_100} />}>
                  {name}
                </Cell>;
          })}
          </List>
        </Group>
      </PullToRefresh>;
  }
}`,...v.parameters?.docs?.source}}};const b4=["Example"];export{v as Example,b4 as __namedExportsOrder,w4 as default};
